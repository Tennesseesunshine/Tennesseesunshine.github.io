<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>reduceé«˜çº§å‡½æ•°çš„ä¸€äº›åº”ç”¨</title>
    <link href="/2021/01/15/jsReduceFunction/"/>
    <url>/2021/01/15/jsReduceFunction/</url>
    
    <content type="html"><![CDATA[<h3 id="æ¦‚è¦"><a href="#æ¦‚è¦" class="headerlink" title="æ¦‚è¦"></a>æ¦‚è¦</h3><p>åœ¨æœ€è¿‘çš„å·¥ä½œä¸­ï¼Œ<code>reduce</code> æˆä¸ºäº†å‡ºå¢ƒç‡å’Œä½¿ç”¨ç‡éå¸¸é«˜çš„ä¸€ä¸ªé«˜é˜¶å‡½æ•°ï¼Œæ‰€ä»¥æ€»ç»“ä¸€ä¸‹å·¥ä½œä¸­ä»¥åŠ <code>reduce</code> å¯èƒ½ä¼šå®ç°çš„ä¸€äº›åŠŸèƒ½ã€‚</p><p>å…ˆç®€å•è¯´ä¸€ä¸‹ <code>reduce</code> å‡½æ•°ï¼Œå®ƒçš„è¯­æ³•ä¸º <code>Array.reduce(callback, [initialValue])</code>ï¼Œæ¥å—çš„å‚æ•°æ˜¯ï¼š</p><ul><li>ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå…¶å›è°ƒå‡½æ•°æ¥å—å››ä¸ªå‚æ•°åˆ†åˆ«ä¸ºåˆå§‹å€¼ï¼ˆæˆ–è€…ä¸Šæ¬¡çš„å›è°ƒå‡½æ•°çš„è¿”å›å€¼ï¼‰ã€å½“å‰å…ƒç´ ã€å½“å‰ç´¢å¼•ã€åŸæ•°ç»„ã€‚</li><li>ç¬¬äºŒä¸ªå‚æ•° <code>initialValue</code> ä¸ºå¯é€‰ï¼Œå¦‚æœä¼ é€’ï¼Œåˆ™ <code>initialValue</code> ä½œä¸ºç¬¬ä¸€æ¬¡å›è°ƒå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚</li></ul><p>éœ€è¦è®°ä½çš„ç‚¹æ˜¯ï¼šå¦‚æœä¸º <code>reduce</code> æä¾› <code>initialValue</code> å‚æ•°ï¼Œåˆ™å›è°ƒå‡½æ•°ä¼šä»ç´¢å¼•ä¸º <code>0</code> çš„åœ°æ–¹å¼€å§‹æ‰§è¡Œ <code>callback</code>ï¼Œå¦åˆ™ä¼šä»ç´¢å¼•ä¸º <code>1</code> çš„åœ°æ–¹å¼€å§‹æ‰§è¡Œã€‚</p><p>æˆ‘ä»¬å¯ä»¥ç”¨ä¸ª <code>demo</code> éªŒè¯ä¸€ä¸‹</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="xml"><span class="hljs-comment">&lt;!-- æ— åˆå§‹åŒ–å‚æ•° --&gt;</span><br><br>let arr = [9, 19, 20]<br>arr.reduce((pre, cur, idx) =&gt; </span><span class="hljs-template-variable">&#123;<br>  console.log(pre, cur, 'çœ‹ç´¢å¼•å¼€å§‹:', idx)<br>  return pre + cur<br>&#125;</span><span class="xml">)<br><br>// 9 19 "çœ‹ç´¢å¼•å¼€å§‹:" 1<br>// 28 20 "çœ‹ç´¢å¼•å¼€å§‹:" 2<br>// 48<br><br><span class="hljs-comment">&lt;!-- æœ‰åˆå§‹åŒ–å‚æ•° --&gt;</span><br><br>let arr = [9, 19, 20]<br>arr.reduce((pre, cur, idx) =&gt; </span><span class="hljs-template-variable">&#123;<br>  console.log(pre, cur, 'çœ‹ç´¢å¼•å¼€å§‹:', idx)<br>  return pre + cur<br>&#125;</span><span class="xml">, 0)<br><br>// 0 9 "çœ‹ç´¢å¼•å¼€å§‹:" 0<br>// 9 19 "çœ‹ç´¢å¼•å¼€å§‹:" 1<br>// 28 20 "çœ‹ç´¢å¼•å¼€å§‹:" 2<br>// 48</span><br></code></pre></td></tr></table></figure><h3 id="æ•°ç»„æ±‚å’Œ"><a href="#æ•°ç»„æ±‚å’Œ" class="headerlink" title="æ•°ç»„æ±‚å’Œ"></a>æ•°ç»„æ±‚å’Œ</h3><ul><li>ç®€å•æ•°ç»„æ±‚å’Œ</li></ul><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs undefined">let arr = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]<br>arr.reduce((pre, cur) =&gt; pre + cur, <span class="hljs-number">0</span>) <span class="hljs-comment">// 15</span><br></code></pre></td></tr></table></figure><ul><li>å¤æ‚ä¸€ç‚¹çš„ï¼Œæ•°ç»„å¯¹è±¡ä¸­çš„æ•°æ®</li></ul><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs undefined">let <span class="hljs-built_in">list</span> = [<br>  &#123;<br>    <span class="hljs-built_in">name</span>: <span class="hljs-string">'è‹¹æœ'</span>,<br>    <span class="hljs-built_in">count</span>: <span class="hljs-number">20</span>,<br>  &#125;,<br>  &#123;<br>    <span class="hljs-built_in">name</span>: <span class="hljs-string">'é¦™è•‰'</span>,<br>    <span class="hljs-built_in">count</span>: <span class="hljs-number">40</span>,<br>  &#125;,<br>  &#123;<br>    <span class="hljs-built_in">name</span>: <span class="hljs-string">'çŒ•çŒ´æ¡ƒ'</span>,<br>    <span class="hljs-built_in">count</span>: <span class="hljs-number">90</span>,<br>  &#125;<br>]<br><span class="hljs-built_in">list</span>.reduce((pre, cur) =&gt; pre + cur.<span class="hljs-built_in">count</span>, <span class="hljs-number">0</span>) <span class="hljs-comment">// 150</span><br></code></pre></td></tr></table></figure><h3 id="ç»Ÿè®¡å­—ç¬¦ä¸²å‡ºç°çš„æ¬¡æ•°"><a href="#ç»Ÿè®¡å­—ç¬¦ä¸²å‡ºç°çš„æ¬¡æ•°" class="headerlink" title="ç»Ÿè®¡å­—ç¬¦ä¸²å‡ºç°çš„æ¬¡æ•°"></a>ç»Ÿè®¡å­—ç¬¦ä¸²å‡ºç°çš„æ¬¡æ•°</h3><p>åˆ©ç”¨ <code>{}</code> å¯¹è±¡æ¥åˆ¤æ–­æ˜¯å¦èƒ½å–åˆ°å½“å‰å€¼ï¼Œè·å–ä¸åˆ°åˆ™è¡¨ç¤ºå½“å‰å…ƒç´ æ²¡æœ‰ï¼Œè®¾ç½®æ¬¡æ•°ä¸º <code>1</code>ï¼Œæœ‰åˆ™æ¬¡æ•°é€’å¢ã€‚</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs undefined">var str = <span class="hljs-string">'aabcddeffghhijklllm'</span><br>str.<span class="hljs-keyword">split</span>(<span class="hljs-string">''</span>).reduce((<span class="hljs-keyword">pre</span>, cur) =&gt; &#123;<br>  <span class="hljs-keyword">pre</span>[cur] ? <span class="hljs-keyword">pre</span>[cur]++ : <span class="hljs-keyword">pre</span>[cur] = <span class="hljs-number">1</span><br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">pre</span><br>&#125;, &#123;&#125;)<br></code></pre></td></tr></table></figure><h3 id="å»é‡"><a href="#å»é‡" class="headerlink" title="å»é‡"></a>å»é‡</h3><p>åˆ©ç”¨ <code>includes</code> åˆ¤æ–­ä¸Šæ¬¡ç´¯åŠ çš„æ•°ç»„ä¸­æ˜¯å¦å…·æœ‰å½“å‰å€¼ï¼Œæ²¡æœ‰çš„è¯å°±å°†å½“å‰å€¼å’Œä¸Šæ¬¡çš„è¿”å›å€¼è¿æ¥èµ·æ¥è¿”å›ï¼Œæœ‰çš„è¯ç›´æ¥è¿”å›ä¸Šä¸€æ¬¡çš„ç»“æœã€‚</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs undefined">var arr = <span class="hljs-comment">[1, 2, 2, 2, 3, 3, 4, 5, 5]</span><br>arr.reduce((pre, cur) =&gt; !pre.includes(cur) ? <span class="hljs-comment">[...pre, ...<span class="hljs-comment">[cur]</span>]</span> : pre, <span class="hljs-comment">[]</span>)<br></code></pre></td></tr></table></figure><h3 id="æ•°ç»„æ‰å¹³åŒ–"><a href="#æ•°ç»„æ‰å¹³åŒ–" class="headerlink" title="æ•°ç»„æ‰å¹³åŒ–"></a>æ•°ç»„æ‰å¹³åŒ–</h3><ul><li>äºŒç»´ç®€å•æ•°ç»„</li></ul><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs undefined">var arr = <span class="hljs-comment">[<span class="hljs-comment">[1, 2]</span>, <span class="hljs-comment">[3, 4]</span>, <span class="hljs-comment">[5]</span>]</span><br>arr.reduce((pre, cur) =&gt; <span class="hljs-comment">[...pre, ...cur]</span>, <span class="hljs-comment">[]</span>)<br>// <span class="hljs-comment">[1, 2, 3, 4, 5]</span><br></code></pre></td></tr></table></figure><ul><li>å¤æ‚çš„é«˜çº¬åº¦æ•°ç»„</li></ul><p>åˆ©ç”¨é€’å½’æ‰å¹³æ·±å±‚åµŒå¥—çš„æ•°ç»„ã€‚</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs undefined">var arr = <span class="hljs-comment">[<span class="hljs-comment">[1, 2, <span class="hljs-comment">[<span class="hljs-comment">[3, 4]</span>, <span class="hljs-comment">[5, 6]</span>]</span>]</span>, <span class="hljs-comment">[3, <span class="hljs-comment">[<span class="hljs-comment">[7, 8]</span>, <span class="hljs-comment">[8, 1]</span>]</span>]</span>, <span class="hljs-comment">[5, <span class="hljs-comment">[<span class="hljs-comment">[5, 4]</span>, <span class="hljs-comment">[9, 10]</span>]</span>]</span>]</span><br>var flat = (arr) =&gt; arr.reduce((pre, cur) =&gt; <span class="hljs-comment">[...pre, ...(Array.isArray(cur) ? flat(cur) : <span class="hljs-comment">[cur]</span>)]</span>, <span class="hljs-comment">[]</span>)<br>flat(arr)<br>// <span class="hljs-comment">[1, 2, 3, 4, 5, 6, 3, 7, 8, 8, 1, 5, 5, 4, 9, 10]</span><br></code></pre></td></tr></table></figure><p><code>ES6</code> çš„è§£å†³åŠæ³•ï¼š<br>ä½¿ç”¨æ•°ç»„çš„ <code>flat</code> æ–¹æ³•ï¼Œè¯­æ³• <code>arr.flat([depth])</code>ï¼Œ<code>depth</code> å‚æ•°ä¸ºæ·±åº¦ï¼Œä¸ä¼ å‚æ•°é»˜è®¤æ‰å¹³ <code>1</code> çº§åµŒå¥—ï¼Œå¯ä»¥è¾“å…¥å…³é”®å­— <code>Infinity</code> å®ç°ä»»ä½•å±‚æ•°åµŒå¥—çš„æ‰å¹³ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®ç°ä¸€ä¸ªç®€å•çš„ vue ä¸­çš„ EventBus</title>
    <link href="/2021/01/14/concisEventBus/"/>
    <url>/2021/01/14/concisEventBus/</url>
    
    <content type="html"><![CDATA[<p>å…ˆåˆ†æä¸€ä¸‹ <code>vue</code> ä¸­çš„ä¸€äº›ç”¨æ³•</p><h3 id="on-æ³¨å†Œ"><a href="#on-æ³¨å†Œ" class="headerlink" title="on æ³¨å†Œ"></a><code>on</code> æ³¨å†Œ</h3><ul><li><code>this.$on(&#39;eventName&#39;, (...params) =&gt; {})</code><br>å…¶å®æˆ‘ä»¬åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­å¯ä»¥å‘ç°ï¼Œ<code>$on</code>çš„äº‹ä»¶å¯ä»¥æ³¨å†Œå¤šæ¬¡ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥åœ¨å¾ˆå¤šç»„ä»¶é‡Œè¿›è¡Œä¸€ä¸ªäº‹ä»¶çš„æ³¨å†Œï¼Œåœ¨<code>$emit</code> è§¦å‘ç›¸åº”çš„äº‹ä»¶çš„æ—¶å€™ï¼Œå¯¹åº”æ³¨å†Œçš„æ‰€æœ‰äº‹ä»¶éƒ½ä¼šæ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬èƒ½æƒ³åˆ°å®ƒçš„å®ç°ä¸€å®šæ˜¯ï¼Œå¦‚æœåœ¨ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œæ³¨å†Œäº†ç›¸åŒçš„äº‹ä»¶ï¼Œä¼šä¸€ç›´å¾€å½“å‰çš„è¿™ä¸ªäº‹ä»¶æ•°ç»„çš„é›†åˆä¸­è¿½åŠ å›è°ƒå‡½æ•°ã€‚</li></ul><h3 id="emitè§¦å‘"><a href="#emitè§¦å‘" class="headerlink" title="emitè§¦å‘"></a><code>emit</code>è§¦å‘</h3><ul><li><code>this.$emit(&#39;eventName&#39;, params)</code><br>ä¸Šä¸€æ­¥æåˆ°ï¼Œ<code>$emit</code> çš„æ—¶å€™ï¼Œç›¸åº”æ³¨å†Œçš„äº‹ä»¶éƒ½ä¼šæ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œè€Œä¸” <code>on</code> æ³¨å†Œçš„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ‰€ä»¥å…¶å®ç°åº”è¯¥æ˜¯éå† <code>emit</code> äº‹ä»¶æ‰€å¯¹åº”çš„æ•°ç»„ï¼Œä¾æ¬¡æ‰§è¡Œ <code>callback</code> å¹¶ä¸”å°†å‚æ•°ä¼ é€’å‡ºå»ã€‚</li></ul><h3 id="once-ä¸€æ¬¡è§¦å‘"><a href="#once-ä¸€æ¬¡è§¦å‘" class="headerlink" title="once ä¸€æ¬¡è§¦å‘"></a><code>once</code> ä¸€æ¬¡è§¦å‘</h3><ul><li><code>this.$once(&#39;eventName&#39;, (...params) =&gt; {})</code><br>è§¦å‘ä¸€æ¬¡ï¼Œå®ƒçš„å®ç°åº”è¯¥æ˜¯æ— éœ€åˆ¤æ–­ä¹‹å‰äº‹ä»¶æœ‰æ²¡æœ‰æ³¨å†Œï¼Œè¦æ˜¯æ³¨å†Œç›´æ¥æ”¾è¿›å»ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ³¨å†Œç›¸åŒçš„äº‹ä»¶åè€…ä¼šè¦†ç›–æ‰å‰è€…ï¼Œæ³¨å†Œæ–°çš„ä¼šå¢åŠ ã€‚</li></ul><h3 id="offç§»é™¤"><a href="#offç§»é™¤" class="headerlink" title="offç§»é™¤"></a><code>off</code>ç§»é™¤</h3><ul><li><code>this.$off(&#39;eventName)</code><br><code>off</code> ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯ç›´æ¥ç”¨å¯¹è±¡ä¸Šåˆ æ‰å½“å‰çš„äº‹ä»¶ã€‚</li></ul><p>åœ¨ <code>vue2.0</code> çš„ <code>SFC</code> ä¸­ï¼Œ<code>this</code> æŒ‡å‘æ˜¯ <code>new Vue()</code>çš„å®ä¾‹ <code>vm</code>ï¼Œå› ä¸ºå…¶ä¸Šå®ä¾‹ä¸Šå·²ç»å…·æœ‰ <code>eventBus</code> çš„æ–¹æ³•ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ã€‚</p><p>ä¼ªä»£ç ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs undefined">let EventBus = &#123;<br>  taskMap: &#123;&#125;,<br>  $on(eventName, fn) &#123;<br>    <span class="hljs-comment">&lt;!-- å¦‚æœmapä¸­æ— æ³¨å†Œäº‹ä»¶ï¼Œåˆ™å°†äº‹ä»¶æ¨å…¥ï¼Œå¦‚æœæœ‰æ³¨å†Œçš„äº‹ä»¶ï¼Œç»§ç»­å¾€é‡Œè¿½åŠ  --&gt;</span><br>    if (!this.taskMap[eventName]) &#123;<br>      this.taskMap[eventName] = [fn]<br>    &#125; else &#123;<br>      this.taskMap[eventName].push(fn)<br>    &#125;<br>  &#125;,<br>  $emit(eventName, ...msg) &#123;<br>    if (!this.taskMap[eventName]) &#123;<br>      return<br>    &#125; else &#123;<br>      <span class="hljs-comment">&lt;!-- éå†æ³¨å†Œè¿‡çš„äº‹ä»¶ï¼Œä¾æ¬¡æ‰§è¡Œ --&gt;</span><br>      this.taskMap[eventName].forEach(callback =&gt; callback(...msg))<br>    &#125;<br>  &#125;,<br>  $once(eventName, fn) &#123;<br>    <span class="hljs-comment">&lt;!-- ä¸éœ€è¦åˆ¤æ–­ï¼Œåæ¥çš„è¦†ç›–å‰è¾¹çš„ --&gt;</span><br>    this.taskMap[eventName] = [fn]<br>  &#125;,<br>  $off(eventName) &#123;<br>    if (!this.taskMap[eventName]) &#123;<br>      return<br>    &#125; else &#123;<br>      <span class="hljs-comment">&lt;!-- åˆ æ‰æ³¨å†Œçš„äº‹ä»¶ --&gt;</span><br>      Reflect.deleteProperty(this.taskMap, [eventName])<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-regexp">//</span> æ³¨å†Œ<br>EventBus.$<span class="hljs-literal">on</span>(<span class="hljs-string">'begin'</span>, <span class="hljs-function"><span class="hljs-params">(...x)</span> =&gt;</span> &#123;<span class="hljs-built_in">console</span>.log(...x)&#125;)<br>EventBus.$<span class="hljs-literal">off</span>(<span class="hljs-string">'begin'</span>)<br>EventBus.$emit(<span class="hljs-string">'begin'</span>, <span class="hljs-string">'å‚æ•°1000000'</span>, <span class="hljs-string">'å‚æ•°2'</span>) <span class="hljs-regexp">//</span> ä¸ä¼šè§¦å‘<br>EventBus.$once(<span class="hljs-string">'begin'</span>, <span class="hljs-function"><span class="hljs-params">(...x)</span> =&gt;</span> &#123;<span class="hljs-built_in">console</span>.log(x)&#125;)<br>EventBus.$emit(<span class="hljs-string">'begin'</span>, <span class="hljs-string">'ğŸ…'</span>, <span class="hljs-string">'ğŸ‰'</span>) <span class="hljs-regexp">//</span> è§¦å‘ä¸€æ¬¡once [<span class="hljs-string">"ğŸ…"</span>, <span class="hljs-string">"ğŸ‰"</span>]<br>EventBus.$<span class="hljs-literal">off</span>(<span class="hljs-string">'begin'</span>)<br><br>EventBus.$<span class="hljs-literal">on</span>(<span class="hljs-string">'begin'</span>, <span class="hljs-function"><span class="hljs-params">(...x)</span> =&gt;</span> &#123;<span class="hljs-built_in">console</span>.log(...x, <span class="hljs-string">'1'</span>)&#125;)<br>EventBus.$<span class="hljs-literal">on</span>(<span class="hljs-string">'begin'</span>, <span class="hljs-function"><span class="hljs-params">(...x)</span> =&gt;</span> &#123;<span class="hljs-built_in">console</span>.log(...x, <span class="hljs-string">'2'</span>)&#125;)<br>EventBus.$emit(<span class="hljs-string">'begin'</span>, <span class="hljs-string">'ğŸƒâ€â™€ï¸'</span>, <span class="hljs-string">'ğŸš¢'</span>) <span class="hljs-regexp">//</span> è§¦å‘<span class="hljs-number">2</span>æ¬¡<span class="hljs-literal">on</span> ğŸƒâ€â™€ï¸ï¼ŒğŸš¢ï¼Œ<span class="hljs-number">1</span>  ğŸƒâ€â™€ï¸ï¼ŒğŸš¢ï¼Œ<span class="hljs-number">2</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>Vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è·¨æ·±ç»„ä»¶ä¼ é€’æ•°æ®å’Œè°ƒç”¨æ–¹æ³•</title>
    <link href="/2021/01/03/useContext/"/>
    <url>/2021/01/03/useContext/</url>
    
    <content type="html"><![CDATA[<p>åœ¨çˆ¶å­ç»„ä»¶ä¼ é€’æ•°æ®çš„æ—¶å€™ï¼Œ<code>react</code> æœ€å¸¸ç”¨çš„</p><h4 id="ä¼ ç»Ÿç®€å•çš„ç»„ä»¶é€šä¿¡æ–¹å¼"><a href="#ä¼ ç»Ÿç®€å•çš„ç»„ä»¶é€šä¿¡æ–¹å¼" class="headerlink" title="ä¼ ç»Ÿç®€å•çš„ç»„ä»¶é€šä¿¡æ–¹å¼"></a>ä¼ ç»Ÿç®€å•çš„ç»„ä»¶é€šä¿¡æ–¹å¼</h4><ul><li>çˆ¶ç»„ä»¶ â€”&gt; å­ç»„ä»¶ <code>props</code></li><li>å­ç»„ä»¶ â€”&gt; çˆ¶ç»„ä»¶ <code>callback</code><br>ä½†æ˜¯æœ‰ä¸€äº›ç‰¹æ®Šçš„æƒ…å†µï¼Œæ¯”å¦‚æ˜¯åµŒå¥—æ¯”è¾ƒæ·±çš„ç»„ä»¶ï¼Œ<code>Aâ€”&gt;Bâ€”&gt;Câ€”&gt;D</code> åµŒå¥—ï¼Œä¸€æ—¦è¿™ç§ç»“æœä½¿ç”¨ <code>props</code> ä¼ é€’æ•°æ®ï¼Œå°±ä¼šæ˜¾å¾—ç»„ä»¶éå¸¸è‡ƒè‚¿ï¼Œè€Œ <code>react</code> æœ‰æä¾›æ–¹å¼æ¥è§£å†³ï¼Œå³ <code>useContext</code></li></ul><h4 id="åµŒå¥—æ·±çš„ç»„ä»¶çš„é€šä¿¡"><a href="#åµŒå¥—æ·±çš„ç»„ä»¶çš„é€šä¿¡" class="headerlink" title="åµŒå¥—æ·±çš„ç»„ä»¶çš„é€šä¿¡"></a>åµŒå¥—æ·±çš„ç»„ä»¶çš„é€šä¿¡</h4><ul><li><code>React.createContext</code></li><li><code>useContext</code></li></ul><p>å‡å¦‚ç°åœ¨æœ‰ä¾èµ–å…³ç³»çš„ï¼Œç»„ä»¶ <code>A-&gt;B-&gt;C</code>ï¼Œ<code>useContext</code> ä½¿ç”¨å°ç»“:</p><p>å¯ä»¥å…¨å±€ç»´æŠ¤ä¸€ä¸ª <code>context.ts</code></p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-comment">// åˆ©ç”¨ React.CreateContext api åˆ›å»ºä¸€ä¸ªå¸¦æœ‰é»˜è®¤å€¼çš„context</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> CreateContextData = React.createContext(<span class="hljs-string">''</span>)<br></code></pre></td></tr></table></figure><p><code>A.jsx</code><br>å¿…é¡»è¦ä½¿ç”¨ <code>Provider</code> å¹¶ä¸”å°†æ•°æ®ä»¥ <code>value</code> çš„å½¢å¼ä¼ é€’ä¸‹å»ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-keyword">const</span> A = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> text = <span class="hljs-string">'react'</span><br>  <span class="hljs-keyword">return</span> (<br>    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">CreateContextData.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&#123;text&#125;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">B</span> /&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">CreateContextData.Provider</span>&gt;</span></span><br>  )<br>&#125;<br></code></pre></td></tr></table></figure><p><code>B.jsx</code><br>ä¸­é—´ç»„ä»¶ä¸ç”¨åœ¨æ„ <code>A</code> å¾€ä¸‹ä¼ é€’çš„å‚æ•°å’Œæ•°æ®æ˜¯ä»€ä¹ˆï¼Œå…¶åªéœ€è¦ä¿è¯ <code>B</code> å’Œ <code>C</code> çš„æ¥å£ç¨³å®šã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-keyword">const</span> B = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>  <span class="hljs-keyword">return</span> (<br>    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>å¤§çº²<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">C</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>  )<br>&#125;<br></code></pre></td></tr></table></figure><p><code>C.jsx</code><br>é€šè¿‡è·å–å…¨å±€åˆ›å»ºçš„ <code>context</code> å¯¹è±¡æ¥è·å– <code>A</code> ç»„ä»¶çš„é€šä¿¡æ•°æ®ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-keyword">import</span> &#123; CreateContextData &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'./context.js'</span><br><br><span class="hljs-keyword">const</span> C = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>  <span class="hljs-comment">// é€šè¿‡useContextè·å–contextçš„æ•°æ® ä¸€å®šè¦ä¼ å…¥åˆ›å»ºçš„ä¸Šä¸‹æ–‡å®ä¾‹ å¦åˆ™è·å–ä¸åˆ°æ•°æ®</span><br>  <span class="hljs-keyword">const</span> initText = useContext(CreateContextData)<br>  <span class="hljs-keyword">return</span> (<span class="xml"><span class="hljs-tag">&lt;&gt;</span>æˆ‘æ­£åœ¨å­¦ä¹ &#123;initText&#125;<span class="hljs-tag">&lt;/&gt;</span>)<br>&#125;</span><br></code></pre></td></tr></table></figure><p>å¦‚æœåµŒå¥—çš„ç»„ä»¶ï¼Œå­ç»„ä»¶ä¸­ä¹Ÿæœ‰ <code>provider</code> æä¾›ï¼Œåˆ™æŒ‰ç…§æœ€è¿‘çš„å–å€¼ï¼Œä¸€èˆ¬æ­£å¸¸çš„ä½¿ç”¨æ–¹å¼å°±æ˜¯æœ€é¡¶å±‚ç»„ä»¶å¢åŠ  <code>provider</code></p><p>æ¯æ¬¡åˆ›å»ºçš„çš„ä¸Šä¸‹æ–‡å®ä¾‹ï¼Œéƒ½éœ€è¦å¯¼å‡ºï¼Œæ‰€ä»¥å¯ä»¥ç”¨ç»Ÿä¸€çš„æ–‡ä»¶ç®¡ç†è¿™ç§åˆ›å»ºçš„ä¸Šä¸‹æ–‡ï¼Œæœ€å <code>export</code> ä»¥åŠåœ¨éœ€è¦çš„åœ°æ–¹ <code>import</code></p><p>é€ä¼ ä¸ä»…ä»…å¯ä»¥æ˜¯ <code>state</code>ï¼Œè¿˜å¯ä»¥æ˜¯çˆ¶ç»„ä»¶çš„æ–¹æ³•ï¼Œåœ¨æ·±å±‚ç»„ä»¶è·å–ä¹‹åï¼Œå¯ä»¥ç›´æ¥ä¿®æ”¹çˆ¶ç»„ä»¶æ•°æ®</p><p>è°ƒç”¨äº† <code>useContext</code> çš„ç»„ä»¶æ€»ä¼šåœ¨ <code>context</code> å€¼å˜åŒ–æ—¶é‡æ–°æ¸²æŸ“ï¼Œå¦‚æœç»„ä»¶æ¸²æŸ“å¼€é”€å¤ªå¤§ï¼Œå¯ä»¥ä½¿ç”¨ <code>useMome</code> åŒ…è£…ä¸€ä¸‹</p>]]></content>
    
    
    
    <tags>
      
      <tag>React</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è®°ä½ä¸€æ¬¡å…³äºnodeä¸­é—´å±‚å¤„ç†çš„æ–‡ä»¶ä¸Šä¼ </title>
    <link href="/2021/01/01/uploadFile/"/>
    <url>/2021/01/01/uploadFile/</url>
    
    <content type="html"><![CDATA[<p>å…¬å¸é¡¹ç›®çš„æ¶æ„æ˜¯ <code>umi</code> â€”&gt;  <code>nodejs</code> â€”&gt; <code>api</code></p><p>åœ¨æœ€è¿‘ä¸€æ¬¡çš„éœ€æ±‚ä¸­ï¼Œæœ‰ä¸€ä¸ªæ‰¹é‡ä¸Šä¼ çš„åŠŸèƒ½ï¼Œå¤§ä½“çš„äº¤äº’æ˜¯ï¼šåœ¨ <code>excel</code> é‡Œå…ˆå¡«å†™å¥½æ•°æ®ï¼Œ<code>web</code> é€šè¿‡ä¸Šä¼ æ–‡ä»¶æ¥åœ¨é¡µé¢è¡¨æ ¼é‡Œé¢„è§ˆï¼Œç„¶åå†å°† <code>excel</code> æ–‡ä»¶ç»‘å®šä¸€äº›è¡¨å•çš„æ•°æ®ä¸€èµ·æ‰“åŒ…å‘é€ç»™åå°ï¼Œæœ‰ç‚¹ç±»ä¼¼äºè¡¨å•ä¸­åµŒå¥—äº†æ–‡ä»¶ä¸Šä¼ ï¼Œæœ€åå†æäº¤è¡¨å•ã€‚</p><h4 id="ä¸€äº›æƒ³æ³•å’Œå¯¹äº¤äº’çš„è°ƒæ•´"><a href="#ä¸€äº›æƒ³æ³•å’Œå¯¹äº¤äº’çš„è°ƒæ•´" class="headerlink" title="ä¸€äº›æƒ³æ³•å’Œå¯¹äº¤äº’çš„è°ƒæ•´"></a>ä¸€äº›æƒ³æ³•å’Œå¯¹äº¤äº’çš„è°ƒæ•´</h4><p>æœ€åˆçš„é¡µé¢è®¾è®¡æ˜¯æ”¾åœ¨æ­¥éª¤æ¡é‡Œä¸€å…±åˆ†ä¸ºä¸‰æ­¥ã€‚ä¸Šä¼ åœ¨æ­¥éª¤æ¡çš„ç¬¬ä¸€æ­¥ï¼Œè¡¨å•åœ¨ç¬¬äºŒæ­¥ï¼Œ<code>ant-design</code> çš„æ­¥éª¤æ¡åœ¨åˆ‡æ¢ä¸Šä¸‹æ­¥éª¤ä¹‹åï¼Œä¸Šä¸€ä¸ªç»„ä»¶çš„ <code>dom</code> ä¼šé”€æ¯ï¼Œå¯¼è‡´ç¬¬äºŒæ­¥æ— æ³•è·å–åˆ°ç¬¬ä¸€æ­¥åœ¨ä¸Šä¼ çš„æ—¶å€™ç”Ÿæˆçš„æ–‡ä»¶å¯¹è±¡ï¼Œä¹Ÿå°±æ— æ³•ä¸Šä¼ æ–‡ä»¶ã€‚äºæ˜¯åæ¥è°ƒæ•´é¡µé¢ï¼Œå°†è¡¨å•å’Œä¸Šä¼ æ–‡ä»¶æ”¾åœ¨ä¸€ä¸ªé¡µé¢ï¼Œè¿™æ ·åœ¨è§£ææ–‡ä»¶æˆåŠŸä¹‹åï¼Œåœ¨å½“å‰è¿™ä¸€æ­¥é‡Œå°±èƒ½ä¸€ç›´è·å–åˆ°æ–‡ä»¶çš„å¯¹è±¡ï¼Œæ‹¿åˆ°æ–‡ä»¶å¯¹è±¡å°±å¯ä»¥å‘æ¥å£å‘èµ·è¯·æ±‚ã€‚</p><h4 id="æœªä½¿ç”¨-ant-design-ä¸Šä¼ ç»„ä»¶çš„åŸå› "><a href="#æœªä½¿ç”¨-ant-design-ä¸Šä¼ ç»„ä»¶çš„åŸå› " class="headerlink" title="æœªä½¿ç”¨ ant-design ä¸Šä¼ ç»„ä»¶çš„åŸå› "></a>æœªä½¿ç”¨ <code>ant-design</code> ä¸Šä¼ ç»„ä»¶çš„åŸå› </h4><p><code>ant-design</code> çš„ <code>Upload</code> ç»„ä»¶ä¸Šä¼ ä¹‹åçš„æ–‡ä»¶å¯¹è±¡ä¼šç«‹é©¬è¿”å›ï¼Œä½†æ˜¯å‰ç«¯æ— æ³•å°†è¿™ä¸ªå¯¹è±¡ä¸€ç›´æ‹¿ç€åœ¨æäº¤çš„æ—¶å€™å†ç»™æ¥å£ï¼Œå› ä¸ºæ–‡ä»¶å¯¹è±¡çš„ä¸€äº› <code>key</code> ä¸èƒ½æ‹·è´è¿‡å»ã€ä¹Ÿæ˜¯è¿™æ¬¡æ‰å‘ç°åªæœ‰ <code>uid</code> ä¸€ä¸ªå­—æ®µå¯ä»¥éå†ã€‘ï¼Œè€Œä¸”åœ¨é€šè¿‡ <code>document.getElementById(&#39;file&#39;).files</code> è·å–ä¸Šä¼ çš„æ–‡ä»¶å¯¹ï¼Œå…¶ <code>FileList</code> æ˜¯ <code>{length: 0}</code>ï¼Œæ‰€ä»¥åæ¥é€‰æ‹©åˆ©ç”¨åŸç”Ÿ <code>input</code> æ¥è§£å†³é—®é¢˜ï¼Œé€šè¿‡åˆ›å»º <code>ref</code> å°† <code>input</code> çš„ <code>dom</code> å±æ€§å­˜èµ·æ¥ï¼Œç„¶åå°† <code>ref</code> è·å–çš„å±æ€§è¿”å›åˆ°çˆ¶ç»„ä»¶ï¼Œåœ¨çˆ¶ç»„ä»¶é‡Œæäº¤çš„æ—¶å€™ï¼Œè·å– <code>ref</code> ä¸­çš„æ–‡ä»¶å¯¹è±¡ï¼Œä¼ é€’ç»™æ¥å£ã€‚</p><h4 id="å…·ä½“æ€è·¯"><a href="#å…·ä½“æ€è·¯" class="headerlink" title="å…·ä½“æ€è·¯"></a>å…·ä½“æ€è·¯</h4><ul><li>åˆ›å»º <code>ref</code> å¯¹è±¡æ¥å­˜å‚¨ <code>input</code> <code>dom</code> å±æ€§</li><li>åˆå§‹åŒ–åˆ©ç”¨ <code>addEventListener</code> æ¥ç›‘å¬åŸç”Ÿ <code>input</code> çš„ <code>change</code> äº‹ä»¶</li><li>åˆ©ç”¨ <code>button</code> è¦†ç›–é»˜è®¤çš„ä¸Šä¼ æ ·å¼ï¼Œç‚¹å‡» <code>button</code> çš„æ—¶å€™æ¨¡æ‹Ÿè§¦å‘ç‚¹å‡» <code>input</code> ä¸Šä¼ </li><li>æ•è·åˆ°äº‹ä»¶ä¹‹åï¼ŒæˆåŠŸè·å–åˆ°æ–‡ä»¶å¯¹è±¡ï¼Œä¾æ¬¡å°†æ–‡ä»¶å¯¹è±¡ä¼ é€’ç»™ <code>xlsx</code> æ¥è§£æä¸º <code>json</code> æ•°æ®ï¼Œå†å°† <code>json</code> æ•°æ®ä¼ é€’ç»™ <code>and-table</code> æ¥æ˜¾ç¤ºé¢„è§ˆã€å°† <code>input</code> çš„ <code>ref</code> å±æ€§å€¼å›ä¼ åˆ°çˆ¶ç»„ä»¶ï¼ˆ<code>handleFileInputRefs</code> æ–¹æ³•æ˜¯çˆ¶ç»„ä»¶ä¼ é€’çš„ <code>props</code> æ¥è·å–è‡ªç»„ä»¶çš„ <code>input ref</code>ï¼‰</li><li>çˆ¶ç»„ä»¶ä¸­ä¹Ÿå·²ç»æ¥å—äº†è¡¨å•çš„æ•°æ®ï¼Œå¹¶ä¸”æ¥å—äº† <code>input</code> çš„å±æ€§ï¼Œé€šè¿‡ <code>FormData</code> å°†æ•°æ®å’Œæ–‡ä»¶æ··ä¼ ç»™ <code>node</code> çš„ <code>controller</code></li><li><code>controller</code> è·å–åˆ°æ–‡ä»¶å¯¹è±¡å’Œé¢å¤–çš„è¡¨å•å‚æ•°ï¼Œå†å‘çœŸæ­£çš„æ¥å£å‘èµ·è¯·æ±‚</li></ul><h4 id="ä¼ªä»£ç "><a href="#ä¼ªä»£ç " class="headerlink" title="ä¼ªä»£ç "></a>ä¼ªä»£ç </h4><h5 id="å‰ç«¯"><a href="#å‰ç«¯" class="headerlink" title="å‰ç«¯"></a>å‰ç«¯</h5><p>å­ç»„ä»¶ <code>paresExcel.tsx</code></p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-keyword">const</span> ONE_M_TO_BYTES: number = <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>;<br><span class="hljs-keyword">const</span> MAX_FILE_SIZE: number = <span class="hljs-number">10</span>;<br><br><span class="hljs-comment">// åˆå§‹åŒ–å®šä¹‰refæ¥å­˜å‚¨input domå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡é‡Œçš„fileså¯¹è±¡å¯ä»¥ä¸€ç›´è·å–åˆ°</span><br><span class="hljs-keyword">const</span> uploadInput = useRef(<span class="hljs-keyword">null</span>);<br><br><span class="hljs-comment"><span class="markdown">/**<br><span class="hljs-bullet"> * </span>è·å–columnçš„å¯¹è±¡keyï¼Œæ•°ç»„è½¬å¯¹è±¡<br><span class="hljs-bullet"> * </span>tableColumnKey æ˜¯çˆ¶ç»„ä»¶ä¼ é€’å›æ¥çš„tableçš„jsonï¼Œç±»ä¼¼<br><span class="hljs-bullet"> *<br> </span>* [&#123;<br><span class="hljs-bullet"> *    </span>title: 'å…³é”®è¯',<br><span class="hljs-bullet"> *    </span>dataIndex: 'word',<br><span class="hljs-bullet"> *    </span>key: 'word',<br><span class="hljs-bullet"> *  </span>&#125;,<br><span class="hljs-bullet"> *  </span>&#123;<br><span class="hljs-bullet"> *    </span>title: 'è±å…è¯',<br><span class="hljs-bullet"> *    </span>dataIndex: 'exWord',<br><span class="hljs-bullet"> *    </span>key: 'exWord',<br><span class="hljs-bullet"> *  </span>&#125;]<br> */</span></span><br><span class="hljs-keyword">const</span> formatTitleOrFileld = () =&gt; &#123;<br>  <span class="hljs-keyword">const</span> entozh = tableColumnKey.map((item, index) =&gt; &#123;<br>    <span class="hljs-keyword">return</span> &#123;<br>      index,<br>      key: item.key,<br>    &#125;;<br>  &#125;);<br>  <span class="hljs-keyword">return</span> entozh;<br>&#125;;<br><br><span class="hljs-comment"><span class="markdown">/**<br><span class="hljs-bullet"> * </span>è¿™ä¸ªæ–¹æ³•å…¶å®å°±æ˜¯å°†æ•°æ®è½¬ä¸ºè¡¨æ ¼å¯ä»¥ç”¨çš„json<br> */</span></span><br><span class="hljs-keyword">const</span> handleImpotedJson = () =&gt; &#123;<br>  <span class="hljs-keyword">const</span> [header, ...tableBody] = jsonArr;<br>  <span class="hljs-keyword">const</span> keysArr = formatTitleOrFileld();<br>  <span class="hljs-keyword">const</span> len = header.length;<br><br>  <span class="hljs-comment">// ç¨€ç–æ•°ç»„è¡¥å…¨emptyé¡¹ï¼Œå› ä¸ºexcelä¸­æœ‰çš„æ•°æ®æ˜¯ç©ºï¼Œè§£æå‡ºæ¥çš„æ•°æ®æ˜¯ç´¢å¼•ä¸è¿ç»­çš„ï¼Œè¿™ä¸€æ­¥çš„ç›®çš„å°±æ˜¯è¡¥å…¨index</span><br>  tableBody.forEach((item: any) =&gt; &#123;<br>    <span class="hljs-keyword">for</span> (let i = <span class="hljs-number">0</span>; i &lt;= len - <span class="hljs-number">1</span>; i++) &#123;<br>      item[i] = item[i] || <span class="hljs-string">''</span>;<br>    &#125;<br>  &#125;);<br><br>  <span class="hljs-comment"><span class="markdown">/**<br><span class="hljs-bullet">   * </span>å°†è§£æçš„excelæ•°æ®è½¬æ¢ä¸ºant-tableæ”¯æŒæ¸²æŸ“çš„æ•°æ®æ ¼å¼<br>   */</span></span><br>  <span class="hljs-keyword">const</span> parsedExcelData = tableBody.map((ele: any) =&gt; &#123;<br>    <span class="hljs-keyword">const</span> newitem = &#123;&#125;;<br>    ele.forEach((im: any, i: number) =&gt; &#123;<br>      <span class="hljs-keyword">const</span> newKey = keysArr[i].key;<br>      newitem[newKey] = im;<br>    &#125;);<br>    <span class="hljs-keyword">return</span> newitem;<br>  &#125;);<br>&#125;<br><br><span class="hljs-comment"><span class="markdown">/**<br><span class="hljs-bullet"> * </span>ä¸Šä¼ æ–‡ä»¶çš„æ–¹æ³•ï¼Œä¸»è¦åšä¸€äº›æ–‡ä»¶å¤§å°çš„åˆ¤æ–­ã€æ–‡ä»¶çš„è¯»å–å°†excelçš„æ•°æ®è½¬æ¢ä¸ºjson<br><span class="hljs-bullet"> * </span>è¿™é‡Œæœ‰ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„æ–¹æ³•æ˜¯ï¼Œè§£æå®Œæˆçš„jsonæ•°æ®ï¼Œå®é™…ä¸Šæ˜¯æ²¡æœ‰keyçš„<br><span class="hljs-bullet"> * </span>è¡¨æ ¼åœ¨å±•ç¤ºçš„æ—¶å€™éœ€è¦keyå¯¹åº”ä¸Šï¼Œvalueæ‰ä¼šåœ¨è¡¨æ ¼é‡Œæ˜¾ç¤ºï¼Œæ‰€ä»¥éœ€è¦è°ƒæ–¹æ³•å¤„ç†ä¸€ä¸‹<br> */</span></span><br><span class="hljs-keyword">const</span> beforeUpload = (file: any) =&gt; &#123;<br>  <span class="hljs-keyword">if</span> (file.size / ONE_M_TO_BYTES &gt; MAX_FILE_SIZE) &#123;<br><br>    message.warning(<span class="hljs-string">'è¯·ä¸Šä¼ å°äº10Mçš„æ–‡ä»¶ï¼'</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span><br><br>  &#125; <span class="hljs-keyword">else</span> &#123;<br><br>    <span class="hljs-keyword">const</span> f = file;<br>    <span class="hljs-keyword">const</span> reader = <span class="hljs-keyword">new</span> FileReader();<br><br>    reader.onload = function(e) &#123;<br>      <span class="hljs-keyword">const</span> datas = e?.target?.result;<br>      <span class="hljs-comment">// è§£ædatas</span><br>      <span class="hljs-keyword">const</span> workbook = XLSX.read(datas, &#123;<br>        type: <span class="hljs-string">'binary'</span>,<br>      &#125;);<br><br>      <span class="hljs-comment">// æ˜¯å·¥ä½œç°¿ä¸­çš„å·¥ä½œè¡¨çš„æœ‰åºåˆ—è¡¨</span><br>      <span class="hljs-keyword">const</span> first_worksheet = workbook.Sheets[workbook.SheetNames[<span class="hljs-number">0</span>]];<br>      <span class="hljs-comment">// å°†å·¥ä½œç°¿å¯¹è±¡è½¬æ¢ä¸ºJSONå¯¹è±¡æ•°ç»„</span><br>      <span class="hljs-keyword">const</span> jsonArr = XLSX.utils.sheet_to_json(first_worksheet, &#123; header: <span class="hljs-number">1</span> &#125;);<br><br>      handleImpotedJson(jsonArr);<br>    &#125;;<br><br>    reader.readAsBinaryString(f);<br>  &#125;<br>&#125;;<br><br><span class="hljs-comment">// åœ¨äº‹ä»¶ç›‘å¬æ–‡ä»¶çš„changeçš„å›è°ƒå‡½æ•°ä¸­ï¼Œè·å–åˆ°æ–‡ä»¶å¯¹è±¡ä¹‹åè°ƒç”¨æ–¹æ³•æ¥å°†excelæ•°æ®è§£æä¸ºjson</span><br><span class="hljs-keyword">const</span> handleUpload = () =&gt; &#123;<br>  beforeUpload(uploadInput?.current?.files[<span class="hljs-number">0</span>]);<br>&#125;;<br><br><span class="hljs-comment">// ç‚¹å‡»æŒ‰é’®çš„æ—¶å€™ï¼Œè§¦å‘inputçš„ä¸Šä¼ clickäº‹ä»¶</span><br><span class="hljs-keyword">const</span> handleFakeUpload = () =&gt; &#123;<br>  uploadInput?.current?.click();<br>&#125;;<br><br>useEffect(() =&gt; &#123;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>) &#123;<br>    <span class="hljs-comment"><span class="markdown">/**<br><span class="hljs-bullet">      * </span>ç›‘å¬inputä¸Šä¼ äº‹ä»¶ åœ¨å¾—åˆ°æ–‡ä»¶æµä¹‹å æŠŠinputçš„refå›ä¼ åˆ°çˆ¶ç»„ä»¶<br><span class="hljs-bullet">      * </span>å¹¶ä¸”è§£ææ–‡ä»¶è½¬ä¸ºjsonæ¥åœ¨è¡¨æ ¼é‡Œæ˜¾ç¤º<br><span class="hljs-code">      */</span></span></span><br>    <span class="hljs-built_in">document</span>.<span class="hljs-built_in">querySelector</span>(`[name=uploadExcel]`)!.addEventListener(<span class="hljs-string">'change'</span>, function(event) &#123;<br>      <span class="hljs-keyword">if</span> (event?.target &amp;&amp; event?.target?.files) &#123;<br>        handleFileInputRefs &amp;&amp; handleFileInputRefs(uploadInput);<br>        handleUpload();<br>      &#125;<br>    &#125;);<br>  &#125;<br>&#125;, []);<br><br><span class="hljs-keyword">return</span> (<br>  &lt;div className=<span class="hljs-string">"fix-input-button"</span>&gt;<br>    &lt;input type=<span class="hljs-string">"file"</span> name=<span class="hljs-string">"uploadExcel"</span> ref=&#123;uploadInput&#125; /&gt;<br>    &lt;Button icon=&#123;&lt;Iconfont name=<span class="hljs-string">"iconshangchuan"</span> /&gt;&#125; onClick=&#123;handleFakeUpload&#125;&gt;<br>      ä¸Šä¼ <br>    &lt;/Button&gt;<br>  &lt;/div&gt;<br>)<br></code></pre></td></tr></table></figure><p>çˆ¶ç»„ä»¶</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-comment">// uploadRefs æ˜¯useStateå®šä¹‰çš„ä¿å­˜refçš„å˜é‡</span><br><br><span class="hljs-keyword">const</span> formData = <span class="hljs-keyword">new</span> FormData();<br><br>formData.append(<span class="hljs-string">'fileStream'</span>, uploadRefs?.current?.files[<span class="hljs-number">0</span>]);<br><span class="hljs-comment">// æ¥å£è¿˜éœ€è¦ä¸€äº›åˆ«çš„å‚æ•°</span><br>formData.append(<span class="hljs-string">'connectBusiness'</span>, <span class="hljs-built_in">JSON</span>.stringify(connectBusiness));<br><span class="hljs-comment">/**<br>  * è¿™é‡Œä¸èƒ½è®¾ç½®è¯·æ±‚å¤´<br>  * æµè§ˆå™¨æ£€æµ‹åˆ°åè‡ªå·±åŠ ä¸Š Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryXXXx è¿™æ ·<br>  */</span><br>setIsLoading(<span class="hljs-literal">true</span>)<br>fetch(<span class="hljs-string">'/api/appName/parseExcelUpload'</span>, &#123;<br>  <span class="hljs-attr">method</span>: <span class="hljs-string">'post'</span>,<br>  <span class="hljs-attr">body</span>: formData,<br>&#125;)<br>  .then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> response.json())<br>  .then(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> &#123;<br>    <span class="hljs-built_in">console</span>.log(data);<br>  &#125;)<br>  .catch(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> &#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'err'</span>, err);<br>  &#125;)<br>  .finally(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>    setIsLoading(<span class="hljs-literal">false</span>);<br>  &#125;);<br></code></pre></td></tr></table></figure><h5 id="node-å±‚"><a href="#node-å±‚" class="headerlink" title="node å±‚"></a><code>node</code> å±‚</h5><p><code>node</code> ç”¨çš„æ˜¯ <code>thinkjs</code>ï¼Œ<code>controller</code> å…¶å®å¾ˆç®€å•ï¼ŒåŒ…è£…ä¸€ä¸‹ç„¶åè¯·æ±‚çœŸæ­£çš„æ¥å£é¿å…ç›´æ¥è°ƒæ¥å£è·¨åŸŸ</p><p>ä¼ªä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-keyword">const</span> Base = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../base'</span>);<br><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);<br><span class="hljs-keyword">const</span> request = <span class="hljs-built_in">require</span>(<span class="hljs-string">'request'</span>);<br><br><span class="hljs-keyword">const</span> UPLOAD_SERVICE = <span class="hljs-string">'http://xxx'</span>;<br><br><span class="hljs-built_in">module</span>.exports = <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Base</span> </span>&#123;<br><br>  <span class="hljs-keyword">constructor</span>(props) &#123;<br>    <span class="hljs-keyword">super</span>(props)<br>  &#125;<br><br>  <span class="hljs-keyword">async</span> parseExcelUploadAction() &#123;<br><br>    <span class="hljs-comment">// è·å–æ–‡ä»¶ä¿¡æ¯</span><br>    <span class="hljs-keyword">const</span> files = <span class="hljs-keyword">this</span>.file(<span class="hljs-string">'fileStream'</span>);<br><br>    <span class="hljs-comment">// åˆ©ç”¨requestå‘èµ·è¯·æ±‚</span><br>    <span class="hljs-keyword">var</span> req = request.post(UPLOAD_SERVICE, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, resp, body</span>) </span>&#123;<br>      <span class="hljs-keyword">if</span> (err) &#123;<br>        <span class="hljs-keyword">this</span>.json(&#123;<br>          <span class="hljs-attr">status</span>: <span class="hljs-string">'failed'</span>,<br>          <span class="hljs-attr">msg</span>: <span class="hljs-string">`ä¸Šä¼ å¤±è´¥ï¼Œurl:<span class="hljs-subst">$&#123;UPLOAD_SERVICE&#125;</span>`</span><br>        &#125;)<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">this</span>.json(&#123;<br>          <span class="hljs-attr">status</span>: <span class="hljs-string">'success'</span>,<br>          <span class="hljs-attr">data</span>: body<br>        &#125;)<br>        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'è¿”å›è¯·æ±‚'</span> + body);<br>      &#125;<br>    &#125;);<br><br>    <span class="hljs-keyword">var</span> form = req.form();<br><br>    <span class="hljs-comment">// requestä¸Šä¼ æ–‡ä»¶çš„æ—¶å€™éœ€è¦appendä¸€äº›streamå’Œstring</span><br>    <span class="hljs-comment">// nodeä¹Ÿä¼šè‡ªå·±è·å–å‰ç«¯ä¸Šä¼ å‘èµ·è¯·æ±‚çš„å¤´ Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryXXXx</span><br>    form.append(<span class="hljs-string">'file'</span>, fs.createReadStream(files.path), &#123;<br>      <span class="hljs-attr">filename</span>: files.name,<br>      <span class="hljs-attr">contentType</span>: <span class="hljs-string">'application/vnd.ms-excel'</span><br>    &#125;);<br><br>    form.append(<span class="hljs-string">'connectBusiness'</span>, <span class="hljs-built_in">JSON</span>.stringify(<span class="hljs-keyword">this</span>.post(<span class="hljs-string">'connectBusiness'</span>)));<br>  &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><p>è‡³æ­¤é€šè¿‡ <code>node</code> ä¸­é—´å±‚æ¥ä¸Šä¼ çš„ä¸€ä¸ªåŠŸèƒ½å®ç°äº†ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>React</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>umi ä¸­ä½¿ç”¨ iconfont</title>
    <link href="/2020/12/21/umiUseIconfont/"/>
    <url>/2020/12/21/umiUseIconfont/</url>
    
    <content type="html"><![CDATA[<p><code>ant-design</code> è‡ªå¸¦çš„ <code>icon</code> ç§ç±»å¤ªå°‘ï¼Œé‚æ‰¾æ›¿ä»£æ–¹æ¡ˆ <code>iconfont</code>ã€‚</p><p>é¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ªå‡½æ•°ç»„ä»¶ï¼Œä½¿å…¶æ¥å—ä¸€ä¸ªåä¸º <code>name</code> æˆ–è€… <code>type</code> çš„å‚æ•°ï¼Œç”¨æ¥æŒ‡å®šå½“å‰æ¸²æŸ“çš„ <code>icon</code> åç§°ã€‚</p><p><code>Iconfont.tsx</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">'./index.less'</span>;<br><br>interface IconfontProps &#123;<br>  <span class="hljs-attr">name</span>: string;<br>  className?: string;<br>&#125;<br><br><span class="hljs-keyword">const</span> Iconfont: React.FC&lt;IconfontProps&gt; = <span class="hljs-function">(<span class="hljs-params">&#123; name, className = <span class="hljs-string">''</span> &#125;</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">return</span> (<br>    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&#123;</span>`<span class="hljs-attr">icon</span> $&#123;<span class="hljs-attr">className</span>&#125;`&#125; <span class="hljs-attr">aria-hidden</span>=<span class="hljs-string">"true"</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">use</span> <span class="hljs-attr">xlinkHref</span>=<span class="hljs-string">&#123;</span>`#$&#123;<span class="hljs-attr">name</span>&#125;`&#125;&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">use</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span></span><br>  );<br>&#125;;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> Iconfont;<br></code></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs undefined">&lt;!<span class="hljs-selector-tag">--</span> è¿™å…¶ä¸­çš„æ ·å¼æ ¹æ®é¡¹ç›®è°ƒæ•´ <span class="hljs-selector-tag">--</span>&gt;<br><span class="hljs-selector-class">.icon</span> &#123;<br>  <span class="hljs-attribute">width</span>: <span class="hljs-number">22px</span>;<br>  <span class="hljs-attribute">height</span>: <span class="hljs-number">22px</span>;<br>  <span class="hljs-attribute">vertical-align</span>: -<span class="hljs-number">4px</span>;<br>  <span class="hljs-attribute">fill</span>: currentColor;<br>  <span class="hljs-attribute">overflow</span>: hidden;<br>&#125;<br></code></pre></td></tr></table></figure><p><code>Umi.rc</code>ä¸­é…ç½®åœ¨ <code>iconfont</code> ä¸­ç”Ÿæˆçš„é™æ€èµ„æºåœ°å€ã€‚</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-symbol">plugins:</span> [<br><span class="hljs-symbol">  scripts:</span> [<br>    &#123;<br><span class="hljs-symbol">      src:</span> `<span class="hljs-comment">//at.alicdn.com/t/font_xxx_jxx.js`,</span><br>    &#125;<br>  ]<br>]<br></code></pre></td></tr></table></figure><p><code>tsx</code> ä¸­ä½¿ç”¨ã€‚</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-keyword">import</span> Iconfont <span class="hljs-keyword">from</span> <span class="hljs-string">'Iconfont'</span><br><br>&lt;Iconfont name=<span class="hljs-string">"xxx"</span>/&gt;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>React</tag>
      
      <tag>umi</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>momentjs ä¸€é”®åˆ‡æ¢ä¸º dayjs</title>
    <link href="/2020/12/21/replaceMomentTodayjs/"/>
    <url>/2020/12/21/replaceMomentTodayjs/</url>
    
    <content type="html"><![CDATA[<p>å…¬å¸ <code>umi</code> åˆ›å»ºçš„é¡¹ç›®ä¸­ï¼Œæ—¶é—´çš„å¤„ç†ä½¿ç”¨çš„æ˜¯ <code>momentjs</code>ï¼Œç»„ä»¶ç”¨çš„ <code>ant-design</code>ï¼Œè€Œä¸” <code>ant-design</code> çš„æ—¥æœŸåº•å±‚çš„æ—¶é—´å¤„ç†ä¹Ÿæ˜¯ç”¨çš„ <code>moment</code>ã€‚é¡¹ç›®ä¸€æ¬¡æ‰“åŒ…æˆåŠŸä¹‹åå‘ç° <code>moment</code> å çš„ä½“ç§¯æ¯”è¾ƒå¤§ï¼Œäºæ˜¯è€ƒè™‘ä¸‹å°† <code>moment</code> åˆ‡æ¢ä¸ºæ¯”è¾ƒå°çš„ <code>dayjs</code>ã€‚</p><p><code>.umirc.ts</code> çš„é»˜è®¤é…ç½®ä¸­æ˜¯æ”¯æŒä¸å°† <code>locale</code> æ–‡ä»¶æ‰“åŒ…è¿›å»çš„ï¼Œä½†æ˜¯éœ€è¦é…ç½® <code>ignoreMomentLocale:true</code> æ¥å¼€å¯ï¼Œä½†æ˜¯è™½ç„¶å¼€å¯ä¹‹åä»ç„¶è¿˜æ˜¯æœ‰ <code>54kb</code> å·¦å³çš„å¤§å°ï¼Œäºæ˜¯è€ƒè™‘å°†å…¶æ¢åš <code>dayjs</code>ï¼Œå…·ä½“çš„æ˜¯åˆ©ç”¨ <code>antd-dayjs-webpack-plugin</code> æ’ä»¶ï¼Œæ­¤æ’ä»¶æ˜¯å·²ç»å°† <code>moment</code> æ›¿æ¢ä¸º <code>dayjs</code>ï¼Œä¹‹å‰é¡¹ç›®é‡Œå†™çš„ <code>import moment from &#39;moment&#39;</code>ï¼Œå¯ä»¥ç»§ç»­ä½¿ç”¨ï¼Œè™½ç„¶å¼•å…¥çš„æ˜¯ <code>moment</code>ï¼Œä½†å…¶å®å¼•ç”¨çš„æ˜¯ <code>dayjs</code>ï¼Œè¿™æ˜¯å› ä¸ºè¿™ä¸ªæ’ä»¶çš„åº•å±‚ <code>alias</code> äº†åç§°ã€‚æ‰€ä»¥åœ¨ <code>dayjs</code> ä¸æ”¯æŒçš„ä¸€äº›åœ°æ–¹ï¼Œéœ€è¦åˆ©ç”¨ <code>dayjs</code> çš„æ‰©å±•æ–¹æ³•æ¥å¢åŠ ï¼Œä¾‹å¦‚æˆ‘çš„é¡¹ç›®ä¸­ä½¿ç”¨äº† <code>utc</code>ï¼Œæ‰€ä»¥éœ€è¦åœ¨ <code>global.ts</code> é‡Œå…ˆ<br><code>var utc = require(&#39;dayjs/plugin/utc&#39;)</code> å¼•å…¥ <code>dayjs</code> çš„ <code>utc</code> æ’ä»¶ï¼Œå†<code>dayjs.extend(utc)</code> æ‹“å±•ï¼Œä½¿ç”¨å°±å¯ä»¥äº†ã€‚</p><p>è€Œ <code>.umirc.ts</code> å…·ä½“çš„é…ç½®ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-keyword">import</span> AntdDayjsWebpackPlugin from <span class="hljs-string">'antd-dayjs-webpack-plugin'</span>;<br><br>chainWebpack(<span class="hljs-built_in">config</span>) &#123;<br>  <span class="hljs-built_in">config</span>.plugin(<span class="hljs-string">'dayjs'</span>).use(AntdDayjsWebpackPlugin);<br>&#125;<br></code></pre></td></tr></table></figure><p>è‡³äº <code>ignoreMomentLocale:true</code> çš„åŸç†åº”è¯¥æ˜¯ä½¿ç”¨çš„ <code>webpack</code> çš„ <code>ContextReplacementPlugin</code></p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs undefined">chainWebpack(config) &#123;<br><br>  <span class="hljs-regexp">//</span>è¿‡æ»¤æ‰ momnet çš„é‚£äº›ä¸ä½¿ç”¨çš„å›½é™…åŒ–æ–‡ä»¶ åªé€‰æ‹©zh-cn<br>  <br>  config<br>    .plugin(<span class="hljs-string">'replace'</span>)<br>    .use(<span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack'</span>).ContextReplacementPlugin)<br>    .tap(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>        <span class="hljs-keyword">return</span> [<span class="hljs-regexp">/moment[\/\\]locale$/</span>, <span class="hljs-regexp">/zh-cn/</span>];<br>  &#125;);<br>&#125;,<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>React</tag>
      
      <tag>webpack</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>TypeScript å·¥å…·ç±»å‹ä½¿ç”¨æ€»ç»“</title>
    <link href="/2020/11/22/TypeScriptUse/"/>
    <url>/2020/11/22/TypeScriptUse/</url>
    
    <content type="html"><![CDATA[<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-keyword">interface</span> IMyInfo = &#123;<br>  name: <span class="hljs-built_in">string</span><br>  age: <span class="hljs-built_in">number</span><br>  address: <span class="hljs-built_in">string</span><br>  money: <span class="hljs-built_in">number</span><br>&#125;<br><br><span class="hljs-keyword">type</span> BasicSelect = <span class="hljs-string">'name'</span> | <span class="hljs-string">'age'</span><br></code></pre></td></tr></table></figure><h3 id="keyof"><a href="#keyof" class="headerlink" title="keyof"></a><code>keyof</code></h3><ul><li>è¯¥æ“ä½œç¬¦å¯ä»¥ç”¨äºè·å–æŸç§ç±»å‹çš„æ‰€æœ‰é”®ï¼Œå…¶è¿”å›ç±»å‹æ˜¯è”åˆç±»å‹ã€‚</li><li>ä¾‹å¦‚ï¼š<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-keyword">type</span> <span class="hljs-type">koT </span>= keyof IMyInfo<br><br>// <span class="hljs-keyword">type</span> <span class="hljs-type">koT </span>= <span class="hljs-string">"name"</span> | <span class="hljs-string">"age"</span> | <span class="hljs-string">"address"</span> | <span class="hljs-string">"money"</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="typeof"><a href="#typeof" class="headerlink" title="typeof"></a><code>typeof</code></h3><ul><li><code>typeof</code> æ“ä½œç¬¦å¯ä»¥ç”¨æ¥è·å–ä¸€ä¸ªå˜é‡å£°æ˜æˆ–å¯¹è±¡çš„ç±»å‹<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-title">naBasicT</span></span> = <span class="hljs-symbol">'name</span>' | <span class="hljs-symbol">'age</span>'<br><br><span class="hljs-comment">// ä»Tä¸­é€‰æ‹©å‡ºKçš„ç±»å‹ä½œä¸ºå½“å‰å˜é‡çš„ç±»å‹</span><br><span class="hljs-keyword">const</span> naData: Pick&lt;IMyInfo, naBasicT&gt;  = &#123;<br>  name: <span class="hljs-symbol">'sss</span>',<br>  age: <span class="hljs-number">1</span><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-title">naT</span></span> = <span class="hljs-keyword">typeof</span> naData<br><br><span class="hljs-comment">// ç­‰ä»·äº </span><br><span class="hljs-comment">// type naT = &#123;</span><br><span class="hljs-comment">//   name: string;</span><br><span class="hljs-comment">//   age: number;</span><br><span class="hljs-comment">// &#125;</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="in"><a href="#in" class="headerlink" title="in"></a><code>in</code></h3><ul><li>éå†æšä¸¾ç±»å‹æˆ–åˆ¤æ–­åœ¨ä¸åœ¨æŸä¸€ä¸ªç±»å‹ä¸­<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-built_in">type</span> Keys = <span class="hljs-string">"a"</span> | <span class="hljs-string">"b"</span> | <span class="hljs-string">"c"</span><br><br><span class="hljs-built_in">type</span> Obj =  &#123;<br>  [<span class="hljs-keyword">P</span> in Keys]: <span class="hljs-built_in">string</span><br>&#125;<br><br>// &#123; <span class="hljs-variable">a:</span> <span class="hljs-built_in">string</span>, <span class="hljs-variable">b:</span> <span class="hljs-built_in">string</span>, <span class="hljs-keyword">c</span>: <span class="hljs-built_in">string</span> &#125;<br></code></pre></td></tr></table></figure></li></ul><h3 id="extends"><a href="#extends" class="headerlink" title="extends"></a><code>extends</code></h3><ul><li>ç†è§£ä¸ºçº¦æŸæ¯”è¾ƒå¥½<figure class="highlight scilab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-built_in">type</span> Len = &#123;<br>  <span class="hljs-built_in">length</span>: number<br>&#125;<br><br><span class="hljs-comment">// åˆ©ç”¨Lenç±»å‹æ¥çº¦æŸTä½¿å…¶å…·æœ‰lengthçš„ç±»å‹</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getLen</span>&lt;<span class="hljs-title">T</span> <span class="hljs-title">extends</span> <span class="hljs-title">Len</span>&gt; <span class="hljs-params">(arg: T)</span> &#123;</span><br>  <span class="hljs-keyword">return</span> arg.<span class="hljs-built_in">length</span><br>&#125;<br></code></pre></td></tr></table></figure></li></ul><h3 id="Pick"><a href="#Pick" class="headerlink" title="Pick"></a><code>Pick</code></h3><ul><li><code>Pick&lt;T, K&gt;</code> <code>K</code>å¯ä»¥æ˜¯ä¸€ä¸ªè”åˆç±»å‹ ä»æ³›å‹<code>T</code>ä¸­è¿‡æ»¤å‡º<code>K</code>è”åˆçš„ç±»å‹ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯åŸºå‡†ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯éœ€è¦é€‰æ‹©å‡ºæ¥çš„ç±»å‹çš„è”åˆï¼Œæˆ–è€…å•ä¸ªç±»å‹<figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-title">pickT</span> </span>= Pick&lt;IMyInfo, BasicSelect&gt;<br><br><span class="hljs-comment">// ç­‰ä»·äº type nameT = &#123;</span><br><span class="hljs-comment">//   name: string;</span><br><span class="hljs-comment">//   age: number;</span><br><span class="hljs-comment">// &#125;</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="Partial"><a href="#Partial" class="headerlink" title="Partial"></a><code>Partial</code></h3><ul><li><code>Partial&lt;T&gt;</code> å°†<code>T</code>éƒ½å˜ä¸ºå¯é€‰ç±»å‹<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-keyword">type</span> <span class="hljs-type">partialT </span>= Partial&lt;IMyInfo&gt;<br></code></pre></td></tr></table></figure></li></ul><h3 id="Required"><a href="#Required" class="headerlink" title="Required"></a><code>Required</code></h3><ul><li><code>Required&lt;T&gt;</code> å°†ä¼ å…¥çš„æ³›å‹å˜ä¸ºå¿…é€‰é¡¹<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-keyword">type</span> <span class="hljs-type">requiredT </span>= Required&lt;partialT&gt;<br></code></pre></td></tr></table></figure></li></ul><h3 id="Readonly"><a href="#Readonly" class="headerlink" title="Readonly"></a><code>Readonly</code></h3><ul><li><code>Readonly&lt;T&gt;</code> å°†æ³›å‹å˜ä¸º <code>readonly</code><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-keyword">type</span> <span class="hljs-type">readonlyT </span>= Readonly&lt;IMyInfo&gt;<br></code></pre></td></tr></table></figure></li></ul><h3 id="Record"><a href="#Record" class="headerlink" title="Record"></a><code>Record</code></h3><ul><li><code>Record&lt;K, T&gt;</code> å°†<code>T</code>çš„ç±»å‹èµ‹ç»™æ¯ä¸€ä¸ª<code>K</code><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-keyword">type</span> recodeT = <span class="hljs-keyword">Record</span>&lt;BasicSelect, IMyInfo&gt;<br><br><span class="hljs-comment">// ç­‰ä»·äº</span><br><span class="hljs-comment">// type recodeT = &#123;</span><br><span class="hljs-comment">//   name: IMyInfo;</span><br><span class="hljs-comment">//   age: IMyInfo;</span><br><span class="hljs-comment">// &#125;</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="Excludeã€Extract"><a href="#Excludeã€Extract" class="headerlink" title="Excludeã€Extract"></a><code>Exclude</code>ã€<code>Extract</code></h3><ul><li><code>Exclude&lt;T, U&gt;</code> å…¶ä¸­ <code>T</code>ï¼Œ<code>U</code> æ¯”è¾ƒï¼Œæ’é™¤<code>U</code>å’Œ<code>T</code>ä¸­å…±æœ‰ï¼Œè¿”å›<code>T</code>ä¸­å‰©ä¸‹çš„ è¿”å›çš„æ˜¯ç¬¬ä¸€ä¸ªæ³›å‹ ç¬¬ä¸€ä¸ªä½œä¸ºåŸºå‡†<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-keyword">type</span> <span class="hljs-type">T1 </span>= <span class="hljs-string">'a'</span> | <span class="hljs-string">'b'</span> | <span class="hljs-string">'c'</span> | <span class="hljs-string">'m'</span><br><span class="hljs-keyword">type</span> <span class="hljs-type">T2 </span>= <span class="hljs-string">'b'</span> | <span class="hljs-string">'c'</span> | <span class="hljs-string">'d'</span><br><br><span class="hljs-keyword">type</span> <span class="hljs-type">excludeT </span>= Exclude&lt;T1, T2&gt;<br>// ç­‰ä»·äº <span class="hljs-keyword">type</span> <span class="hljs-type">excludeT </span>= <span class="hljs-string">"a"</span><br><br><span class="hljs-keyword">type</span> <span class="hljs-type">extractT </span>= Extract&lt;T1, T2&gt;<br>// ç­‰ä»·äº <span class="hljs-keyword">type</span> <span class="hljs-type">extractT </span>= <span class="hljs-string">"b"</span> | <span class="hljs-string">"c"</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="Omit"><a href="#Omit" class="headerlink" title="Omit"></a><code>Omit</code></h3><ul><li><code>Omit&lt;T, K&gt;</code> è·Ÿ<code>Pick</code>ç±»ä¼¼ï¼Œä½†æ˜¯åŠŸèƒ½ç›¸å ä»<code>T</code>ä¸­æ’é™¤æ‰<code>K</code>çš„ç±»å‹<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-title">omitT</span></span> = Omit&lt;IMyInfo, <span class="hljs-symbol">'age</span>'&gt;<br><br><span class="hljs-comment">// ç­‰ä»·äº</span><br><span class="hljs-comment">// type omitT = &#123;</span><br><span class="hljs-comment">//   name: string;</span><br><span class="hljs-comment">//   address: string;</span><br><span class="hljs-comment">//   money: number;</span><br><span class="hljs-comment">// &#125;</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="ReturnType"><a href="#ReturnType" class="headerlink" title="ReturnType"></a><code>ReturnType</code></h3><ul><li>ä»å‡½æ•°çš„è¿”å›å€¼ä¸­æå–ç±»å‹<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">userinfo</span> <span class="hljs-params">()</span> </span>&#123;<br>  <span class="hljs-keyword">return</span> &#123;<br>    age: <span class="hljs-number">25</span>,<br>    name: <span class="hljs-string">'jack'</span><br>  &#125;<br>&#125;<br><br>type ObjT = ReturnType&lt;<span class="hljs-keyword">typeof</span> userinfo&gt;<br><br><span class="hljs-comment">// ç­‰åŒäº type ObjT = &#123;</span><br><span class="hljs-comment">//   age: number;</span><br><span class="hljs-comment">//   name: string;</span><br><span class="hljs-comment">// &#125;</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="Parameters"><a href="#Parameters" class="headerlink" title="Parameters"></a><code>Parameters</code></h3><ul><li>ä»å‡½æ•°çš„å‚æ•°ä¸­æå–å‡ºéœ€è¦çš„ç±»å‹<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs undefined">// å®šä¹‰çš„å‚æ•°ç±»å‹æ˜¯ <span class="hljs-built_in">string</span>, <span class="hljs-keyword">number</span><br><span class="hljs-built_in">type</span> fnT = &#123;<br>  (name: <span class="hljs-built_in">string</span>, age: <span class="hljs-keyword">number</span>): &#123;<br>    breif: <span class="hljs-built_in">string</span><br>  &#125;<br>&#125;<br><br><span class="hljs-built_in">type</span> TParams = Parameters<span class="hljs-symbol">&lt;fnT&gt;</span><br>// <span class="hljs-built_in">type</span> TParams = [<span class="hljs-built_in">string</span>, <span class="hljs-keyword">number</span>]<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getInfo</span> <span class="hljs-params">(name: TParams[0], age: TParams[1])</span> &#123;&#125;</span><br></code></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>TypeScript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Vue 2.X ä¸¤ä¸ªä¸åŒçš„è¿è¡Œç‰ˆæœ¬</title>
    <link href="/2020/11/08/vueVersion/"/>
    <url>/2020/11/08/vueVersion/</url>
    
    <content type="html"><![CDATA[<h2 id="Runtime-Only"><a href="#Runtime-Only" class="headerlink" title="Runtime Only"></a><code>Runtime Only</code></h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-selector-tag">new</span> <span class="hljs-selector-tag">Vue</span>(&#123;<br>  <span class="hljs-attribute">el</span>: <span class="hljs-string">'#app'</span>,<br>  router,<br>  render: h =&gt; <span class="hljs-built_in">h</span>(App)<br>&#125;)<br></code></pre></td></tr></table></figure><ul><li>è¯´æ˜ï¼š<code>vue-loader+webpack</code>ï¼Œä¼šåœ¨æ„å»ºçš„æ—¶å€™å°†<code>*.vue</code>æ‰“åŒ…ä¸ºé™æ€èµ„æºæ–‡ä»¶ï¼Œæœ€ç»ˆçš„æ–‡ä»¶æ˜¯å·²ç»è¢«é¢„ç¼–è¯‘ä¹‹åçš„é™æ€æµè§ˆå™¨å¯ä»¥è¯†åˆ«çš„èµ„æºï¼Œä¹Ÿæ˜¯ä¸éœ€è¦ç¼–è¯‘å™¨çš„å¯ä»¥ç›´æ¥è¿è¡Œçš„ï¼Œå³åªæœ‰è¿è¡Œæ—¶ã€‚</li></ul><h2 id="Runtime-Compiler"><a href="#Runtime-Compiler" class="headerlink" title="Runtime + Compiler"></a><code>Runtime + Compiler</code></h2><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-selector-tag">new</span> <span class="hljs-selector-tag">Vue</span>(&#123;<br>  <span class="hljs-attribute">el</span>: <span class="hljs-string">'#app'</span>,<br>  router,<br>  <span class="hljs-attribute">template</span>: <span class="hljs-string">'&lt;App/&gt;'</span>,<br>  <span class="hljs-attribute">components</span>: &#123; App &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><ul><li>è¿è¡Œæ—¶+ç¼–è¯‘å™¨ï¼Œåœ¨<code>vue-loader+webpack</code>æ„å»ºçš„æ—¶å€™ï¼Œæ˜¯ä¸ä¼šè¿›è¡Œç¼–è¯‘çš„ï¼Œåœ¨æµè§ˆå™¨è¿è¡Œçš„æ—¶å€™è¿›è¡Œç¼–è¯‘ã€‚</li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>Vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸¤ç§å¸¸è§çš„è®¾ç½®é”šç‚¹çš„æ–¹æ³•</title>
    <link href="/2020/11/06/anchorSetting/"/>
    <url>/2020/11/06/anchorSetting/</url>
    
    <content type="html"><![CDATA[<p>æ¦‚è¿°ï¼šåœ¨æ½œæ„è¯†é‡Œä½¿ç”¨æœ€å¤šçš„åº”è¯¥å°±æ˜¯<code>a</code>æ ‡ç­¾é…åˆå…¶ä»–æ ‡ç­¾çš„<code>id</code>å±æ€§å»åšé¡µé¢é”šç‚¹è·³è½¬ï¼Œç„¶è€Œåœ¨æœ‰<code>prompt</code>å¹¶ä¸”è·¯ç”±åœ¨å˜åŒ–çš„æ—¶å€™ä¼šå¯¼è‡´ä¸€äº›é—®é¢˜ã€‚å› ä¸ºåœ¨è®¾ç½®äº†<code>prompt</code>æœ‰æ•°æ®çš„è¯ä¼šåšç¦»å¼€é¡µé¢æ•°æ®ä¸ä¿å­˜æˆ–è€…ç»“æŸä»»åŠ¡çš„æç¤ºé€»è¾‘ï¼Œä½†æ˜¯è¿™ä¸ª<code>prompt</code>åˆæ˜¯åŸºäºè·¯ç”±çš„å˜åŒ–æ¥ç¡®å®šæœ‰æ²¡æœ‰è§¦å‘ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨ä¼ ç»Ÿçš„æ–¹æ³•å¢åŠ é”šç‚¹çš„æ—¶å€™<code>url</code>åä¼šè¿½åŠ å“ˆå¸Œå€¼å¯¼è‡´è§¦å‘äº†<code>url</code>å˜åŠ¨ï¼Œ<code>prompt</code>æ²¡æ³•ç®€å•åˆ¤æ–­å‡ºæ¥ç›®å‰æ˜¯å› ä¸ºä»€ä¹ˆäº‹ä»¶è§¦å‘ï¼Œä»è€Œå¯¼è‡´åœ¨ç‚¹å‡»é”šç‚¹çš„æ—¶å€™è§¦å‘äº†<code>prompt</code>æç¤ºã€‚æ­£å¥½æœ€è¿‘å­¦ä¹ äº†<code>scrollIntoView</code>å°±æ­£å¥½æƒ³ç€å°è¯•è§£å†³ä¸€ä¸‹ã€‚</p><ul><li><h2 id="ä¼ ç»Ÿçš„æ–¹æ³•åˆ©ç”¨aæ ‡ç­¾å’Œid"><a href="#ä¼ ç»Ÿçš„æ–¹æ³•åˆ©ç”¨aæ ‡ç­¾å’Œid" class="headerlink" title="ä¼ ç»Ÿçš„æ–¹æ³•åˆ©ç”¨aæ ‡ç­¾å’Œid"></a>ä¼ ç»Ÿçš„æ–¹æ³•åˆ©ç”¨<code>a</code>æ ‡ç­¾å’Œ<code>id</code></h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-comment">// è®¾ç½®ï¼Œç”¨æˆ·ç‚¹å‡»å¹¶è·³è½¬</span><br>&lt;<span class="hljs-selector-tag">a</span> href=<span class="hljs-string">"#anchorId"</span>&gt;é”šç‚¹<span class="hljs-number">1</span>&lt;/a&gt;<br><br><span class="hljs-comment">// å¾…è·³è½¬æ ‡è¯†çš„ä½ç½®ï¼Œä½¿ç”¨id</span><br>&lt;<span class="hljs-selector-tag">div</span> id=<span class="hljs-string">"anchorId"</span>&gt;è·³è½¬åˆ°é”šç‚¹<span class="hljs-number">1</span>&lt;/div&gt;<br><br>åœ¨ç‚¹å‡» â€œè·³è½¬åˆ°é”šç‚¹<span class="hljs-number">1</span>â€ çš„æ—¶å€™å°±ä¼šåœ¨urlä¸­åŠ å…¥å“ˆå¸Œä»è€Œå®ç°é”šç‚¹è·³è½¬<br></code></pre></td></tr></table></figure></li><li><h2 id="åˆ©ç”¨æµè§ˆå™¨h5çš„æ–°api-scrollIntoViewæ¥è§£å†³"><a href="#åˆ©ç”¨æµè§ˆå™¨h5çš„æ–°api-scrollIntoViewæ¥è§£å†³" class="headerlink" title="åˆ©ç”¨æµè§ˆå™¨h5çš„æ–°api scrollIntoViewæ¥è§£å†³"></a>åˆ©ç”¨æµè§ˆå™¨<code>h5</code>çš„æ–°<code>api scrollIntoView</code>æ¥è§£å†³</h2><ul><li><p>è¯­æ³•è¯´æ˜</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-selector-tag">element</span><span class="hljs-selector-class">.scrollIntoView</span>(); <span class="hljs-comment">// ç­‰åŒäºelement.scrollIntoView(true)</span><br><span class="hljs-selector-tag">element</span><span class="hljs-selector-class">.scrollIntoView</span>(alignToTop); <span class="hljs-comment">// Booleanå‹å‚æ•°</span><br><span class="hljs-selector-tag">element</span><span class="hljs-selector-class">.scrollIntoView</span>(scrollIntoViewOptions); <span class="hljs-comment">// Objectå‹å‚æ•°</span><br></code></pre></td></tr></table></figure></li><li><p>å‚æ•°è¯´æ˜</p><ul><li><p><code>alignToTop</code>å¯é€‰ï¼Œä¸€ä¸ª<code>Boolean</code>å€¼ï¼š</p><ul><li>å¦‚æœä¸º<code>true</code>ï¼Œå…ƒç´ çš„é¡¶ç«¯å°†å’Œå…¶æ‰€åœ¨æ»šåŠ¨åŒºçš„å¯è§†åŒºåŸŸçš„é¡¶ç«¯å¯¹é½ã€‚ç›¸åº”çš„ <code>scrollIntoViewOptions: {block: &quot;start&quot;, inline: &quot;nearest&quot;}</code>ã€‚è¿™æ˜¯è¿™ä¸ªå‚æ•°çš„é»˜è®¤å€¼ã€‚</li><li>å¦‚æœä¸º<code>false</code>ï¼Œå…ƒç´ çš„åº•ç«¯å°†å’Œå…¶æ‰€åœ¨æ»šåŠ¨åŒºçš„å¯è§†åŒºåŸŸçš„åº•ç«¯å¯¹é½ã€‚ç›¸åº”çš„<code>scrollIntoViewOptions: {block: &quot;end&quot;, inline: &quot;nearestâ€}</code>ã€‚</li></ul></li><li><p><code>scrollIntoViewOptions</code> å¯é€‰ ä¸€ä¸ªåŒ…å«ä¸‹åˆ—å±æ€§çš„å¯¹è±¡ï¼š</p><ul><li><code>behavior</code> å¯é€‰ å®šä¹‰åŠ¨ç”»è¿‡æ¸¡æ•ˆæœï¼Œ <code>auto</code>æˆ– <code>smooth</code> ä¹‹ä¸€ã€‚é»˜è®¤ä¸º <code>auto</code>ã€‚</li><li><code>block</code> å¯é€‰ å®šä¹‰å‚ç›´æ–¹å‘çš„å¯¹é½ï¼Œ <code>start</code>, <code>center</code>, <code>end</code>, æˆ– <code>nearest</code>ä¹‹ä¸€ã€‚é»˜è®¤ä¸º <code>start</code>ã€‚</li><li><code>inline</code> å¯é€‰ å®šä¹‰æ°´å¹³æ–¹å‘çš„å¯¹é½ï¼Œ <code>start</code>, <code>center</code>, <code>end</code>, æˆ– <code>nearest</code>ä¹‹ä¸€ã€‚é»˜è®¤ä¸º <code>nearest</code>ã€‚</li></ul></li></ul></li><li><p>ä¼ªä»£ç </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-comment">// å› ä¸ºæœ‰å…¼å®¹é—®é¢˜ï¼Œæ‰€ä»¥éœ€è¦ç”¨ç¬¬ä¸‰æ–¹åŒ…æ¥å¤„ç†ä¸€ä¸‹å…¼å®¹</span><br><span class="hljs-keyword">import</span> smoothscroll <span class="hljs-keyword">from</span> <span class="hljs-string">'smoothscroll-polyfill'</span>;<br>smoothscroll.polyfill();<br><br><span class="hljs-comment">// åœ¨renderä¹‹å‰ä¸ºéœ€è¦é”šç‚¹çš„å…ƒç´ å¢åŠ data-xxxå±æ€§ï¼Œåœ¨è§¦å‘å¯¹åº”çš„äº‹ä»¶ï¼Œéœ€è¦é”šç‚¹åˆ°å¯¹åº”çš„ä½ç½®çš„æ—¶å€™åˆ©ç”¨apiè·³è½¬ï¼Œå¦‚æœæ˜¯æ•°ç»„å¾ªç¯ä¸‹æ¥çš„ç»“æ„çš„è¯å¯ä»¥å°†å¯¹åº”çš„idä¼ é€’ç»™å‡½æ•°ï¼Œç‚¹å‡»çš„æ—¶å€™è·å–å¯¹åº”çš„å…ƒç´ å¹¶ä¸”å†å»æ‰§è¡Œæ“ä½œ</span><br><br><span class="hljs-keyword">const</span> scrollToAnchor = <span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// åˆ©ç”¨å±æ€§é€‰æ‹©å™¨ + querySelector</span><br>  <span class="hljs-keyword">const</span> ele = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">`[data-imageId=<span class="hljs-subst">$&#123;id&#125;</span>]`</span>)<br>  <span class="hljs-keyword">if</span> (ele) &#123;<br>    ele.scrollIntoView(&#123;<span class="hljs-attr">block</span>: <span class="hljs-string">'start'</span>, <span class="hljs-attr">behavior</span>: <span class="hljs-string">'smooth'</span>&#125;)<br>  &#125;<br>&#125;<br><br>&lt;img data-imageId=<span class="hljs-string">"img1"</span> /&gt;<br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> scrollToAnchor('img1')&#125;&gt;è·³è½¬<span class="hljs-tag">&lt;<span class="hljs-name">div</span>/&gt;</span></span><br></code></pre></td></tr></table></figure></li></ul></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>h5-api</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åŸç”Ÿå®ç°æµè§ˆå™¨æ”¯æŒçš„å›¾ç‰‡æ‡’åŠ è½½æ–¹æ¡ˆ</title>
    <link href="/2020/11/05/lazyLoad/"/>
    <url>/2020/11/05/lazyLoad/</url>
    
    <content type="html"><![CDATA[<p>æ¦‚è¿°ï¼šå› ä¸ºå†…éƒ¨é¡¹ç›®è¿è¥å·¥å…·ä¸­æœ‰é‡åˆ°å¤„ç†å¤§é‡å›¾ç‰‡åœ¨ä¸€ç¬é—´è¯·æ±‚çš„åœºæ™¯ï¼Œåœ¨å¼€å‘é˜¶æ®µé‡åˆ°äº†å¦‚æœä¸å¤„ç†å›¾ç‰‡ï¼Œä¸ç”¨æ‡’åŠ è½½çš„è¯ï¼Œæµè§ˆå™¨ä¼šåœ¨ä¸€ç¬é—´é€ æˆå¡é¡¿ï¼Œç”¨æˆ·ä½“éªŒå’Œæ•ˆæœéå¸¸å·®ã€‚</p><p>è§£å†³æ–¹æ¡ˆ</p><ul><li><h3 id="æœªè°ƒç ”çš„Reactä¸‰æ–¹æ‡’åŠ è½½åº“"><a href="#æœªè°ƒç ”çš„Reactä¸‰æ–¹æ‡’åŠ è½½åº“" class="headerlink" title="æœªè°ƒç ”çš„Reactä¸‰æ–¹æ‡’åŠ è½½åº“"></a>æœªè°ƒç ”çš„<code>React</code>ä¸‰æ–¹æ‡’åŠ è½½åº“</h3></li><li><h3 id="imgå›¾ç‰‡çš„å±æ€§loading"><a href="#imgå›¾ç‰‡çš„å±æ€§loading" class="headerlink" title="imgå›¾ç‰‡çš„å±æ€§loading"></a><code>img</code>å›¾ç‰‡çš„å±æ€§<code>loading</code></h3><p>å› ä¸ºé¡¹ç›®é‡‡ç”¨çš„æ˜¯<code>umi+ts</code>ï¼Œè€Œ<code>img</code>å±æ€§çš„<code>loading</code>å¹¶æœªæ ‡å‡†åŒ–ï¼Œè¿˜å¤„åœ¨å®éªŒé˜¶æ®µï¼Œä½†æ˜¯<code>Chrome 76+</code>å·²ç»æ”¯æŒã€‚ä»£ç ä¸­ç›´æ¥åœ¨<code>jsx</code>ä¸­ä¸º<code>img</code>æ ‡ç­¾åŠ ä¸Š<code>loading=&quot;lazy&quot;</code>å±æ€§ä¹‹åä¼šæŠ¥é”™ï¼Œæ˜¯å› ä¸º<code>ts</code>çš„ç±»å‹ä¸­<code>img</code>ä¸å­˜åœ¨<code>loading</code>çš„å±æ€§ï¼Œè§£å†³åŠæ³•æ˜¯å£°æ˜ä¸€ä¸ªç±»å‹æ–‡ä»¶ï¼Œå°†éœ€è¦è®¾ç½®çš„æ ‡ç­¾å±æ€§ç»§æ‰¿åˆ°<code>HTML</code>å±æ€§å°±å¥½äº†ï¼Œåˆ«çš„æ ‡ç­¾ä¹Ÿç±»ä¼¼ã€‚</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-comment">// react-unstable-attributes.d.ts</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">"react"</span>;<br><br>declare module <span class="hljs-string">"react"</span> &#123;<br>  <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">ImgHTMLAttributes</span>&lt;<span class="hljs-title">T</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">HTMLAttributes</span>&lt;<span class="hljs-title">T</span>&gt; &#123;</span><br>    loading?: <span class="hljs-string">"auto"</span> | <span class="hljs-string">"eager"</span> | <span class="hljs-string">"lazy"</span>;<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">// å‚æ•°</span><br>lazyï¼šå»¶è¿ŸåŠ è½½ã€‚<br>eagerï¼šç«‹å³åŠ è½½ã€‚<br>autoï¼šç”±æµè§ˆå™¨æ¥å†³å®šæ˜¯å¦å»¶è¿ŸåŠ è½½ã€‚<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯åœ¨ç›´æ¥ä¸ºå›¾ç‰‡åŠ äº†<code>loading</code>å±æ€§ä¹‹åå¹¶æ²¡æœ‰å®ç°æ‡’åŠ è½½ï¼Œåæ¥åœ¨è°ƒè¯•çš„æ—¶å€™æ„å¤–ä¸ºå›¾ç‰‡åŠ äº†<code>width</code>å°ºå¯¸ä¹‹åå‘ç°ç«Ÿç„¶ç”Ÿæ•ˆäº†ï¼Œæˆ–è®¸åœ¨çœŸå®åœºæ™¯ä¹‹ä¸‹è¿˜éœ€è¦å¾®è°ƒã€‚</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs undefined">&lt;<span class="hljs-selector-tag">img</span> loading=<span class="hljs-string">"lazy"</span> <span class="hljs-attribute">width</span>=<span class="hljs-string">"90px"</span> /&gt;<br></code></pre></td></tr></table></figure><p><code>loading=&quot;lazy&quot;</code>çš„å±æ€§å¯¹äºåˆ«çš„æµè§ˆå™¨çš„å…¼å®¹ä¸€èˆ¬ï¼Œå¯ä»¥åˆ©ç”¨<code>js</code>åˆ¤æ–­ï¼Œä¸æ”¯æŒ<code>loading</code>çš„è¯ä½¿ç”¨<code>IntersectionObserver</code>ä¼˜é›…é™çº§ã€‚<a href="https://juejin.im/post/6844903830581149710" target="_blank" rel="noopener">å¯å‚è€ƒ</a></p></li><li><h3 id="h5-IntersectionObserver-api"><a href="#h5-IntersectionObserver-api" class="headerlink" title="h5 IntersectionObserver api"></a><code>h5 IntersectionObserver api</code></h3><p><code>IntersectionObserver</code> æä¾›äº†ä¸€ç§å¼‚æ­¥æ£€æµ‹ç›®æ ‡å…ƒç´ ä¸ç¥–å…ˆå…ƒç´ æˆ– <code>viewport</code> ç›¸äº¤æƒ…å†µå˜åŒ–çš„æ–¹æ³•ã€‚å®ƒä¼šæ³¨å†Œä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œæ¯å½“è¢«ç›‘è§†çš„å…ƒç´ è¿›å…¥æˆ–è€…é€€å‡ºå¦å¤–ä¸€ä¸ªå…ƒç´ æ—¶(æˆ–è€… è§†å£ )ï¼Œæˆ–è€…ä¸¤ä¸ªå…ƒç´ çš„ç›¸äº¤éƒ¨åˆ†å¤§å°å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè¯¥å›è°ƒæ–¹æ³•ä¼šè¢«è§¦å‘æ‰§è¡Œã€‚è¿™æ ·ï¼Œæˆ‘ä»¬ç½‘ç«™çš„ä¸»çº¿ç¨‹ä¸éœ€è¦å†ä¸ºäº†ç›‘å¬å…ƒç´ ç›¸äº¤è€Œè¾›è‹¦åŠ³ä½œï¼Œæµè§ˆå™¨ä¼šè‡ªè¡Œä¼˜åŒ–å…ƒç´ ç›¸äº¤ç®¡ç†ã€‚<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Intersection_Observer_API" target="_blank" rel="noopener">æ‘˜è‡ªMDN</a></p><p>å…¼å®¹çš„<code>folyfill intersection-observer</code></p><p>ä¼ªä»£ç </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-comment">// æ³¨å†Œä¸€ä¸ªå›è°ƒå‡½æ•° æ»¡è¶³æ¡ä»¶çš„æ—¶å€™è‡ªåŠ¨æ‰§è¡Œä¸ºå›¾ç‰‡srcèµ‹å€¼</span><br><span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> IntersectionObserver(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">changes</span>) </span>&#123;<br>  changes.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element, index</span>) </span>&#123;<br><br>    <span class="hljs-comment">// å½“è¿™ä¸ªå€¼å¤§äº0ï¼Œè¯´æ˜æ»¡è¶³æˆ‘ä»¬çš„åŠ è½½æ¡ä»¶äº†ï¼Œè¿™ä¸ªå€¼å¯é€šè¿‡rootMarginæ‰‹åŠ¨è®¾ç½®</span><br>    <span class="hljs-keyword">if</span> (element.intersectionRatio &gt; <span class="hljs-number">0</span>) &#123;<br>      <span class="hljs-comment">// è®¾ç½®å›¾ç‰‡srcå±æ€§æ¥åŠ è½½</span><br>      element.target.src = element.target.dataset.src;<br><br>      <span class="hljs-comment">// æ”¾å¼ƒç›‘å¬ï¼Œé˜²æ­¢æ€§èƒ½æµªè´¹ã€‚</span><br>      observer.unobserve(element.target);<br>    &#125;<br>  &#125;);<br>&#125;);<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initObserver</span>(<span class="hljs-params"></span>) </span>&#123;<br>  [...document.querySelectorAll(<span class="hljs-string">'.list-item-img'</span>)].forEach(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> &#123;<br>    <span class="hljs-comment">// å¯¹æ¯ä¸ªlistå…ƒç´ è¿›è¡Œç›‘å¬</span><br>    observer.observe(item);<br>  &#125;);<br>&#125;<br><br>useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>  initObserver()<br>&#125;, [])<br><br><span class="hljs-comment">// jsx</span><br>&lt;img <span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">"list-item-img"</span> data-src=<span class="hljs-string">"1.png"</span>/&gt;<br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"list-item-img"</span>  <span class="hljs-attr">data-src</span>=<span class="hljs-string">"2.png"</span>/&gt;</span></span><br></code></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>h5-api</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>gitlab-ci.ymlæ–‡ä»¶çš„ä¸€äº›æ€»ç»“</title>
    <link href="/2020/10/24/gitlab-ci/"/>
    <url>/2020/10/24/gitlab-ci/</url>
    
    <content type="html"><![CDATA[<h2 id="åŸºç¡€æŠ½è±¡æ¦‚å¿µ"><a href="#åŸºç¡€æŠ½è±¡æ¦‚å¿µ" class="headerlink" title="åŸºç¡€æŠ½è±¡æ¦‚å¿µ"></a>åŸºç¡€æŠ½è±¡æ¦‚å¿µ</h2><ul><li><h3 id="runner"><a href="#runner" class="headerlink" title="runner"></a><code>runner</code></h3>ç”¨æ¥æ‰§è¡Œè½¯ä»¶é›†æˆè„šæœ¬çš„ä¸œè¥¿ï¼Œ<code>runner</code> çš„æœºå™¨æ˜¯éœ€è¦èƒ½å¤Ÿé€šè¿‡ç½‘ç»œè®¿é—® <code>GitLab</code> æœåŠ¡å™¨<ul><li><code>Shared Runner</code> åœºæ™¯ï¼šæ‰€æœ‰çš„å·¥ç¨‹éƒ½æœ‰å¯èƒ½éœ€è¦åœ¨å…¬å¸çš„æœåŠ¡å™¨ä¸Šè¿›è¡Œç¼–è¯‘ã€æµ‹è¯•ã€éƒ¨ç½²ç­‰å·¥ä½œï¼Œè¿™ä¸ªæ—¶å€™æ³¨å†Œä¸€ä¸ª<code>Shared Runner</code>ä¾›æ‰€æœ‰å·¥ç¨‹ä½¿ç”¨å°±å¾ˆåˆé€‚</li><li><code>Specific Runner</code> åœºæ™¯ï¼šä¸ªäººçš„ç”µè„‘æˆ–è€…æœåŠ¡å™¨ä¸Šè‡ªåŠ¨æ„å»ºæˆ‘å‚ä¸çš„æŸä¸ªå·¥ç¨‹ï¼Œè¿™ä¸ªæ—¶å€™æ³¨å†Œä¸€ä¸ª <code>Specific Runner</code> å°±å¾ˆåˆé€‚</li></ul></li><li><h3 id="pipleline"><a href="#pipleline" class="headerlink" title="pipleline"></a><code>pipleline</code></h3>ä¸€æ•´ä¸ªå·¥ä½œæµ</li><li><h3 id="stage"><a href="#stage" class="headerlink" title="stage"></a><code>stage</code></h3>ä¸€æ•´ä¸ªå·¥ä½œæµæ˜¯ç”±äºå¤šä¸ª <code>stage</code> ç»„æˆ<ul><li>å¦‚æœä¸¤ä¸ªä»»åŠ¡å¯¹åº”çš„ <code>stage</code> åç›¸åŒï¼Œåˆ™è¿™ä¸¤ä¸ªä»»åŠ¡ä¼šå¹¶è¡Œè¿è¡Œ</li><li>ä¸‹ä¸€ä¸ª <code>stage</code> å…³è”çš„ä»»åŠ¡ä¼šç­‰å¾…ä¸Šä¸€ä¸ª <code>stage</code> æ‰§è¡ŒæˆåŠŸåæ‰ç»§ç»­è¿è¡Œï¼Œå¤±è´¥åˆ™ä¸è¿è¡Œ</li></ul></li><li><h3 id="job"><a href="#job" class="headerlink" title="job"></a><code>job</code></h3>æ¯ä¸€ä¸ª <code>stage</code> ç”±è‡³å°‘ä¸€ä¸ª <code>Job</code> ç»„æˆ</li><li><h3 id="image"><a href="#image" class="headerlink" title="image"></a><code>image</code></h3>é•œåƒ æŒ‡å®šä¸€ä¸ªä»»åŠ¡ <code>ï¼ˆjobï¼‰</code> æ‰€ä½¿ç”¨çš„ <code>docker</code> é•œåƒ</li><li><h3 id="only-except"><a href="#only-except" class="headerlink" title="only / except"></a><code>only / except</code></h3>å½“ç¬¦åˆå®šä¹‰çš„ç­–ç•¥æ—¶æ‰ä¼šè§¦å‘ <code>Pipelines</code> çš„æ‰§è¡Œï¼Œ<code>except</code> åˆ™ç›¸åã€‚</li><li><h3 id="variables"><a href="#variables" class="headerlink" title="variables"></a><code>variables</code></h3>å®šä¹‰å˜é‡</li></ul><h2 id="gitlab-ci-yml-ç¤ºä¾‹è¯´æ˜"><a href="#gitlab-ci-yml-ç¤ºä¾‹è¯´æ˜" class="headerlink" title=".gitlab-ci.yml ç¤ºä¾‹è¯´æ˜"></a><code>.gitlab-ci.yml</code> ç¤ºä¾‹è¯´æ˜</h2><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-symbol">stages:</span><br>  <span class="hljs-meta">#- å…ˆå®šä¹‰å‡ ä¸ªé˜¶æ®µ åœ¨ymlåŠ è½½å®Œæˆä¹‹åå°±ä¼šåœ¨pipelineé‡Œå‡ºç°ä¸‰ä¸ªstages stageçš„åç§°æ˜¯ä¸‹è¾¹å¼€å§‹çš„æœ€å‰è¾¹çš„åç§°ã€name1ã€name2ã€name3ã€‘</span><br>  - assemble<br>  - deploy<br>  - success<br><br>  <span class="hljs-meta">#- stageçš„åç§°</span><br><span class="hljs-symbol">name1:</span><br>  <span class="hljs-meta">#- å¯¹åº”ç¬¬ä¸€ä¸ªéœ€è¦å¤„ç†çš„é˜¶æ®µ</span><br><span class="hljs-symbol">  stage:</span> assemble<br>  <span class="hljs-meta">#- éœ€è¦åœ¨assembleçš„æ—¶å€™è¿è¡Œçš„è„šæœ¬ `linux` çš„å‘½ä»¤</span><br><span class="hljs-symbol">  script:</span><br>    - ls -la<br>    - rm -rf node_module<br>    - pwd<br><span class="hljs-symbol">name2:</span><br><span class="hljs-symbol">  stage:</span> deploy<br>  <span class="hljs-meta">#- ä¾èµ–é¡¹ç›®</span><br><span class="hljs-symbol">  dependencies:</span><br>    - name1<br>  <span class="hljs-meta">#- éœ€è¦åœ¨deployçš„æ—¶å€™è¿è¡Œçš„è„šæœ¬</span><br><span class="hljs-symbol">  script:</span><br><span class="hljs-symbol"><br>name3:</span><br><span class="hljs-symbol">  stage:</span> success<br>  <span class="hljs-meta">#- ä¾èµ–é¡¹ç›®</span><br><span class="hljs-symbol">  dependencies:</span><br>    - name2<br>  <span class="hljs-meta">#- éœ€è¦åœ¨successçš„æ—¶å€™è¿è¡Œçš„è„šæœ¬</span><br><span class="hljs-symbol">  script:</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>gitlab-ci</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æµè§ˆå™¨ä¸­ä¸‹è½½çš„ä¸€äº›æ€»ç»“</title>
    <link href="/2020/10/21/browserDownload/"/>
    <url>/2020/10/21/browserDownload/</url>
    
    <content type="html"><![CDATA[<h1 id="é€šè¿‡-http-è¯·æ±‚è¿”å›çš„-json-æ•°æ®ï¼Œå¦‚ä½•ä¸‹è½½åˆ°æœ¬åœ°ä½œä¸ºè°ƒè¯•çš„-mock-æ•°æ®ï¼Ÿ"><a href="#é€šè¿‡-http-è¯·æ±‚è¿”å›çš„-json-æ•°æ®ï¼Œå¦‚ä½•ä¸‹è½½åˆ°æœ¬åœ°ä½œä¸ºè°ƒè¯•çš„-mock-æ•°æ®ï¼Ÿ" class="headerlink" title="é€šè¿‡ http è¯·æ±‚è¿”å›çš„ json æ•°æ®ï¼Œå¦‚ä½•ä¸‹è½½åˆ°æœ¬åœ°ä½œä¸ºè°ƒè¯•çš„ mock æ•°æ®ï¼Ÿ"></a>é€šè¿‡ <code>http</code> è¯·æ±‚è¿”å›çš„ <code>json</code> æ•°æ®ï¼Œå¦‚ä½•ä¸‹è½½åˆ°æœ¬åœ°ä½œä¸ºè°ƒè¯•çš„ <code>mock</code> æ•°æ®ï¼Ÿ</h1><h2 id="äºŒè¿›åˆ¶æ–‡ä»¶ç­‰éƒ¨åˆ†æ¶‰åŠ"><a href="#äºŒè¿›åˆ¶æ–‡ä»¶ç­‰éƒ¨åˆ†æ¶‰åŠ" class="headerlink" title="äºŒè¿›åˆ¶æ–‡ä»¶ç­‰éƒ¨åˆ†æ¶‰åŠ"></a>äºŒè¿›åˆ¶æ–‡ä»¶ç­‰éƒ¨åˆ†æ¶‰åŠ</h2><h3 id="æµè§ˆå™¨ä¸­çš„ä¸‹è½½ä¸€èˆ¬éƒ½ä¼šæ¶‰åŠåˆ°äºŒè¿›åˆ¶ï¼Œæµè§ˆå™¨ä¸­å¸¸è§çš„äºŒè¿›åˆ¶ä»¥åŠç‰¹æ®Šçš„æ•°æ®ç›¸å…³çš„ç”¨çš„æœ€å¤šBlobï¼ŒDataURLï¼ŒBase64-ï¼ŒObjectURL"><a href="#æµè§ˆå™¨ä¸­çš„ä¸‹è½½ä¸€èˆ¬éƒ½ä¼šæ¶‰åŠåˆ°äºŒè¿›åˆ¶ï¼Œæµè§ˆå™¨ä¸­å¸¸è§çš„äºŒè¿›åˆ¶ä»¥åŠç‰¹æ®Šçš„æ•°æ®ç›¸å…³çš„ç”¨çš„æœ€å¤šBlobï¼ŒDataURLï¼ŒBase64-ï¼ŒObjectURL" class="headerlink" title="æµè§ˆå™¨ä¸­çš„ä¸‹è½½ä¸€èˆ¬éƒ½ä¼šæ¶‰åŠåˆ°äºŒè¿›åˆ¶ï¼Œæµè§ˆå™¨ä¸­å¸¸è§çš„äºŒè¿›åˆ¶ä»¥åŠç‰¹æ®Šçš„æ•°æ®ç›¸å…³çš„ç”¨çš„æœ€å¤šBlobï¼ŒDataURLï¼ŒBase64 ï¼ŒObjectURL"></a>æµè§ˆå™¨ä¸­çš„ä¸‹è½½ä¸€èˆ¬éƒ½ä¼šæ¶‰åŠåˆ°äºŒè¿›åˆ¶ï¼Œæµè§ˆå™¨ä¸­å¸¸è§çš„äºŒè¿›åˆ¶ä»¥åŠç‰¹æ®Šçš„æ•°æ®ç›¸å…³çš„ç”¨çš„æœ€å¤š<code>Blobï¼ŒDataURLï¼ŒBase64 ï¼ŒObjectURL</code></h3><ul><li><p><code>Blob</code> æ˜¯æµè§ˆå™¨ç«¯çš„ç±»æ–‡ä»¶å¯¹è±¡ï¼Œå­˜å‚¨ç€äºŒè¿›åˆ¶çš„æ•°æ®ï¼Œå…¶æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ï¼Œ<code>array</code> æ˜¯ä¸€ä¸ªç”± <code>ArrayBuffer</code> , <code>ArrayBufferView</code> , <code>Blob</code> , <code>DOMString</code> ç­‰å¯¹è±¡æ„æˆçš„ <code>Array</code> ï¼Œæˆ–è€…å…¶ä»–ç±»ä¼¼å¯¹è±¡çš„æ··åˆä½“ï¼Œå®ƒå°†ä¼šè¢«æ”¾è¿› <code>Blob</code> ã€‚<code>DOMStrings</code> ä¼šè¢«ç¼–ç ä¸º <code>UTF-8</code> ã€‚ç¬¬äºŒä¸ªå‚æ•°æ˜¯æ–‡ä»¶çš„ <code>MIME</code> ç±»å‹</p></li><li><p><code>Data URL</code> æ ¼å¼</p><figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-comment">// æ ¼å¼</span><br>data:<span class="hljs-meta">[&lt;mediatype&gt;]</span>[;base64],&lt;data&gt;<br><br><span class="hljs-comment">// æµè§ˆå™¨åœ°å€æ å¯ä»¥ç›´æ¥è®¿é—®</span><br>data:text/html,&lt;h1&gt;Hello%<span class="hljs-number">2</span>C%<span class="hljs-number">20</span>World!&lt;/h1&gt;<br></code></pre></td></tr></table></figure></li><li><p><code>Base64</code> æœ€å¸¸ç”¨çš„åœºæ™¯ä¸€èˆ¬æ˜¯å°†å›¾ç‰‡å‹ç¼©å¤„ç†ï¼Œä½†æ˜¯ç¼–ç ä¹‹åå­˜å‚¨è¾ƒå¤§</p></li><li><p><code>ObjectURL</code> æµè§ˆå™¨çš„ <code>URL</code> å¯¹è±¡ç”Ÿæˆä¸€ä¸ªåœ°å€æ¥è¡¨ç¤º <code>Blob</code> æ•°æ®</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-built_in">URL</span>.createObjectURL(<span class="hljs-built_in">new</span> Blob(<span class="hljs-string">'hello, world'</span>.<span class="hljs-built_in">split</span>(<span class="hljs-string">''</span>)))<br></code></pre></td></tr></table></figure></li></ul><h2 id="å…·ä½“ä¸‹è½½æ€è·¯"><a href="#å…·ä½“ä¸‹è½½æ€è·¯" class="headerlink" title="å…·ä½“ä¸‹è½½æ€è·¯"></a>å…·ä½“ä¸‹è½½æ€è·¯</h2><h3 id="ä¸€èˆ¬æ¥å£è¿”å›å€¼éƒ½æ˜¯-json-ç»“æ„ï¼Œæ‰€ä»¥å¯ä»¥å…ˆå°†å…¶-JSON-stringify-åºåˆ—åŒ–ä¸º-JSON-å­—ç¬¦ä¸²ï¼Œæƒ³è¦å°†æ¥å£è¿”å›çš„æ•°æ®ä¸‹è½½ï¼Œæœ‰ä¸¤ç§æ€è·¯"><a href="#ä¸€èˆ¬æ¥å£è¿”å›å€¼éƒ½æ˜¯-json-ç»“æ„ï¼Œæ‰€ä»¥å¯ä»¥å…ˆå°†å…¶-JSON-stringify-åºåˆ—åŒ–ä¸º-JSON-å­—ç¬¦ä¸²ï¼Œæƒ³è¦å°†æ¥å£è¿”å›çš„æ•°æ®ä¸‹è½½ï¼Œæœ‰ä¸¤ç§æ€è·¯" class="headerlink" title="ä¸€èˆ¬æ¥å£è¿”å›å€¼éƒ½æ˜¯ json ç»“æ„ï¼Œæ‰€ä»¥å¯ä»¥å…ˆå°†å…¶ JSON.stringify åºåˆ—åŒ–ä¸º JSON å­—ç¬¦ä¸²ï¼Œæƒ³è¦å°†æ¥å£è¿”å›çš„æ•°æ®ä¸‹è½½ï¼Œæœ‰ä¸¤ç§æ€è·¯"></a>ä¸€èˆ¬æ¥å£è¿”å›å€¼éƒ½æ˜¯ <code>json</code> ç»“æ„ï¼Œæ‰€ä»¥å¯ä»¥å…ˆå°†å…¶ <code>JSON.stringify</code> åºåˆ—åŒ–ä¸º <code>JSON</code> å­—ç¬¦ä¸²ï¼Œæƒ³è¦å°†æ¥å£è¿”å›çš„æ•°æ®ä¸‹è½½ï¼Œæœ‰ä¸¤ç§æ€è·¯</h3><ul><li>å°† <code>JSON</code> å­—ç¬¦ä¸²æ–‡æœ¬è½¬æ¢ä¸º <code>Data URL</code></li><li>å°† <code>JSON</code> å­—ç¬¦ä¸²æ–‡æœ¬è½¬æ¢ä¸º <code>Blob</code> ï¼Œå†ç”± <code>Blob</code> åˆ›å»º <code>ObjectURL</code></li><li>æœ€ç»ˆéƒ½é€šè¿‡ <code>a</code> æ ‡ç­¾çš„æ¨¡æ‹Ÿç‚¹å‡»æ¥ä¸‹è½½</li></ul><p>å…·ä½“ä¼ªä»£ç ï¼š</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-keyword">const</span> download = <span class="hljs-function">(<span class="hljs-params">url: <span class="hljs-built_in">string</span>, name: <span class="hljs-built_in">string</span></span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> aTag = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'a'</span>)<br>  aTag.download = name<br>  aTag.rel = <span class="hljs-string">'noopener'</span><br>  aTag.href = url<br>  <span class="hljs-comment">// è§¦å‘æ¨¡æ‹Ÿç‚¹å‡»</span><br>  aTag.dispatchEvent(<span class="hljs-keyword">new</span> MouseEvent(<span class="hljs-string">'click'</span>))<br>&#125;<br><br>æ–¹æ¡ˆ<span class="hljs-number">1</span>:<br>  <span class="hljs-keyword">const</span> downloadStr = <span class="hljs-built_in">JSON</span>.stringify(data, <span class="hljs-literal">null</span>, <span class="hljs-number">2</span>) <span class="hljs-comment">// ç¬¬ä¸‰ä¸ªå‚æ•°ç”¨æ¥å°†æ•°æ®æ ¼å¼åŒ–ä¸€ä¸‹</span><br>  <span class="hljs-keyword">const</span> dataUrl = <span class="hljs-string">`data:,<span class="hljs-subst">$&#123;downloadStr&#125;</span>`</span><br>  download(dataUrl, <span class="hljs-string">'data.json'</span>)<br><br>æ–¹æ¡ˆ<span class="hljs-number">2</span>:<br>  <span class="hljs-keyword">const</span> downloadUrl = URL.createObjectURL(<span class="hljs-keyword">new</span> Blob(downloadStr.split(<span class="hljs-string">''</span>)))<br>  download(downloadUrl, <span class="hljs-string">'data.json'</span>)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>æµè§ˆå™¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ—¥å¸¸å·¥ä½œgitå‘½ä»¤æ€»ç»“</title>
    <link href="/2020/09/15/gitSummary/"/>
    <url>/2020/09/15/gitSummary/</url>
    
    <content type="html"><![CDATA[<p>ç»“åˆvscodeä¼šå¾ˆå¼ºå¤§</p><h2 id="ç”Ÿæˆsshkey"><a href="#ç”Ÿæˆsshkey" class="headerlink" title="ç”Ÿæˆsshkey"></a>ç”Ÿæˆsshkey</h2><ul><li><code>ssh-keygen -t rsa -C &quot;é‚®ç®±&quot;</code></li><li><code>cd ~/.ssh</code> å¤åˆ¶ <code>id_rsa.pub</code> å†…å®¹å¤åˆ¶åˆ° <code>git</code> åº“ä¸­</li></ul><h2 id="é…ç½®ä¿¡æ¯ä»¥åŠæŸ¥çœ‹"><a href="#é…ç½®ä¿¡æ¯ä»¥åŠæŸ¥çœ‹" class="headerlink" title="é…ç½®ä¿¡æ¯ä»¥åŠæŸ¥çœ‹"></a>é…ç½®ä¿¡æ¯ä»¥åŠæŸ¥çœ‹</h2><ul><li><h3 id="æŸ¥çœ‹é…ç½®ä¿¡æ¯"><a href="#æŸ¥çœ‹é…ç½®ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹é…ç½®ä¿¡æ¯"></a>æŸ¥çœ‹é…ç½®ä¿¡æ¯</h3><ul><li><code>git config --list</code></li></ul></li><li><h3 id="å…¨å±€é…ç½®"><a href="#å…¨å±€é…ç½®" class="headerlink" title="å…¨å±€é…ç½®"></a>å…¨å±€é…ç½®</h3><ul><li><p><code>git config --global user.name &quot;yourname&quot;</code></p></li><li><p><code>git config --global user.email &quot;your_email&quot;</code></p></li></ul></li><li><h3 id="åœ¨ä¸åŒ-git-æ–‡ä»¶ä¸‹-config-ä¸­è®¾ç½®ä¸åŒçš„å±€éƒ¨å˜é‡"><a href="#åœ¨ä¸åŒ-git-æ–‡ä»¶ä¸‹-config-ä¸­è®¾ç½®ä¸åŒçš„å±€éƒ¨å˜é‡" class="headerlink" title="åœ¨ä¸åŒ .git æ–‡ä»¶ä¸‹ config ä¸­è®¾ç½®ä¸åŒçš„å±€éƒ¨å˜é‡"></a>åœ¨ä¸åŒ <code>.git</code> æ–‡ä»¶ä¸‹ <code>config</code> ä¸­è®¾ç½®ä¸åŒçš„å±€éƒ¨å˜é‡</h3><ul><li><code>git config  user.name &quot;name&quot;</code></li><li><code>git config  user.email &quot;email&quot;</code></li></ul></li></ul><h2 id="å¸¸ç”¨çš„åŸºæœ¬æ“ä½œ"><a href="#å¸¸ç”¨çš„åŸºæœ¬æ“ä½œ" class="headerlink" title="å¸¸ç”¨çš„åŸºæœ¬æ“ä½œ"></a>å¸¸ç”¨çš„åŸºæœ¬æ“ä½œ</h2><ul><li><h3 id="åˆå§‹åŒ–åˆ›å»º-git"><a href="#åˆå§‹åŒ–åˆ›å»º-git" class="headerlink" title="åˆå§‹åŒ–åˆ›å»º .git"></a>åˆå§‹åŒ–åˆ›å»º <code>.git</code></h3><ul><li><code>git init -y</code> // åŠ å‚æ•°å¯ä»¥è·³è¿‡å¡«å†™ä¿¡æ¯</li></ul></li><li><h3 id="æ·»åŠ æœ¬åœ°å·²æœ‰æ–‡ä»¶åˆ°-git-è¿œç¨‹ä»“åº“"><a href="#æ·»åŠ æœ¬åœ°å·²æœ‰æ–‡ä»¶åˆ°-git-è¿œç¨‹ä»“åº“" class="headerlink" title="æ·»åŠ æœ¬åœ°å·²æœ‰æ–‡ä»¶åˆ° git è¿œç¨‹ä»“åº“"></a>æ·»åŠ æœ¬åœ°å·²æœ‰æ–‡ä»¶åˆ° <code>git</code> è¿œç¨‹ä»“åº“</h3><ul><li><code>git remote add origin xxxx.git</code></li></ul></li><li><h3 id="æŸ¥çœ‹åˆ†æ”¯"><a href="#æŸ¥çœ‹åˆ†æ”¯" class="headerlink" title="æŸ¥çœ‹åˆ†æ”¯"></a>æŸ¥çœ‹åˆ†æ”¯</h3><ul><li><code>git branch</code> // å½“å‰æœ¬åœ°åˆ†æ”¯</li><li><code>git branch -a</code> // æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯ã€æœ¬åœ°+è¿œç¨‹ã€‘</li></ul></li><li><h3 id="æ›´æ–°è¿œç¨‹åˆ†æ”¯åˆ°æœ¬åœ°åˆ†æ”¯"><a href="#æ›´æ–°è¿œç¨‹åˆ†æ”¯åˆ°æœ¬åœ°åˆ†æ”¯" class="headerlink" title="æ›´æ–°è¿œç¨‹åˆ†æ”¯åˆ°æœ¬åœ°åˆ†æ”¯"></a>æ›´æ–°è¿œç¨‹åˆ†æ”¯åˆ°æœ¬åœ°åˆ†æ”¯</h3><ul><li><code>git checkout -b &lt;localBranch&gt; origin/&lt;remoteBranch&gt;</code> // æ›´æ–°è¿œç¨‹åˆ†æ”¯ <code>remoteBranch</code> åœ¨æœ¬åœ°çš„ <code>localBranch</code> åˆ†æ”¯ä¸Š</li></ul></li><li><h3 id="ä¸´æ—¶å­˜å‚¨"><a href="#ä¸´æ—¶å­˜å‚¨" class="headerlink" title="ä¸´æ—¶å­˜å‚¨"></a>ä¸´æ—¶å­˜å‚¨</h3><p>å¼€å‘äº†ä¸€åŠè¿˜æ²¡å®Œæˆçªç„¶çº¿ä¸Šå‡ºç°äº†ç´§æ€¥é—®é¢˜ï¼Œè¿™ä¸ªæ—¶å€™å·¥ä½œåŒºæœªæ¸…ç©ºçš„çŠ¶æ€ä¸‹ <code>git</code> ä¸å…è®¸ç­¾å‡ºå’Œç­¾å…¥ï¼Œæ­¤æ—¶ä¸æƒ³ <code>commit</code> çš„è¯ï¼Œå°±è¦ç”¨åˆ°ä»¥ä¸‹å‘½ä»¤</p><ul><li><code>git stash</code> // å°†ç›®å‰çš„æ”¹åŠ¨å­˜å‚¨èµ·æ¥</li><li><code>git stash list</code> // æŸ¥çœ‹ <code>stash</code> äº†å“ªäº›</li><li><code>git stash apply</code> // å¦‚æœè¦ä½¿ç”¨å…¶ä»–ä¸ªï¼Œ<code>git stash apply stash@{$num}</code> <code>num</code> ä» <code>0</code> å¼€å§‹ ç»“åˆ <code>vocode</code> å¯ä»¥ç‚¹å‡»å¯¹åº”çš„å°±å¯ä»¥åº”ç”¨</li><li><code>git stash clear</code> // æ¸…é™¤æ‰ <code>stash</code></li></ul></li><li><h3 id="åˆ‡æ¢åˆ†æ”¯"><a href="#åˆ‡æ¢åˆ†æ”¯" class="headerlink" title="åˆ‡æ¢åˆ†æ”¯"></a>åˆ‡æ¢åˆ†æ”¯</h3><ul><li><code>git checkout &lt;branch&gt;</code></li></ul></li><li><h3 id="è‹¥æƒ³åŸºäºå½“å‰åˆ†æ”¯æ‹‰å‡ºæ¥ä¸€ä¸ªæ–°çš„åˆ†æ”¯"><a href="#è‹¥æƒ³åŸºäºå½“å‰åˆ†æ”¯æ‹‰å‡ºæ¥ä¸€ä¸ªæ–°çš„åˆ†æ”¯" class="headerlink" title="è‹¥æƒ³åŸºäºå½“å‰åˆ†æ”¯æ‹‰å‡ºæ¥ä¸€ä¸ªæ–°çš„åˆ†æ”¯"></a>è‹¥æƒ³åŸºäºå½“å‰åˆ†æ”¯æ‹‰å‡ºæ¥ä¸€ä¸ªæ–°çš„åˆ†æ”¯</h3><ul><li><code>git checkout -b &lt;newBranch&gt;</code></li><li>æ¨é€åˆ°è¿œç¨‹ä»“åº“ <code>git push origin &lt;newBranch&gt;</code></li></ul></li><li><h3 id="åˆ é™¤æœ¬åœ°å’Œè¿œç¨‹åˆ†æ”¯"><a href="#åˆ é™¤æœ¬åœ°å’Œè¿œç¨‹åˆ†æ”¯" class="headerlink" title="åˆ é™¤æœ¬åœ°å’Œè¿œç¨‹åˆ†æ”¯"></a>åˆ é™¤æœ¬åœ°å’Œè¿œç¨‹åˆ†æ”¯</h3><ul><li><code>git branch -d &lt;branch&gt;</code> // æœ‰æ—¶å€™ä¸ç”Ÿæ•ˆå¯èƒ½éœ€è¦æ¢æˆ <code>-D</code></li><li><code>git push origin --delete &lt;branch&gt;</code></li></ul></li><li><h3 id="æŸ¥çœ‹çŠ¶æ€ã€å°†æ–‡ä»¶æ·»åŠ åˆ°ç¼“å†²åŒºã€æäº¤åˆ°æœ¬åœ°ä»“åº“"><a href="#æŸ¥çœ‹çŠ¶æ€ã€å°†æ–‡ä»¶æ·»åŠ åˆ°ç¼“å†²åŒºã€æäº¤åˆ°æœ¬åœ°ä»“åº“" class="headerlink" title="æŸ¥çœ‹çŠ¶æ€ã€å°†æ–‡ä»¶æ·»åŠ åˆ°ç¼“å†²åŒºã€æäº¤åˆ°æœ¬åœ°ä»“åº“"></a>æŸ¥çœ‹çŠ¶æ€ã€å°†æ–‡ä»¶æ·»åŠ åˆ°ç¼“å†²åŒºã€æäº¤åˆ°æœ¬åœ°ä»“åº“</h3><ul><li><code>git status</code></li><li><code>git log</code></li><li><code>git reflog</code> // ç›¸æ¯” <code>git log</code> å®ƒæ¯ä¸€æ­¥æ“ä½œéƒ½èƒ½çœ‹åˆ°ï¼ˆ <code>.git</code> ä¸‹çš„ <code>refs</code> ç›®å½•å­˜å‚¨æŒ‡å‘æ•°æ®ï¼ˆåˆ†æ”¯ã€è¿œç¨‹ä»“åº“å’Œæ ‡ç­¾ç­‰ï¼‰çš„æäº¤å¯¹è±¡çš„æŒ‡é’ˆï¼Œæ‰€ä»¥çŒœæµ‹ <code>git reflog</code> åŸºæœ¬ä¸Šè·Ÿ <code>refs</code> æœ‰å…³ï¼‰</li><li><code>git add . | git add fileName</code></li><li><code>git commit -m &quot;msg&quot;</code> // <code>-m</code> å‚æ•°è¡¨ç¤ºå¯ä»¥ç›´æ¥è¾“å…¥åé¢çš„ <code>message</code></li><li><code>git commit -a -m &quot;msg&quot;</code> // ç›¸å½“äºæ‰§è¡Œäº† <code>git add . + git commit -m &quot;msg&quot;</code></li></ul></li><li><h3 id="é‡ç½®æäº¤ä¿¡æ¯"><a href="#é‡ç½®æäº¤ä¿¡æ¯" class="headerlink" title="é‡ç½®æäº¤ä¿¡æ¯"></a>é‡ç½®æäº¤ä¿¡æ¯</h3><ul><li><code>git commit --amend</code> // <code>git push</code> çš„æ—¶å€™éœ€è¦æ ¡éªŒ <code>message</code> æ ¼å¼ï¼Œå¦‚æœç¬¬ä¸€æ¬¡å†™é”™çš„è¯å°±æ— æ³• <code>push</code> åˆ°è¿œç¨‹ä»“åº“ï¼Œå¯ä»¥ç”¨è¿™ä¸ªä¿®æ”¹æäº¤çš„ <code>message</code> é‡æ–° <code>push</code></li></ul></li><li><h3 id="pull-ä¸ä¸‹ä»£ç çš„æƒ…å†µ"><a href="#pull-ä¸ä¸‹ä»£ç çš„æƒ…å†µ" class="headerlink" title="pull ä¸ä¸‹ä»£ç çš„æƒ…å†µ"></a><code>pull</code> ä¸ä¸‹ä»£ç çš„æƒ…å†µ</h3><ul><li><code>git pull origin &lt;branch&gt;</code> // å¶å°”ä¼šé‡åˆ°æœåŠ¡å™¨ä¸Šçš„ä»£ç ä¸€ç›´ <code>pull</code> ä¸ä¸‹æ¥ï¼Œå¯ä»¥åŠ ä¸Š <code>origin &lt;branch&gt;</code></li></ul></li><li><h3 id="åˆå¹¶"><a href="#åˆå¹¶" class="headerlink" title="åˆå¹¶"></a>åˆå¹¶</h3><ul><li>ä¸ªäººä¹ æƒ¯å’ŒåŸåˆ™ï¼šæ‰€æœ‰æœ¬åœ°æ”¹åŠ¨å‡å·²ç»æ¨é€åˆ°è¿œç¨‹åˆ†æ”¯çš„å‰æ</li><li><code>git merge &lt;branch&gt;</code> // å°† <code>branch</code> åˆ†æ”¯åˆå¹¶åˆ°å½“å‰åˆ†æ”¯</li><li>ç®€å•çš„åˆå¹¶å‡ºç°å†²çªï¼Œç”¨ <code>vscode</code> è§£å†³æ‰å†²çªï¼Œé‡æ–°<code>add ã€commitã€push</code> å°±å¯ä»¥ï¼Œä½†æ˜¯ä¸€äº›æœ‰æ—¶å€™å‡ºç°ä¸€äº›æ¯”è¾ƒå¤æ‚çš„å†²çªå¯¼è‡´åˆå¹¶å¤±è´¥ï¼Œå†æ¬¡æ“ä½œçš„æ—¶å€™ä¼šæç¤ºå½“å‰æ­£åœ¨å¤„äºåˆå¹¶ä¹‹ä¸­ï¼ˆåˆ†æ”¯ååå¸¦ç€ï½œ<code>MERGING</code>ï¼‰ï¼Œéœ€è¦ <code>git merge --abort</code> é€‰é¡¹ä¼šå°è¯•æ¢å¤åˆ°ä½ è¿è¡Œåˆå¹¶å‰çš„çŠ¶æ€<br>å¦‚æœå·²ç»åˆå¹¶å‘ç°åˆå¹¶é”™åˆ†æ”¯ï¼ˆæ‰€ä»¥åˆå¹¶çš„ä¸œè¥¿æ˜¯ä¸éœ€è¦ä¿ç•™åœ¨å·¥ä½œç©ºé—´çš„ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ <code>git reset --hard HEAD~</code> æ¥è¿˜åŸåˆ°æœªåˆå¹¶ä¹‹å‰ï¼Œå¹¶ä¸”å·¥ä½œåŒºæ˜¯å¹²å‡€çš„çŠ¶æ€</li><li>åˆå¹¶ä¸­å‡ºç° <code>Swap file .MERGE_MSG.swp already exists</code> çš„æƒ…å†µéœ€è¦æ‰“å¼€å½“å‰é¡¹ç›® <code>.git</code> æ–‡ä»¶åˆ é™¤ <code>.MERGE_MSG.sw*</code> æ–‡ä»¶ï¼Œå†ç»§ç»­æ“ä½œ</li></ul></li><li><h3 id="é‡ç½®"><a href="#é‡ç½®" class="headerlink" title="é‡ç½®"></a>é‡ç½®</h3><ul><li><code>git reset --(soft | mixed | hard ) &lt; HEAD ~(num) &gt; |</code></li><li>ç”¨çš„æ¯”è¾ƒå¤šçš„æ˜¯ <code>soft</code> å’Œ <code>hard</code></li><li>è·Ÿæ—¶é—´æ—…è¡Œä¸€ä¸ªé“ç†ï¼Œ<code>git reset HEAD</code> è·Ÿç€  <code>HEAD@{1}(HEAD~) HEAD@{2}...</code> æˆ–è€…åˆ†æ”¯çš„ <code>hash</code> å€¼å¯ä»¥å°†æœ¬åœ°å­˜å‚¨åº“åˆ‡æ¢åˆ°ä»»æ„çš„ç‰ˆæœ¬</li><li>ä¸€ç§åœºæ™¯å¦‚æœéœ€è¦å›é€€åˆ°æŸä¸€æ¬¡ç‰ˆæœ¬ï¼Œå¹¶ä¸”ä¸è¦é‚£äº›ç‰ˆæœ¬çš„æ”¹åŠ¨æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>git reset --hard HEAD</code>ã€ç¡¬å›é€€ã€‘è¿™ä¸ªå‘½åå›å›é€€åˆ°æŒ‡å®šçš„ç‰ˆæœ¬å¹¶ä¸”åˆ æ‰ä¹‹å‰çš„æ”¹åŠ¨æ–‡ä»¶ï¼Œä¸ä¼šå‡ºç°åœ¨æš‚å­˜åŒºã€‚å¦‚æœæƒ³å›é€€åˆ°æŸæ¬¡ç‰ˆæœ¬ï¼Œå¹¶ä¸”éœ€è¦æš‚å­˜åŒºçœ‹åˆ°æ”¹åŠ¨çš„æ–‡ä»¶å¯ä»¥ä½¿ç”¨ <code>git reset --soft HEAD</code>ã€è½¯å›é€€ã€‘</li><li>å›é€€åˆ°æŸä¸ªä¹‹å‰çš„ç‰ˆæœ¬çš„è¯ï¼Œ éœ€è¦ <code>git push origin &lt;branch&gt; --force</code> æ¨é€åˆ°è¿œç¨‹åˆ†æ”¯</li></ul></li><li><h3 id="æ¨é€"><a href="#æ¨é€" class="headerlink" title="æ¨é€"></a>æ¨é€</h3><ul><li><code>master</code> åˆ†æ”¯æ¨é€å¯ä»¥ç›´æ¥ä½¿ç”¨ <code>git push</code></li><li>é <code>master</code> åˆ†æ”¯éœ€è¦åŠ ä¸Š <code>origin &lt;remoteBranch&gt;</code> å³ï¼š<code>git push origin remoteBranch</code></li></ul></li><li><h3 id="ä¸æ˜¯å¾ˆå¸¸ç”¨çš„å‡ ä¸ª-git-å‘½ä»¤"><a href="#ä¸æ˜¯å¾ˆå¸¸ç”¨çš„å‡ ä¸ª-git-å‘½ä»¤" class="headerlink" title="ä¸æ˜¯å¾ˆå¸¸ç”¨çš„å‡ ä¸ª git å‘½ä»¤"></a>ä¸æ˜¯å¾ˆå¸¸ç”¨çš„å‡ ä¸ª <code>git</code> å‘½ä»¤</h3><ul><li><p><code>git fetch</code> // æœ‰æ—¶å€™ä¸éœ€è¦åˆå¹¶çš„æ—¶å€™ä¼šç”¨ä¸€ä¸‹ï¼Œ<code>git fetch</code> å’Œ <code>git pull</code> çš„åŒºåˆ«å°±æ˜¯ <code>git pull = git fetch + git merge</code></p></li><li><p><code>submodule</code> çš„å‘½ä»¤</p><ul><li><code>git submodule init</code></li><li><code>git submodule foreach git submodule update</code></li><li><code>git submodule update --init</code></li></ul></li></ul></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>git</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åŒä¸€ä¸ªé¡¹ç›®åˆ‡æ¢ç§»åŠ¨ç«¯å’ŒPCç«¯å¸ƒå±€æ–¹æ¡ˆ</title>
    <link href="/2020/09/14/checkPCMobile/"/>
    <url>/2020/09/14/checkPCMobile/</url>
    
    <content type="html"><![CDATA[<h1 id="éƒ¨åˆ†å“åº”å¼å¸ƒå±€å°ç»“"><a href="#éƒ¨åˆ†å“åº”å¼å¸ƒå±€å°ç»“" class="headerlink" title="éƒ¨åˆ†å“åº”å¼å¸ƒå±€å°ç»“"></a>éƒ¨åˆ†å“åº”å¼å¸ƒå±€å°ç»“</h1><p>ä»£ç åœ¨ä¸€ä¸ªå·¥ç¨‹ä¸­å¦‚ä½•åš <code>pc</code> å’Œ <code>mobile</code> æ£€æµ‹åˆ†åˆ«ä½¿ç”¨ä¸åŒçš„ç»„ä»¶ä»¥åŠæ ·å¼ï¼Ÿã€ä¸€ä¸ªç›®å‰ä¸ªäººè§£å†³çš„æ–¹æ¡ˆï¼Œä½†æ˜¯é¡¹ç›®å¤§çš„è¯æˆæœ¬å¯èƒ½ä¼šé«˜ã€‚æ›´å¥½çš„åšæ³•åº”è¯¥æ˜¯ä¸€å¥—ä»£ç æ ¹æ®å±å¹•å¤§å°è‡ªé€‚åº”ï¼ˆç±»ä¼¼æ …æ å¸ƒå±€ï¼‰ã€‘</p><h3 id="åˆ¤æ–­æ˜¯å“ªä¸ªç«¯"><a href="#åˆ¤æ–­æ˜¯å“ªä¸ªç«¯" class="headerlink" title="åˆ¤æ–­æ˜¯å“ªä¸ªç«¯"></a>åˆ¤æ–­æ˜¯å“ªä¸ªç«¯</h3><ul><li><code>App.vue</code> ç”Ÿå‘½å‘¨æœŸä¸­é€šè¿‡ <code>isMobile</code> æ–¹æ³•åˆ¤æ–­æ˜¯å±äºå“ªä¸ªç«¯</li><li>ä¸ºé¡¶çº§æ ‡ç­¾è®¾ç½®å‘½åç©ºé—´ï¼ˆ <code>css</code> æ ·å¼ç”¨ï¼‰</li><li><code>v-if</code> åˆ‡æ¢ä¸åŒçš„ <code>router-view</code> ï¼Œè¿™é‡Œåªéœ€è¦åˆ‡åˆ°å…¥å£è·¯ç”±å°±å¯ä»¥ï¼Œå…¶å®ƒçš„åœ¨è·¯ç”±è·³è½¬çš„æ—¶å€™é’©å­å‡½æ•°ä¸­åˆ¤æ–­è·¯ç”±è·¯å¾„åŒ…ä¸åŒ…å« <code>mobile/pc</code> çš„ <code>key</code> ï¼Œä»è€Œåˆ¤æ–­åœ¨ <code>next</code> çš„æ—¶å€™è¦ä¸è¦æ‹¼ä¸Š <code>mobile/pc</code> çš„æ–‡ä»¶è·¯å¾„è·³è½¬ã€‚</li></ul><p><code>App.vue</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs undefined">methods: &#123;<br>  isMobile() &#123;<br>    <span class="hljs-keyword">let</span> flag = navigator.userAgent.match(<span class="hljs-regexp">/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i</span>);<br>    <span class="hljs-keyword">this</span>.isMobileDevice = flag;<br>    <span class="hljs-keyword">return</span> flag;<br>  &#125;<br>&#125;,<br>mounted() &#123;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isMobile()) &#123;<br>  &lt;!-- å¦‚æœæ˜¯ç§»åŠ¨ç«¯çš„è¯éœ€è¦è®¾ç½®rem --&gt;<br>    (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">doc, win</span>) </span>&#123;<br>      <span class="hljs-keyword">let</span> docEl = doc.documentElement;<br>      <span class="hljs-keyword">let</span> resizeEvt =<br>        <span class="hljs-string">"orientationchange"</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">window</span> ? <span class="hljs-string">"orientationchange"</span> : <span class="hljs-string">"resize"</span>;<br>      <span class="hljs-keyword">let</span> recalc = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">var</span> clientWidth = docEl.clientWidth;<br>        <span class="hljs-keyword">if</span> (!clientWidth) <span class="hljs-keyword">return</span>;<br>        <span class="xml"><span class="hljs-comment">&lt;!-- æŒ‰ç…§750å°ºå¯¸è®¾ç½® --&gt;</span><br>        if (clientWidth &gt;= 750) &#123;<br>          <span class="hljs-comment">&lt;!-- 100ä½œä¸ºåŸºå‡†ï¼Œ100pxä¸º1rem --&gt;</span><br>          docEl.style.fontSize = "100px";<br>        &#125; else &#123;<br>          docEl.style.fontSize = 100 * (clientWidth / 750) + "px";<br>        &#125;<br>      &#125;;<br>      if (!doc.addEventListener) return;<br>      win.addEventListener(resizeEvt, recalc, false);<br>      doc.addEventListener("DOMContentLoaded", recalc, false);<br>    &#125;)(document, window);<br>    <span class="hljs-comment">&lt;!-- å¢åŠ é¡¶çº§å‘½åç©ºé—´ï¼Œç”¨äºåŒºåˆ†ä¸åŒç«¯çš„cssä½œç”¨åŸŸ --&gt;</span><br>    this.$nextTick(() =&gt; &#123;<br>      window.document<br>        .getElementsByTagName("body")[0]<br>        .setAttribute("id", "mobile-web-app");<br>    &#125;);<br>  &#125; else &#123;<br>    this.$nextTick(() =&gt; &#123;<br>      window.document<br>        .getElementsByTagName("body")[0]<br>        .setAttribute("id", "pc-web-app");<br>    &#125;);<br>  &#125;<br>&#125;</span><br></code></pre></td></tr></table></figure><h3 id="pc-å’Œ-mobile-ä¸¤å¥—ä»£ç ä»¥åŠæ ·å¼æ–‡ä»¶"><a href="#pc-å’Œ-mobile-ä¸¤å¥—ä»£ç ä»¥åŠæ ·å¼æ–‡ä»¶" class="headerlink" title="pc å’Œ mobile ä¸¤å¥—ä»£ç ä»¥åŠæ ·å¼æ–‡ä»¶"></a><code>pc</code> å’Œ <code>mobile</code> ä¸¤å¥—ä»£ç ä»¥åŠæ ·å¼æ–‡ä»¶</h3><ul><li>é’ˆå¯¹å®šä¹‰å‘½åç©ºé—´ <code>style</code> æ ‡ç­¾åº”è¯¥æ˜¯<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-selector-id">#mobile-web-app</span>, <span class="hljs-selector-id">#pc-web-app</span> &#123;<br>  <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;<br>  <span class="hljs-selector-id">#app</span> &#123;<br>    ....<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>Vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>reactPrompt åˆ‡æ¢è·¯ç”±ä¹‹å‰å¼¹å‡ºæ‹¦æˆªæç¤º</title>
    <link href="/2020/09/06/reactPrompt/"/>
    <url>/2020/09/06/reactPrompt/</url>
    
    <content type="html"><![CDATA[<h3 id="Prompt-ç»„ä»¶çš„é€»è¾‘"><a href="#Prompt-ç»„ä»¶çš„é€»è¾‘" class="headerlink" title="Prompt ç»„ä»¶çš„é€»è¾‘"></a><code>Prompt</code> ç»„ä»¶çš„é€»è¾‘</h3><ul><li><code>when</code> ä¸º <code>true</code>ï¼Œ<code>message</code> æ–¹æ³• <code>return</code> çš„å˜é‡ä¸º <code>false</code> çš„æ—¶å€™å°±ä¼šæç¤ºã€‚<code>message</code> å¯ä»¥æ¥å—ä¸€ä¸ªå‡½æ•°ä¹Ÿå¯ä»¥æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</li><li>ä¸¤ä¸ªå…³é”®ç‚¹ï¼Œéœ€è¦å¼¹å‡ºæç¤ºçš„è¯å±æ€§å³ï¼š<ul><li><code>when={true}</code></li><li><code>message={() =&gt; { return false }}</code></li></ul></li></ul><p>è‡³äºå…·ä½“çš„ <code>message</code> ä»€ä¹ˆæ—¶å€™ <code>return true</code> ä»€ä¹ˆæ—¶å€™ <code>return false</code> æ˜¯éœ€è¦æŒ‰ç…§ä¸šåŠ¡å¤„ç†ã€‚</p><h3 id="å…·ä½“ä½¿ç”¨"><a href="#å…·ä½“ä½¿ç”¨" class="headerlink" title="å…·ä½“ä½¿ç”¨"></a>å…·ä½“ä½¿ç”¨</h3><ul><li><p>åœ¨ <code>JSX</code> ä¸­å¢åŠ ç»„ä»¶ï¼Œå½“åˆ‡æ¢è·¯ç”±çš„æ—¶å€™ï¼Œ<code>visible</code> çš„çŠ¶æ€ä¼šå¯¼è‡´è¦ä¸è¦æç¤ºï¼Œåœ¨æ»¡è¶³æ¡ä»¶éœ€è¦å¼¹å‡ºçš„æ—¶å€™ï¼Œ<code>visible</code> è¦æ˜¯ <code>true</code>ã€‚</p></li><li><p>ä¾‹å¦‚ï¼šè·å–å®Œæ•°æ®ä¹‹åï¼Œé¡µé¢æœ‰æ•°æ®çš„æ—¶å€™ï¼Œåˆ‡æ¢è·¯ç”±æ˜¯éœ€è¦ç»™å‡ºæç¤ºä¿¡æ¯ã€‚å…ˆå°† <code>visible</code> å±æ€§å€¼è®¾ç½®ä¸º <code>true</code>ï¼Œè¿™æ ·åœ¨æœ‰æ•°æ®çš„æ—¶å€™ï¼Œåˆ‡æ¢è·¯ç”±å°±ä¼šæç¤ºï¼Œ<code>message</code> æ–¹æ³• <code>return</code> çš„ <code>boolean</code> å€¼ä¸ºåˆ¤æ–­æ˜¯å¦å¼¹çª—çš„é€»è¾‘ï¼Œè¿™é‡Œçš„ <code>boolean</code> ä¸º <code>false</code> å°±ä¼šæç¤ºã€‚</p></li><li><p>ä¼ªä»£ç ï¼š</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-keyword">import</span> router <span class="hljs-keyword">from</span> <span class="hljs-string">'umi/router'</span><br><br>&lt;Prompt<br>  <span class="hljs-keyword">when</span>=&#123;visible&#125; <span class="hljs-regexp">//</span> æœ‰æ•°æ®çš„æ—¶å€™visibleä¸€å®šæ˜¯<span class="hljs-literal">true</span><br>  message=&#123;location =&gt; &#123;<br>  Â  Modal.confirm(&#123;<br>  Â    title: <span class="hljs-string">'è¯·æ³¨æ„ï¼'</span>,<br>  Â    icon: &lt;ExclamationCircleOutlined /&gt;,<br>  Â    content: <span class="hljs-string">'ç¡®å®šè¦ç¦»å¼€å½“å‰é¡µé¢å—ï¼Ÿä¸€æ—¦ç¡®è®¤ç¦»å¼€ï¼Œå½“å‰é¡µé¢çš„æ•°æ®å°†è¢«ä½œåºŸï¼'</span>,<br>  Â    okText: <span class="hljs-string">'ç¡®è®¤'</span>,<br>  Â    cancelText: <span class="hljs-string">'å–æ¶ˆ'</span>,<br>  Â    onOk: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>  Â    Â  <span class="hljs-regexp">//</span> ç¡®å®šæŒ‰é’®çš„é€»è¾‘<br>  Â    &#125;,<br>  Â    onCancel: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;&#125;<br>  Â  &#125;);<br>  Â  <span class="hljs-regexp">//</span> <span class="hljs-literal">false</span>å¼¹çª—æ‹¦æˆª<br>  Â  <span class="hljs-keyword">return</span> taskList.length &gt; <span class="hljs-number">0</span> ? <span class="hljs-literal">false</span> : <span class="hljs-literal">true</span><br>Â  &#125;<br>&#125;<br>/&gt;<br></code></pre></td></tr></table></figure></li></ul><p>é˜²æ­¢è¸©å‘çš„ç‚¹ï¼š<code>message</code> é‡Œçš„ <code>return</code> ä¸€å®šè¦å†™åœ¨ <code>Modal</code> çš„å¤–è¾¹ï¼Œè¿™æ ·åœ¨åˆ¤æ–­æœ‰æ•°æ®çš„æ—¶å€™å¦‚æœæ˜¯ <code>return false</code> å°±ä¼šè‡ªåŠ¨å¼¹å‡º <code>Modal</code> æ‹¦æˆªï¼Œå¦‚æœæ˜¯ <code>return true</code> åˆ™ä¸ä¼šæç¤ºã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>React</tag>
      
      <tag>umi</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>eventLoop</title>
    <link href="/2020/08/27/eventLoop/"/>
    <url>/2020/08/27/eventLoop/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸»çº¿ç¨‹-ä»»åŠ¡é˜Ÿåˆ—-äº‹ä»¶å¾ªç¯"><a href="#ä¸»çº¿ç¨‹-ä»»åŠ¡é˜Ÿåˆ—-äº‹ä»¶å¾ªç¯" class="headerlink" title="ä¸»çº¿ç¨‹-ä»»åŠ¡é˜Ÿåˆ—-äº‹ä»¶å¾ªç¯"></a>ä¸»çº¿ç¨‹-ä»»åŠ¡é˜Ÿåˆ—-äº‹ä»¶å¾ªç¯</h1><h2 id="ä¸»çº¿ç¨‹"><a href="#ä¸»çº¿ç¨‹" class="headerlink" title="ä¸»çº¿ç¨‹"></a>ä¸»çº¿ç¨‹</h2><ul><li>åˆå§‹åŒ–å‹æ ˆï¼Œæ‰§è¡ŒåŒæ­¥ä»»åŠ¡ã€å‡½æ•°æ‰§è¡Œæ ˆåœ¨ä¸»çº¿ç¨‹</li><li>ä¸»çº¿ç¨‹æ‰§è¡Œçš„æ˜¯è¢«å‹å…¥æ‰§è¡Œæ ˆçš„åŒæ­¥ä»»åŠ¡ï¼Œä¸ç®¡æ¥æºæ˜¯å“ªé‡Œï¼Œè´Ÿè´£å‹å…¥å‡½æ•°æ‰§è¡Œæ ˆæ‰§è¡Œé€»è¾‘ã€‚å¼‚æ­¥ä»»åŠ¡çš„<code>callback</code>çš„é€»è¾‘ä¼šè¢«äº‹ä»¶å¾ªç¯é€šçŸ¥åæ‹¿åˆ°è¿™é‡Œæ¥æ‰§è¡Œã€‚</li></ul><h2 id="WebAPIs-ä»»åŠ¡é˜Ÿåˆ—-å­˜æ”¾å¼‚æ­¥ä»»åŠ¡"><a href="#WebAPIs-ä»»åŠ¡é˜Ÿåˆ—-å­˜æ”¾å¼‚æ­¥ä»»åŠ¡" class="headerlink" title="WebAPIs - ä»»åŠ¡é˜Ÿåˆ— å­˜æ”¾å¼‚æ­¥ä»»åŠ¡"></a><code>WebAPIs</code> - ä»»åŠ¡é˜Ÿåˆ— å­˜æ”¾å¼‚æ­¥ä»»åŠ¡</h2><ul><li><p>ã€<code>XHR</code>ã€‘ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„éƒ½æ˜¯å·²ç»å®Œæˆäº†<code>http</code>è¯·æ±‚ï¼Œæ˜¯è·å–å®Œæ•°æ®ç­‰å¾…æ‰§è¡Œçš„å›è°ƒå‡½æ•°ã€‚</p></li><li><p><code>AJAX</code> <code>handleData.fetchData()</code>ç†è§£ä¸ºç½‘ç»œçº¿ç¨‹å…ˆå»è¯·æ±‚æ•°æ®ï¼Œæ‹¿åˆ°æ•°æ®ä¹‹å<code>.then(res =&gt; {})</code>å›è°ƒå‡½æ•°æ³¨å†Œåˆ°ä»»åŠ¡é˜Ÿåˆ—ï¼Œè¿›å…¥å¼‚æ­¥çš„éƒ½æ˜¯å›è°ƒå‡½æ•°ä¸­çš„é‚£éƒ¨åˆ†ç¨‹åºã€‚</p></li></ul><ul><li><p>å®ä»»åŠ¡</p><ul><li>å®šæ—¶å™¨ã€<code>I/O</code></li></ul></li><li><p>å¾®ä»»åŠ¡</p><ul><li><p>åœ¨å½“å‰çš„å¾®ä»»åŠ¡æ²¡æœ‰æ‰§è¡Œå®Œæˆæ—¶ï¼Œæ˜¯ä¸ä¼šæ‰§è¡Œä¸‹ä¸€ä¸ªå®ä»»åŠ¡çš„</p></li><li><p><code>Promise.resolve</code>å’Œ<code>return new Promise</code>éƒ½æ˜¯åŒæ­¥ä»»åŠ¡ç«‹å³æ‰§è¡Œ</p></li><li><p><code>async/await</code>æ‰§è¡Œå®Œä¹‹åï¼Œä¼šç«‹å³è¿”å›ï¼Œå°±æ˜¯<code>await</code>åçš„ç¨‹åºï¼Œå¯ä»¥å½“ä½œæ˜¯<code>then</code>çš„å›è°ƒå‡½æ•°ï¼ŒåŸç†éƒ½æ˜¯ä¸€æ ·ï¼Œåªæ˜¯å¼‚æ­¥è½¬ä¸ºåŒæ­¥çš„è¯­æ³•ç³–ã€‚</p></li><li><p>ç»å…¸å…¸å‹æ¡ˆä¾‹<code>Promise</code>ç»ƒä¹ </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-built_in">console</span>.log(<span class="hljs-string">'script start'</span>)<br><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">async1</span>(<span class="hljs-params"></span>) </span>&#123;<br>Â Â <span class="hljs-keyword">await</span> async2() <span class="hljs-comment">// æ‰§è¡Œå®Œç«‹åˆ»è¿”å›</span><br>Â Â <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'async1 end'</span>) <span class="hljs-comment">// ç›¸å½“äº.thençš„callback</span><br>&#125;<br><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">async2</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'async2 end'</span>)<br>&#125;<br>async1()<br>setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'setTimeout'</span>)<br>&#125;, <span class="hljs-number">0</span>)<br><span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> &#123;<br>Â Â <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Promise'</span>)<br>Â Â resolve()<br>&#125;).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'promise1'</span>)<br>&#125;).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'promise2'</span>)<br>&#125;)<br><span class="hljs-built_in">console</span>.log(<span class="hljs-string">'script end'</span>)<br></code></pre></td></tr></table></figure></li><li><p>åŒæ­¥ä»»åŠ¡å¼€å§‹ æ‰§è¡Œ <code>console.log</code> æ‰“å° <code>script start</code></p></li><li><p>é‡åˆ° <code>async1()</code> æ‰§è¡Œï¼Œå†…éƒ¨æ‰§è¡Œawaitçš„æ–¹æ³•<code>async2</code> ï¼Œæ‰“å° <code>async2 end</code> ï¼Œè·³å‡ºã€å› ä¸º <code>await</code> åçš„ç›¸å½“äºå¼‚æ­¥å›è°ƒã€‘</p></li><li><p>å°† <code>async1 end</code> æ³¨å†Œåˆ°å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—-å¾®ä»»åŠ¡</p></li><li><p><code>setTimeout</code> æ³¨å†Œåˆ°å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—-å®ä»»åŠ¡</p></li><li><p><code>new Promise</code> åŒæ­¥æ‰§è¡Œæ‰“å° <code>Promise</code></p></li><li><p>åˆ†åˆ«æ³¨å†Œ <code>promise1</code> å’Œ <code>promise2</code> åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—</p></li><li><p>æ‰§è¡Œ <code>console.log</code> æ‰“å° <code>script end</code></p></li><li><p>ä¸»çº¿ç¨‹å˜ç©ºï¼Œäº‹ä»¶å¾ªç¯é€šçŸ¥ä¸»çº¿ç¨‹å»ä»»åŠ¡é˜Ÿåˆ—æ‹¿å–å›è°ƒä»»åŠ¡æ‰§è¡Œï¼ŒæŒ‰ç…§ <code>FIFO</code> çš„æ¥å£ä¾æ¬¡æ˜¯æ‰§è¡Œ <code>async1</code> çš„ <code>console.log</code> å’Œ <code>promise</code> çš„ä¸¤ä¸ª <code>then</code></p></li><li><p>æ‰§è¡Œå®ä»»åŠ¡ <code>setTimeout</code></p></li><li><p>ç»“æœ <code>script startã€async2 endã€Promiseã€script endã€async1 endã€promise1ã€promise2ã€setTimeout</code></p></li></ul></li></ul><h2 id="äº‹ä»¶å¾ªç¯-Event-Loop"><a href="#äº‹ä»¶å¾ªç¯-Event-Loop" class="headerlink" title="äº‹ä»¶å¾ªç¯ Event Loop"></a>äº‹ä»¶å¾ªç¯ <code>Event Loop</code></h2><ul><li><p>è´Ÿè´£å‘Šè¯‰ä¸»çº¿ç¨‹ï¼Œæ‰§è¡Œå“ªä¸ªå›è°ƒï¼Œåˆ†å‘ä»»åŠ¡ï¼ŒæŒ‰ç…§<code>FIFO</code>é˜Ÿåˆ—é¡ºåºæ‰§è¡Œã€‚ç›‘å¬å‡½æ•°æ‰§è¡Œæ ˆï¼ˆä¸»çº¿ç¨‹ï¼‰æ˜¯å¦ä¸ºç©ºï¼Œç©ºåˆ™ä¸»çº¿ç¨‹ä»ä»»åŠ¡é˜Ÿåˆ—å–å‡ºä»»åŠ¡æ”¾è¿›å‡½æ•°æ‰§è¡Œæ ˆæ‰§è¡Œã€‚</p></li><li><p>å¦‚æœé‡åˆ°ä¸»çº¿ç¨‹é˜»å¡ï¼Œå¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—çš„<code>callback</code>ç­‰å¾…ã€‚</p></li><li><p>äº‹ä»¶å¾ªç¯é€šçŸ¥ä¸»çº¿ç¨‹ï¼Œä¸»çº¿ç¨‹ä»ä»»åŠ¡é˜Ÿåˆ—å–å‡º<code>callback</code>æ‰§è¡Œï¼Œæ˜¯è¦ä¸»çº¿ç¨‹ä¸ºç©ºé—²çš„æ—¶å€™æ‰è¡Œï¼Œä¸»çº¿ç¨‹å¦‚æœä¸€ç›´æœ‰ä»»åŠ¡ä¸é‡Šæ”¾ï¼Œä»»åŠ¡é˜Ÿåˆ—çš„<code>callback</code>ä¸€ç›´æ˜¯ç­‰å¾…çŠ¶æ€ã€‚</p></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>äº‹ä»¶å¾ªç¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æµè§ˆå™¨è¿è¡ŒåŸç†</title>
    <link href="/2020/08/24/howTheBrowserWorks/"/>
    <url>/2020/08/24/howTheBrowserWorks/</url>
    
    <content type="html"><![CDATA[<h2 id="æµè§ˆå™¨è¿è¡ŒåŸç†æ¢³ç†"><a href="#æµè§ˆå™¨è¿è¡ŒåŸç†æ¢³ç†" class="headerlink" title="æµè§ˆå™¨è¿è¡ŒåŸç†æ¢³ç†"></a>æµè§ˆå™¨è¿è¡ŒåŸç†æ¢³ç†</h2><ul><li><h2 id="CPUä¸²è¡Œ"><a href="#CPUä¸²è¡Œ" class="headerlink" title="CPUä¸²è¡Œ"></a><code>CPU</code>ä¸²è¡Œ</h2><ul><li>å•æ ¸<ul><li>å¤šæ ¸</li></ul></li></ul></li><li><h2 id="GPUå›¾å½¢å¤„ç†å™¨"><a href="#GPUå›¾å½¢å¤„ç†å™¨" class="headerlink" title="GPUå›¾å½¢å¤„ç†å™¨"></a><code>GPU</code>å›¾å½¢å¤„ç†å™¨</h2><ul><li>å¤šä¸ªæ ¸å¿ƒå…±åŒå·¥ä½œï¼Œå¹¶è¡Œèƒ½åŠ›å¾ˆå¼º</li></ul></li><li><h2 id="å†…å­˜"><a href="#å†…å­˜" class="headerlink" title="å†…å­˜"></a>å†…å­˜</h2><ul><li><p>æ¸²æŸ“è¿›ç¨‹å†…å­˜</p><ul><li><p>é—®é¢˜ï¼šå› ä¸ºå¤šè¿›ç¨‹ä¸ä¼šå…±äº«å†…å­˜ç©ºé—´ï¼Œè¿›ç¨‹æ•°é‡å¤šä¹‹åå†…å­˜å ç”¨å¤§</p></li><li><p>è§£å†³ï¼šè¿›ç¨‹æ•°åˆ°è¾¾ä¸€å®šç•Œé™ä¹‹åï¼Œä¼šå°†åŒä¸€ä¸ªç½‘ç«™çš„ <code>tab</code> æ”¾åœ¨åŒä¸€ä¸ªè¿›ç¨‹ä¸­è·‘</p></li></ul></li><li><p>ç½‘ç«™éš”ç¦»ï¼šè·¨ç«™ç‚¹çš„ <code>ifream</code> æ‹¥æœ‰ä¸€ä¸ªç‹¬ç«‹çš„è¿›ç¨‹ï¼ŒåŒæºç­–ç•¥</p></li><li><p>æµè§ˆå™¨ä¸»è¿›ç¨‹æœåŠ¡åŒ–</p><ul><li><p>æ‹†åˆ†ä¸ºä¸åŒçš„æœåŠ¡</p><ul><li>åœ¨ä¸€äº›æ€§èƒ½å¥½çš„æœºå™¨ä¸Šï¼Œè¿è¡Œå•ç‹¬çš„è¿›ç¨‹ï¼Œæé«˜ç³»ç»Ÿçš„ç¨³å®šæ€§ã€‚</li><li>åœ¨ä¸€äº›æ€§èƒ½ä¸å¥½çš„æœºå™¨ä¸Šï¼Œè¿è¡Œåˆå¹¶ä¸ºä¸€ä¸ªè¿›ç¨‹ï¼ŒèŠ‚çº¦å†…å­˜ã€‚</li></ul></li><li><p>ç›®çš„ï¼šèŠ‚çœå†…å­˜</p></li></ul></li></ul></li></ul><ul><li><h2 id="å¤šè¿›ç¨‹æ¶æ„"><a href="#å¤šè¿›ç¨‹æ¶æ„" class="headerlink" title="å¤šè¿›ç¨‹æ¶æ„"></a>å¤šè¿›ç¨‹æ¶æ„</h2><ul><li><h3 id="æµè§ˆå™¨ä¸»è¿›ç¨‹ï¼Œä¼šæœ‰å¾ˆå¤šçº¿ç¨‹"><a href="#æµè§ˆå™¨ä¸»è¿›ç¨‹ï¼Œä¼šæœ‰å¾ˆå¤šçº¿ç¨‹" class="headerlink" title="æµè§ˆå™¨ä¸»è¿›ç¨‹ï¼Œä¼šæœ‰å¾ˆå¤šçº¿ç¨‹"></a>æµè§ˆå™¨ä¸»è¿›ç¨‹ï¼Œä¼šæœ‰å¾ˆå¤šçº¿ç¨‹</h3><ul><li><p>æ¦‚è§ˆï¼šä¸»è¿›ç¨‹ä¼šå¾—çŸ¥è¿™äº›è¯·æ±‚ä»¥åŠçº¿ç¨‹åˆ›å»ºé€šä¿¡çš„ä¿¡æ¯ï¼Œä¸»è¿›ç¨‹å¾—çŸ¥æ•°æ®å‡†å¤‡å®Œæˆä¹‹åï¼Œä¼šé€šè¿‡<code>IPC</code>é€šçŸ¥æ¸²æŸ“è¿›ç¨‹ï¼Œå¯ä»¥æäº¤æœ¬æ¬¡å¯¼èˆªï¼Œå¹¶ä¸”ç»§ç»­æ¥å—æ¥ä¸‹æ¥çš„<code>HTML</code>æ•°æ®ï¼Œæ¸²æŸ“è¿›ç¨‹å¯¼èˆªç»“æŸä¹‹åä¼šé€šçŸ¥ä¸»è¿›ç¨‹ï¼Œæœ¬æ¬¡å¯¼èˆªç»“æŸï¼Œå¼€å§‹åŠ è½½å¹¶ä¸”æ¸²æŸ“å’Œè§£æ<code>HTML</code>æ–‡æ¡£ã€‚è¿™æ—¶å€™ï¼Œæµè§ˆå™¨<code>tab</code>çš„å½“å‰ä¼šè¯ä¼šè¢«æ›´æ–°ä¸ºæ–°å¯¼èˆªçš„åœ°å€ï¼Œä»¥åŠå¼€å§‹åŠ è½½<code>tab</code>èŠèŠ±ã€ç”Ÿæ•ˆåé€€æŒ‰é’®ï¼Œä¸ºäº†æ–¹ä¾¿æ‰“å¼€ä¹‹å‰å…³é—­çš„tabä¼šè¯ï¼Œæµè§ˆå™¨çš„å†å²ä¼šè¯ä¼šè¢«ä¿å­˜åœ¨ç£ç›˜ä¸Šã€‚</p></li><li><p>è´Ÿè´£åŒ…æ‹¬åœ°å€æ ï¼Œä¹¦ç­¾æ ï¼Œå‰è¿›åé€€æŒ‰é’®ç­‰éƒ¨åˆ†çš„å·¥ä½œï¼›</p></li><li><p>è´Ÿè´£å¤„ç†æµè§ˆå™¨çš„ä¸€äº›ä¸å¯è§çš„åº•å±‚æ“ä½œï¼Œæ¯”å¦‚ç½‘ç»œè¯·æ±‚å’Œæ–‡ä»¶è®¿é—®ï¼›</p></li><li><p>å¯¼èˆªè¾“å…¥-<code>UI</code>çº¿ç¨‹</p></li><li><p>å¤„ç†è¾“å…¥</p><ul><li><p>æ ¹æ®ç”¨æˆ·çš„è¾“å…¥ï¼Œ<code>UI</code>çº¿ç¨‹è¦è¿›è¡Œä¸€ç³»åˆ—çš„è§£ææ¥åˆ¤å®šæ˜¯å°†ç”¨æˆ·è¾“å…¥å‘é€ç»™æœç´¢å¼•æ“è¿˜æ˜¯ç›´æ¥è¯·æ±‚è¾“å…¥çš„ç«™ç‚¹èµ„æºã€‚</p></li><li><p>å¼€å§‹å¤„ç†</p><p>  å½“ç”¨æˆ·æŒ‰ä¸‹å›è½¦é”®çš„æ—¶å€™ï¼Œç¡®å®šè§£æç±»å‹</p><ul><li><h3 id="ç¼“å­˜"><a href="#ç¼“å­˜" class="headerlink" title="ç¼“å­˜"></a>ç¼“å­˜</h3><ul><li><p>æµè§ˆå™¨å‘é€è¯·æ±‚å‰ï¼Œæ ¹æ®è¯·æ±‚å¤´çš„<code>expires</code>å’Œ<code>cache-control</code>åˆ¤æ–­æ˜¯å¦å‘½ä¸­ï¼ˆåŒ…æ‹¬æ˜¯å¦è¿‡æœŸï¼‰å¼ºç¼“å­˜ç­–ç•¥ï¼Œå¦‚æœå‘½ä¸­ï¼Œç›´æ¥ä»ç¼“å­˜è·å–èµ„æºï¼Œå¹¶ä¸ä¼šå‘é€è¯·æ±‚ã€‚å¦‚æœæ²¡æœ‰å‘½ä¸­ï¼Œåˆ™è¿›å…¥ä¸‹ä¸€æ­¥ã€‚</p></li><li><p>æ²¡æœ‰å‘½ä¸­å¼ºç¼“å­˜è§„åˆ™ï¼Œæµè§ˆå™¨ä¼šå‘é€è¯·æ±‚ï¼Œæ ¹æ®è¯·æ±‚å¤´çš„<code>last-modified</code>å’Œ<code>etag</code>åˆ¤æ–­æ˜¯å¦å‘½ä¸­åå•†ç¼“å­˜ï¼Œå¦‚æœå‘½ä¸­ï¼Œç›´æ¥ä»ç¼“å­˜è·å–èµ„æºã€‚å¦‚æœæ²¡æœ‰å‘½ä¸­ï¼Œåˆ™è¿›å…¥ä¸‹ä¸€æ­¥ã€‚</p></li><li><p>å¦‚æœå‰ä¸¤æ­¥éƒ½æ²¡æœ‰å‘½ä¸­ï¼Œåˆ™ç›´æ¥ä»æœåŠ¡ç«¯è·å–èµ„æºã€‚</p></li></ul></li></ul></li><li><p>è¯»å–å“åº”</p><ul><li><p>ç¡®å®šå“åº”ä¸»ä½“çš„å…·ä½“åª’ä½“ç±»å‹<code>ï¼ˆMIME Typeï¼‰</code>ï¼Œæœ€ç›´æ¥çš„æ–¹æ³•å°±æ˜¯é€šè¿‡<code>HTTP</code>è¯·æ±‚å¤´çš„ <code>Content-Type</code> æ¥åˆ¤æ–­æ˜¯å±äºå“ªç§åª’ä½“ç±»å‹ï¼Œç½‘ç»œçº¿ç¨‹å‘ŠçŸ¥<code>UI</code>çº¿ç¨‹ï¼Œæ•°æ®å·²ç»å‡†å¤‡å¥½å¯ä»¥å¼€å§‹å¯¼èˆªåˆ°æ‰€éœ€è¦çš„ç«™ç‚¹</p></li><li><p>åœ¨å¼€å§‹å¤„ç†çš„æ—¶å€™ï¼Œå·²ç»çŸ¥é“è¦å¯¼èˆªåˆ°å“ªé‡Œçš„ç«™ç‚¹ï¼Œæµè§ˆå™¨ä¸ºäº†ä¼˜åŒ–ï¼Œ<code>UI</code>çº¿ç¨‹å…¶å®å·²ç»åœ¨è¿™ä¸€æ­¥å¼€å§‹æå‰å¯åŠ¨åˆ›å»ºäº†ä¸€ä¸ªæ¸²æŸ“è¿›ç¨‹ï¼Œå¦‚æœä¸€åˆ‡éƒ½æ²¡é—®é¢˜ï¼Œå“åº”å›æ¥ä¹‹åå°±å¯ä»¥ç›´æ¥å‡†å¤‡æ¸²æŸ“ï¼Œè€Œä¸æ˜¯ç­‰æ•°æ®å‡†å¤‡å¥½ä¹‹åæ‰å¼€å§‹åˆ›å»ºã€‚å¦‚æœç½‘ç«™å¤±æ•ˆæˆ–è€…é‡å®šå‘ä¹‹ç±»çš„è¯ï¼Œåˆšåˆšä¸ºå…ˆå‰çš„ç«™ç‚¹åˆ›å»ºçš„æ¸²æŸ“è¿›ç¨‹ä¼šè¢«æ‘’å¼ƒï¼Œä»è€Œå¼€å§‹åˆ›å»ºä¸€ä¸ªæ–°çš„ç›®æ ‡æ¸²æŸ“è¿›ç¨‹ã€‚</p></li></ul></li><li><p><code>Content-Type: text/html</code></p></li><li><p><code>zip</code> <code>/</code> é™æ€èµ„æºæ–‡ä»¶</p></li></ul></li><li><p>ç½‘ç»œè¯·æ±‚-ç½‘ç»œçº¿ç¨‹</p><ul><li><p>å‘èµ·æ–°çš„è¯·æ±‚ï¼šç½‘ç»œçº¿ç¨‹ åˆå§‹åŒ–ä¸€ä¸ªç½‘ç»œè¯·æ±‚æ¥è·å–ç«™ç‚¹çš„å†…å®¹ã€‚ç½‘ç»œçº¿ç¨‹ä¼šè¿›è¡Œä¸€ç³»åˆ—è¯¸å¦‚<code>DNS</code>å¯»å€ä»¥åŠä¸ºè¯·æ±‚å»ºç«‹<code>TLS</code>è¿æ¥ç­‰çš„æ“ä½œã€‚ç½‘ç»œçº¿ç¨‹ä¼šå‡†å¤‡ä¸€äº›æ“ä½œï¼Œå¦‚ä¸‹ï¼š</p><ul><li><code>DNS</code>åŸŸåè§£æ</li><li>å»ºç«‹<code>TCP</code>è¿æ¥</li><li><code>SSL/TLS</code></li><li>å‘èµ·<code>HTTP/HTTPS</code>è¯·æ±‚</li></ul></li><li><p><code>DNS</code>è§£æ</p></li><li><p><code>TCP/IP</code>è¿æ¥</p></li><li><p><code>SSL/TLS</code></p><ul><li><code>TLS</code> æ¡æ‰‹åè®®ï¼ˆéå¯¹ç§°åŠ å¯†ç®—æ³•ï¼‰ï¼Œå®¢æˆ·ç«¯å¸¦ç€<code>HOST</code>ä»¥åŠéšæœºç”Ÿæˆçš„ä¸€ä¸ª<code>session key1</code>å»æœåŠ¡å™¨æ¡æ‰‹ï¼ŒæœåŠ¡å™¨æ”¶åˆ°<code>TLS</code>è¯·æ±‚ï¼Œæ ¹æ®å®¢æˆ·ç«¯<code>HOST</code>å¯»æ‰¾ä¸»æœºä»¥åŠå®‰å…¨è¯ä¹¦ï¼ŒæœåŠ¡å™¨ç”Ÿæˆä¸€ä¸ª<code>session key2</code>ä»¥åŠå°†åŠ å¯†å¥—ä»¶å’Œè¯ä¹¦è¿”å›ç»™æµè§ˆå™¨ï¼Œå®¢æˆ·ç«¯éªŒè¯è¯ä¹¦æœ‰æ•ˆæ€§ï¼ˆæœ‰æ•ˆæ€§ï¼ŒåŸŸåï¼Œæœ‰æ•ˆæœºæ„ï¼ŒåŠé”€çŠ¶æ€ï¼‰å¿…é¡»å…¨éƒ¨æ»¡è¶³ï¼Œå¦åˆ™ä¼šæç¤ºè­¦å‘Šï¼ŒéªŒè¯å¦‚æœé€šè¿‡ï¼Œæµè§ˆå™¨ç”Ÿæˆä¸€ä»½<code>session key3</code>é€šè¿‡ç¬¬äºŒæ­¥æœåŠ¡å™¨è¿”å›çš„å…¬é’¥åŠ å¯†ï¼Œå°†ç»“æœå†æ¬¡è¿”å›ç»™æœåŠ¡å™¨ï¼Œæµè§ˆå™¨å°†<code>session key1ã€session key2ã€session key3</code>ç»„åˆç”Ÿæˆä¸€ä¸ªæ–°çš„<code>session key</code>ï¼ŒæœåŠ¡å™¨æ”¶åˆ°4çš„æ•°æ®ï¼Œåˆ©ç”¨éå¯¹ç§°åŠ å¯†ç®—æ³•è§£æå‡º<code>session key3</code>ï¼ŒåŒæ ·ä¹Ÿç”¨<code>key123</code>ç»„åˆç”Ÿæˆ<code>session key</code></li></ul></li><li><p><code>HTTP/HTTPS</code>å“åº”</p><ul><li><p>å“åº”ç±»å‹</p><ul><li><p>é™æ€æ–‡ä»¶ <code>html-&gt;text/html</code></p></li><li><p>é™æ€æ–‡ä»¶ <code>js-&gt;application/javascript</code></p></li><li><p>é™æ€å›¾ç‰‡ <code>image/pngã€jpgã€jpegã€webp</code></p></li><li><p><code>json</code>æ•°æ® <code>application/json</code></p></li><li><p><code>css</code>æ ·å¼ <code>text/css</code></p></li></ul></li></ul></li></ul></li><li><p>æ–‡ä»¶è¯»å†™-å­˜å‚¨çº¿ç¨‹</p></li></ul></li><li><h3 id="æ¸²æŸ“è¿›ç¨‹"><a href="#æ¸²æŸ“è¿›ç¨‹" class="headerlink" title="æ¸²æŸ“è¿›ç¨‹"></a>æ¸²æŸ“è¿›ç¨‹</h3><ul><li><p>æ¦‚è§ˆï¼šè´Ÿè´£ä¸€ä¸ª <code>tab</code> å†…å…³äºç½‘é¡µå‘ˆç°çš„æ‰€æœ‰äº‹æƒ…ã€‚<br>  å¯¼èˆªè¢«ç¡®è®¤ä¹‹åï¼Œæ¸²æŸ“è¿›ç¨‹ä¼šç”¨ç›¸å…³èµ„æºå¼€å§‹æ¸²æŸ“é¡µé¢ã€‚æ¸²æŸ“å®Œæˆä¹‹åï¼Œé€šè¿‡<code>IPC</code>å‘ŠçŸ¥æµè§ˆå™¨è¿›ç¨‹ï¼Œ<code>UI</code>çº¿ç¨‹ä»è€Œåœæ­¢<code>loading</code>ã€‚<br>  å¦‚æœåœ¨è¿™ä¸ªæ—¶å€™çªç„¶é‡æ–°è¾“å…¥ä¸€ä¸ªæ–°çš„ç«™ç‚¹ï¼Œæ—§çš„è¿›ç¨‹åšæ”¶å°¾å·¥ä½œï¼Œæ–°çš„è¿›ç¨‹å¼€å§‹æ–°çš„ä¸€è½®æµç¨‹æ“ä½œã€‚<br>  å°½å¯èƒ½çš„ä¸ºæ¯ä¸ªæ–°å¼€çš„<code>Tab</code>åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„å†…å­˜ä»¥åŠè¿›ç¨‹ï¼ˆå®‰å…¨ã€æ²™ç®±ï¼‰</p></li><li><p>ä¸»çº¿ç¨‹</p><p>  è§£æ</p><p>  <code>HTML</code>æ–‡æ¡£è½¬æ¢ä¸º<code>DOM</code>å¯¹è±¡</p><ul><li><p><code>HTML</code>çš„è§£ææŒ‰ç…§<code>HTML</code>æ ‡å‡†æ¥è§£æ</p></li><li><p>è§£ææ¬¡çº§èµ„æº -&gt; è½¬ä¸ºç½‘ç»œçº¿ç¨‹ä¸‹è½½</p><ul><li><p>æ¸²æŸ“è¿›ç¨‹è§£æçš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœé‡åˆ°ç½‘é¡µä¸­çš„<code>&lt;img&gt;&lt;link&gt;</code>è¿™äº›æ ‡ç­¾ç­‰ï¼Œæµè§ˆå™¨ä¼šæ¸²æŸ“è¿›ç¨‹è½¬è€Œè®©ç½‘ç»œçº¿ç¨‹å»ç°åœ¨è¿™äº›èµ„æº</p><ul><li><p>å›¾ç‰‡</p></li><li><p><code>css</code>æ ·å¼</p></li><li><p><code>js</code></p></li></ul></li></ul></li><li><p>JSçš„ä¸‹è½½å’Œæ‰§è¡Œ</p><ul><li><code>JS</code>å’Œ<code>DOM</code>è§£ææ˜¯äº’æ–¥çš„ï¼Œå› ä¸º<code>JS</code>æ“ä½œå¯èƒ½ä¼šæ”¹å˜<code>DOM</code>ç»“æ„ï¼Œé‚éœ€è¦<code>DOM</code>åŠ è½½å®Œæˆä¹‹åã€‚åœ¨é‡åˆ°<code>script</code>æ ‡ç­¾çš„æ—¶å€™ï¼Œ<code>HTML</code>çš„åŠ è½½å’Œè§£æéƒ½ä¼šåœæ­¢ã€‚</li></ul></li><li><p>æ„å»º<code>CSSOM</code></p><ul><li>æ ¹æ®å…ƒç´ é€‰æ‹©å™¨ï¼Œæ¸²æŸ“æ„å»º<code>CCSOM</code>ï¼Œè®¡ç®—ç”Ÿæˆæ ·å¼</li></ul></li><li><p>å¸ƒå±€</p><ul><li>é€šè¿‡éå†<code>DOM</code>å¯¹è±¡ï¼Œè®¡ç®—æ ·å¼å’Œå¸ƒå±€ä½ç½®åæ ‡ä»¥åŠç›’å­å¤§å°ï¼Œç”Ÿæˆå¸ƒå±€æ ‘ï¼Œå¸ƒå±€æ ‘å’Œ<code>DOM</code>æ ‘çš„åŒºåˆ«ï¼šè§†å›¾å¯è§ä¸ºå¸ƒå±€æ ‘ï¼Œä¾‹å¦‚ï¼Œ<code>display:none</code>åœ¨å¸ƒå±€æ ‘ä¸Šä¸æ˜¾ç¤ºï¼Œä½†æ˜¯åœ¨<code>DOM</code>æ ‘ä¸Šä¼šæœ‰</li></ul></li><li><p>ç»˜åˆ¶</p><ul><li>è®¡ç®—å‡ºäº†æ ·å¼å’Œå¸ƒå±€å·¦è¾¹ï¼ŒæŒ‰ç…§å…ˆåé¡ºåºç»˜åˆ¶å…ƒç´ </li></ul></li><li><p>åˆæˆå¸§</p><ul><li>ä¸»çº¿ç¨‹é€šè¿‡éå†å¸ƒå±€æ ‘ç”Ÿæˆå±‚æ ‘ï¼Œæ¯ä¸€å±‚éƒ½ä¼šè¢«å•ç‹¬çš„æ …æ ¼åŒ–ï¼Œæœ€åé€šè¿‡åˆæˆçº¿ç¨‹å°†å±‚ç»„åˆä¸ºå¸§ã€‚<br>   å±‚æ ‘ç¡®å®šï¼Œä¸»çº¿ç¨‹-&gt;åˆæˆçº¿ç¨‹ï¼Œåˆæˆçº¿ç¨‹æ …æ ¼åŒ–æ¯ä¸€å±‚ï¼Œåˆæˆçº¿ç¨‹å°†å…¶æ¯ä¸€å±‚åˆ†å‰²ä¸ºå¤šä¸ªç£è´´ï¼Œæ¯ä¸ªç£è´´ä¼šå‘é€åˆ°æ …æ ¼çº¿ç¨‹ï¼Œæ …æ ¼åŒ–æ¯ä¸ªç£è´´ï¼Œå¹¶ä¸”å­˜å‚¨åœ¨<code>GPU</code>æ˜¾å­˜ä¸Š</li></ul></li></ul></li><li><p>å·¥ä½œçº¿ç¨‹</p><ul><li>å¤„ç†<code>web worker</code>æˆ–è€…<code>service worker</code>çš„ä¸€äº›äº‹æƒ…</li></ul></li><li><p>åˆæˆçº¿ç¨‹</p><ul><li>åˆæˆæ˜¯ä¸€ç§å°†é¡µé¢åˆ†æˆè‹¥å¹²å±‚ï¼Œç„¶ååˆ†åˆ«å¯¹å®ƒä»¬è¿›è¡Œå…‰æ …åŒ–ï¼Œæœ€ååœ¨ä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹ - åˆæˆçº¿ç¨‹<code>ï¼ˆcompositor threadï¼‰</code>é‡Œé¢åˆå¹¶æˆä¸€ä¸ªé¡µé¢çš„æŠ€æœ¯ã€‚å½“ç”¨æˆ·æ»šåŠ¨é¡µé¢æ—¶ï¼Œç”±äºé¡µé¢å„ä¸ªå±‚éƒ½å·²ç»è¢«å…‰æ …åŒ–äº†ï¼Œæµè§ˆå™¨éœ€è¦åšçš„åªæ˜¯åˆæˆä¸€ä¸ªæ–°çš„å¸§æ¥å±•ç¤ºæ»šåŠ¨åçš„æ•ˆæœç½¢äº†ã€‚<br>åˆæˆå™¨çš„ä¼˜ç‚¹åœ¨äºï¼Œå…¶å·¥ä½œæ— å…³ä¸»çº¿ç¨‹ï¼Œåˆæˆå™¨çº¿ç¨‹ä¸éœ€è¦ç­‰å¾…æ ·å¼è®¡ç®—æˆ–è€…<code>JS</code>æ‰§è¡Œï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆåˆæˆå™¨ç›¸å…³çš„åŠ¨ç”» æœ€æµç•…ï¼Œå¦‚æœæŸä¸ªåŠ¨ç”»æ¶‰åŠåˆ°å¸ƒå±€æˆ–è€…ç»˜åˆ¶çš„è°ƒæ•´ï¼Œå°±ä¼šæ¶‰åŠåˆ°ä¸»çº¿ç¨‹çš„é‡æ–°è®¡ç®—ï¼Œè‡ªç„¶ä¼šæ…¢å¾ˆå¤šã€‚</li></ul></li><li><p>å…‰æ …çº¿ç¨‹</p><ul><li>å°†éœ€è¦å±•ç¤ºçš„ä¿¡æ¯è½¬åŒ–ä¸ºæ˜¾ç¤ºå™¨çš„åƒç´ çš„è¿‡ç¨‹å«åšå…‰æ …åŒ–</li></ul></li></ul></li><li><h3 id="æ¸²æŸ“è¿›ç¨‹-è”ç³»-ç”¨æˆ·äº‹ä»¶"><a href="#æ¸²æŸ“è¿›ç¨‹-è”ç³»-ç”¨æˆ·äº‹ä»¶" class="headerlink" title="æ¸²æŸ“è¿›ç¨‹ è”ç³»  ç”¨æˆ·äº‹ä»¶"></a>æ¸²æŸ“è¿›ç¨‹ è”ç³»  ç”¨æˆ·äº‹ä»¶</h3><p>  æ¦‚è§ˆï¼šåˆæˆçº¿ç¨‹ä¼šå°†æ³¨å†Œäº†äº‹ä»¶çš„åŒºåŸŸç»‘å®šä¸ºï¼Œéå¿«é€Ÿæ»šåŠ¨åŒºåŸŸã€‚å½“ç”¨æˆ·äº‹ä»¶å‘ç”Ÿåœ¨è¿™äº›åŒºåŸŸæ—¶ï¼Œåˆæˆçº¿ç¨‹ä¼šå°†è¾“å…¥äº‹ä»¶å‘é€ç»™ä¸»çº¿ç¨‹æ¥å¤„ç†ã€‚å¦‚æœè¾“å…¥äº‹ä»¶ä¸æ˜¯å‘ç”Ÿåœ¨éå¿«é€Ÿæ»šåŠ¨åŒºåŸŸï¼Œåˆæˆçº¿ç¨‹å°±æ— é¡»ä¸»çº¿ç¨‹çš„å‚ä¸æ¥åˆæˆä¸€ä¸ªæ–°çš„å¸§ã€‚</p><ul><li><p>äº‹ä»¶ç›‘å¬ä¼ªä»£ç </p>  <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs undefined">document.body.addEventListener(<span class="hljs-string">'touchstart'</span>, <span class="hljs-keyword">event</span> =&gt; &#123;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">event</span>.target === area) &#123;<br><span class="hljs-keyword">event</span>.preventDefault()<br>&#125;<br>&#125;, &#123;passive: <span class="hljs-literal">true</span>&#125;);<br></code></pre></td></tr></table></figure><p>  <code>{passive: true}</code> è¿™ä¸ªå‚æ•°ä¼šå‘Šè¯‰æµè§ˆå™¨æ‚¨ä»è¦åœ¨ä¸»çº¿ç¨‹ä¸­ä¾¦å¬äº‹ä»¶ï¼Œåˆæˆçº¿ç¨‹ä¹Ÿå¯ä»¥ç»§ç»­åˆæˆæ–°çš„å¸§ã€‚<br>  å¦åˆ™ï¼Œä¸€äº›æ²¡æœ‰ç”¨æˆ·è¾“å…¥çš„é¡µé¢ï¼Œä¹Ÿä¼šç­‰ä¸»çº¿ç¨‹å®Œæˆä¹‹ååˆæˆçº¿ç¨‹æ‰å¹²æ´»ï¼Œä»è€Œä¸§å¤±åˆæˆçº¿ç¨‹ä¼˜åŠ¿ã€‚ç±»ä¼¼äºåŒæ­¥å’Œå¼‚æ­¥æ–¹å¼ã€‚</p></li><li><p>æŸ¥æ‰¾äº‹ä»¶çš„ç›®æ ‡å¯¹è±¡</p><ul><li>å½“åˆæˆçº¿ç¨‹å‘ä¸»çº¿ç¨‹å‘é€è¾“å…¥äº‹ä»¶æ—¶ï¼Œä¸»çº¿ç¨‹è¦åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯é€šè¿‡å‘½ä¸­æµ‹è¯•å»æ‰¾åˆ°äº‹ä»¶çš„ç›®æ ‡å¯¹è±¡ã€‚å…·ä½“çš„å‘½ä¸­æµ‹è¯•æµç¨‹æ˜¯éå†åœ¨æ¸²æŸ“æµæ°´çº¿ä¸­ç”Ÿæˆçš„ç»˜ç”»è®°å½•æ¥æ‰¾åˆ°è¾“å…¥äº‹ä»¶å‡ºç°çš„<code>x, y</code>åæ ‡ä¸Šé¢æç»˜çš„å¯¹è±¡æ˜¯å“ªä¸ª</li></ul></li></ul></li><li><h3 id="æ’ä»¶è¿›ç¨‹"><a href="#æ’ä»¶è¿›ç¨‹" class="headerlink" title="æ’ä»¶è¿›ç¨‹"></a>æ’ä»¶è¿›ç¨‹</h3><ul><li>è´Ÿè´£æ§åˆ¶ä¸€ä¸ªç½‘é¡µç”¨åˆ°çš„æ‰€æœ‰æ’ä»¶</li></ul></li><li><h3 id="GPU-è¿›ç¨‹"><a href="#GPU-è¿›ç¨‹" class="headerlink" title="GPU è¿›ç¨‹"></a><code>GPU</code> è¿›ç¨‹</h3><ul><li>è´Ÿè´£å¤„ç† <code>GPU</code> ç›¸å…³çš„ä»»åŠ¡ï¼Œç‹¬ç«‹è¿›ç¨‹æ˜¯å› ä¸ºè¦å¤„ç†ä¸åŒ<code>tab</code>çš„æ¸²æŸ“è¯·æ±‚</li></ul></li><li><h3 id="å·¥å…·è¿›ç¨‹"><a href="#å·¥å…·è¿›ç¨‹" class="headerlink" title="å·¥å…·è¿›ç¨‹"></a>å·¥å…·è¿›ç¨‹</h3></li><li><h3 id="ä¸‹è½½ç®¡ç†å™¨"><a href="#ä¸‹è½½ç®¡ç†å™¨" class="headerlink" title="ä¸‹è½½ç®¡ç†å™¨"></a>ä¸‹è½½ç®¡ç†å™¨</h3></li></ul></li></ul><h2 id="æµè§ˆå™¨ä¸»çº¿ç¨‹ã€v8è§£æå¤šçº¿ç¨‹è§£æã€æ‰§è¡Œjs"><a href="#æµè§ˆå™¨ä¸»çº¿ç¨‹ã€v8è§£æå¤šçº¿ç¨‹è§£æã€æ‰§è¡Œjs" class="headerlink" title="æµè§ˆå™¨ä¸»çº¿ç¨‹ã€v8è§£æå¤šçº¿ç¨‹è§£æã€æ‰§è¡Œjs"></a>æµè§ˆå™¨ä¸»çº¿ç¨‹ã€<code>v8</code>è§£æå¤šçº¿ç¨‹è§£æã€æ‰§è¡Œ<code>js</code></h2><ul><li><p>æ¦‚è§ˆ</p><ul><li><p><code>JavaScirpt</code>å¼•æ“å¯ä»¥å°†JSä»£ç ç¼–è¯‘ä¸ºä¸åŒ<code>CPU</code>å¯¹åº”çš„æ±‡ç¼–ä»£ç ï¼Œè¿™æ ·æˆ‘ä»¬æ‰ä¸è¦å»ç¿»é˜…æ¯ä¸ª<code>CPU</code>çš„æŒ‡ä»¤é›†æ‰‹å†Œã€‚å½“ç„¶ï¼Œ<code>JavaScript</code>å¼•æ“çš„å·¥ä½œä¹Ÿä¸åªæ˜¯ç¼–è¯‘ä»£ç ï¼Œå®ƒè¿˜è¦è´Ÿè´£æ‰§è¡Œä»£ç ã€åˆ†é…å†…å­˜ä»¥åŠåƒåœ¾å›æ”¶ã€‚</p></li><li><p><code>V8</code>å±äº<code>JIT</code>ç¼–è¯‘å™¨ï¼Œåœ¨è¿è¡Œçš„æ—¶å€™å…ˆç¼–è¯‘å†æ‰§è¡Œï¼Œè¿™ç§æ–¹å¼è¢«ç§°ä¸ºå³æ—¶ç¼–è¯‘ï¼Œç›´æ¥è¿è¡Œæºç <code>js</code></p></li><li><p>å›¾ç‰‡å‚è€ƒï¼š<a href="https://image.fundebug.com/2019-07-16-ignition-turbofan-pipeline.png" target="_blank" rel="noopener">https://image.fundebug.com/2019-07-16-ignition-turbofan-pipeline.png</a>ã€<a href="https://pic3.zhimg.com/80/v2-577dc100b5725942708b9ab7e74ac4b0_720w.jpg" target="_blank" rel="noopener">https://pic3.zhimg.com/80/v2-577dc100b5725942708b9ab7e74ac4b0_720w.jpg</a></p></li><li><p>è§£é‡Šå™¨å‚è€ƒï¼š<a href="https://zhuanlan.zhihu.com/p/41496446" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/41496446</a></p></li></ul></li><li><h3 id="è¯æ³•åˆ†æ"><a href="#è¯æ³•åˆ†æ" class="headerlink" title="è¯æ³•åˆ†æ"></a>è¯æ³•åˆ†æ</h3></li><li><h3 id="è¯­æ³•åˆ†æ"><a href="#è¯­æ³•åˆ†æ" class="headerlink" title="è¯­æ³•åˆ†æ"></a>è¯­æ³•åˆ†æ</h3><ul><li>æ±‡æ€»ï¼šè¯æ³•åˆ†æã€è¯­æ³•åˆ†æ å°†<code>JavaScript</code>æºç è½¬æ¢ä¸º<code>AST</code>ã€<code>AST</code>ç”Ÿæˆä½œç”¨åŸŸä»¥åŠæ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œå¯¹æ‰€æœ‰çš„å˜é‡å’Œå‡½æ•°å®šä¹‰ é¢„ç¼–è¯‘<ul><li>è¯æ³•ä½œç”¨åŸŸå’ŒåŠ¨æ€ä½œç”¨åŸŸ<ul><li>è¯æ³•ä½œç”¨åŸŸæ˜¯åœ¨å®šä¹‰çš„æ—¶å€™ä½œç”¨åŸŸå·²ç»å®šäº†,è·Ÿç€ä¹¦å†™çš„ä½ç½®æŸ¥æ‰¾ä¸Šä¸€å±‚çš„ä»£ç </li><li>åŠ¨æ€ä½œç”¨åŸŸæ˜¯ä»£ç è¿è¡Œçš„æ—¶å€™ï¼Œå½“å‰å‡½æ•°ä½œç”¨åŸŸæ‰¾ä¸åˆ°ï¼Œä¼šå‡ºå»å½“å‰å‡½æ•°çš„ä¸Šä¸‹æ–‡</li></ul></li></ul></li></ul></li><li><h3 id="Ignitionè§£é‡Šå™¨æ„å»ºä»£ç "><a href="#Ignitionè§£é‡Šå™¨æ„å»ºä»£ç " class="headerlink" title="Ignitionè§£é‡Šå™¨æ„å»ºä»£ç "></a><code>Ignition</code>è§£é‡Šå™¨æ„å»ºä»£ç </h3><p>  ä¸€ä¸ªå…·æœ‰ç´¯åŠ çš„å¯„å­˜å™¨</p><ul><li><p>æ ¹æ®<code>AST</code>å’Œä½œç”¨åŸŸè½¬ç”Ÿæˆå­—èŠ‚ç ï¼ˆå†…å­˜å°äºæœºå™¨ç ï¼‰ã€æ‰§è¡Œ </p></li><li><p>æ­¤å¤„å·²ç»å¼€å§‹æ‰§è¡Œï¼Œåªæ˜¯æ‰§è¡Œçš„ä¸æ˜¯<code>hot</code>çš„çƒ­ç‚¹ä»£ç </p></li><li><p>æ”¶é›†å‡½æ•°è¿è¡Œæ—¶çš„ä¿¡æ¯</p></li></ul></li><li><h3 id="TurboFanç¼–è¯‘å™¨"><a href="#TurboFanç¼–è¯‘å™¨" class="headerlink" title="TurboFanç¼–è¯‘å™¨"></a><code>TurboFan</code>ç¼–è¯‘å™¨</h3><ul><li><p>å°†è§£é‡Šå™¨ç”Ÿæˆçš„å­—èŠ‚ç ä¼˜åŒ–è½¬ä¸ºæœºå™¨ä»£ç </p></li><li><p>çƒ­ç‚¹ä»£ç ï¼šåœ¨è¢«è§£é‡Šå™¨å¤šæ¬¡æ‰§è¡Œçš„ä»£ç ã€‚</p></li><li><p>è¿™éƒ¨åˆ†çš„å¤šæ¬¡æ‰§è¡Œçš„ä»£ç ï¼Œä¼šè¢«ç¼–è¯‘æˆäºŒè¿›åˆ¶ï¼Œä¸‹æ¬¡æ‰§è¡Œçš„æ—¶å€™ä¼šç›´æ¥æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶<code>ï¼ˆJITï¼‰</code></p></li><li><p>ä¸ºä»€ä¹ˆè¦å«ç¼–è¯‘å™¨å‘¢ï¼Ÿå› ä¸ºä¼šæŠŠçƒ­ç‚¹ä»£ç ç¼–è¯‘æˆä¸ºç±»ä¼¼cç¼–è¯‘å®Œæˆçš„é‚£ç§å¯ä»¥ç›´æ¥æ‰§è¡Œçš„æœºå™¨ä»£ç </p></li><li><h3 id="æ±‡æ€»ï¼š"><a href="#æ±‡æ€»ï¼š" class="headerlink" title="æ±‡æ€»ï¼š"></a>æ±‡æ€»ï¼š</h3><ul><li><code>Ignition</code>å’Œ<code>TurboFan</code> ä»ç¼–è¯‘çš„è§’åº¦ä¸Šè¯´åŸºæœ¬ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œä¸ºä»€ä¹ˆè¦è¿™æ ·è®¾è®¡?<ul><li>å› ä¸º<code>TurboFan</code>ä¼šæ‹¿åˆ°çƒ­ç‚¹ä»£ç ç›´æ¥ç¼–è¯‘æˆä¸ºäºŒè¿›åˆ¶æœºå™¨è¯­è¨€å­˜åœ¨å†…å­˜ä¸­ï¼Œåœ¨<code>Ignition</code>è¿è¡Œçš„æ—¶å€™ï¼Œå¦‚æœæ˜¯çƒ­ç‚¹ä»£ç ä¼šç›´æ¥å»<code>TurboFan</code>è¿è¡ŒäºŒè¿›åˆ¶ä¸ç”¨å†æ¬¡ç¼–è¯‘ï¼Œæœ¬è´¨ä¸Šå¦‚æœä¸æ˜¯çƒ­ç‚¹ä»£ç å°±ä¼šåœ¨<code>Ignition</code>è¿è¡Œï¼Œæ‰€ä»¥<code>TurboFan</code>æ˜¯ä¼˜åŒ–æé«˜æ€§èƒ½</li></ul></li></ul></li></ul></li><li><h3 id="åƒåœ¾å›æ”¶"><a href="#åƒåœ¾å›æ”¶" class="headerlink" title="åƒåœ¾å›æ”¶"></a>åƒåœ¾å›æ”¶</h3><ul><li>å›æ”¶ä¸éœ€è¦çš„å†…å­˜é‡Šæ”¾ç©ºé—´</li></ul></li><li><h3 id="ä¸€äº›æ‚è¯"><a href="#ä¸€äº›æ‚è¯" class="headerlink" title="ä¸€äº›æ‚è¯"></a>ä¸€äº›æ‚è¯</h3><ul><li><code>v8</code>çœ‹ä¸æ‡‚ä»£ç ï¼Œæ‹¿åˆ°çš„ä¸œè¥¿æ˜¯å­—ç¬¦ä¸²ã€<code>v8</code>å¯¹æºç åšä¸€äº›å¤„ç†ç”Ÿæˆå¯ä»¥è®¤è¯†çš„<code>AST</code></li><li>ç§»åŠ¨ç«¯æš´éœ²å‡ºæ¥çš„é—®é¢˜å°±æ˜¯å ç”¨å†…å­˜çˆ†-å­—èŠ‚ç æ¥è°ƒèŠ‚å†…å­˜å’Œæ‰§è¡Œé€Ÿåº¦</li></ul></li></ul><h3 id="è¯­è¨€åˆ†ç±»"><a href="#è¯­è¨€åˆ†ç±»" class="headerlink" title="è¯­è¨€åˆ†ç±»"></a>è¯­è¨€åˆ†ç±»</h3><ul><li><h3 id="ç¼–è¯‘æ€§"><a href="#ç¼–è¯‘æ€§" class="headerlink" title="ç¼–è¯‘æ€§"></a>ç¼–è¯‘æ€§</h3><ul><li>åªéœ€è¦ç¼–è¯‘ä¸€æ¬¡å°±å¯ä»¥æŠŠæºä»£ç ç¼–è¯‘æˆä¸ºæœºå™¨è¯­è¨€ï¼Œä»¥åæ‰§è¡Œä¸éœ€è¦å†ç¼–è¯‘ï¼Œç›´æ¥è¿è¡Œ</li><li>ä¸åŒå¹³å°å¯¹ç¼–è¯‘å™¨å½±å“æ¯”è¾ƒå¤§ï¼Œåœ¨ç¼–è¯‘çš„æ—¶å€™ï¼Œä½æ•°é™åˆ¶å¯èƒ½ä¼šå¯¼è‡´<code>int/long</code>ç­‰ç»™å®šçš„å­—èŠ‚ä¸åŒï¼Œå¯¼è‡´å˜é‡ä½æ•°ä¸åŒä»è€Œè·¨å¹³å°ä½</li></ul></li><li><h3 id="è§£é‡Šæ€§"><a href="#è§£é‡Šæ€§" class="headerlink" title="è§£é‡Šæ€§"></a>è§£é‡Šæ€§</h3><ul><li>æºä»£ç -ä¸­é—´ä»£ç -æœºå™¨è¯­è¨€</li><li>è§£é‡Šå™¨å¯¹ä¸­é—´ä»£ç è¿›è¡Œè§£é‡Šå’Œè¿è¡Œ</li></ul></li><li><h3 id="åŒºåˆ«"><a href="#åŒºåˆ«" class="headerlink" title="åŒºåˆ«"></a>åŒºåˆ«</h3><ul><li>è§£é‡Šå™¨ç«‹å³è§£é‡Šå’Œæ‰§è¡Œä»£ç ã€ç¼–è¯‘å™¨ä¸ºæ¥ä¸‹æ¥å‡†å¤‡è¿è¡Œçš„ä»£ç åšå¥½å‡†å¤‡</li><li>ç¼–è¯‘å™¨ï¼šç”Ÿæˆä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¿è¡Œçš„æ—¶å€™å·²ç»è„±ç¦»çš„æºä»£ç ã€è·¨å¹³å°ä½<br>è§£é‡Šå™¨ï¼šå®æ—¶éœ€è¦è§£é‡Šå™¨è§£é‡Šä»£ç ã€è·¨å¹³å°é«˜ï¼ˆ<code>node</code>æ”¯æŒ<code>linux/windos</code> ==&gt; ä¸­é—´ä»£ç å­—èŠ‚ç åœ¨<code>v8</code>é‡Œè¢«è§£é‡Šä¸ºæœºå™¨ç äºŒè¿›åˆ¶ ==&gt; <code>js</code>è¿è¡Œåœ¨å„å¤„ï¼‰</li></ul></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>æµè§ˆå™¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>React Hook çˆ¶ç»„ä»¶è°ƒç”¨å­ç»„ä»¶æ–¹æ³•</title>
    <link href="/2020/08/22/callChildComponentMethod/"/>
    <url>/2020/08/22/callChildComponentMethod/</url>
    
    <content type="html"><![CDATA[<h3 id="çˆ¶ç»„ä»¶å¼•å…¥useRef"><a href="#çˆ¶ç»„ä»¶å¼•å…¥useRef" class="headerlink" title="çˆ¶ç»„ä»¶å¼•å…¥useRef"></a>çˆ¶ç»„ä»¶å¼•å…¥<code>useRef</code></h3><p>åœ¨ <code>react</code> ä¸­ä½¿ç”¨å‡½æ•°ç»„ä»¶ä»¥åŠ <code>hooks</code> ä¹‹åï¼Œæœ‰é‡åˆ°ï¼Œåœ¨çˆ¶ç»„ä»¶éœ€è¦è°ƒç”¨å­ç»„ä»¶æ–¹æ³•çš„åœ°æ–¹ï¼Œå¯ä»¥é€šè¿‡ <code>ref</code> çš„è½¬å‘ï¼Œåšåˆ°åœ¨çˆ¶ç»„ä»¶æ‰§è¡Œå­ç»„ä»¶çš„æ–¹æ³•ï¼Œä¸ºä»€ä¹ˆéœ€è¦è½¬å‘ <code>refs</code>ï¼Œæ˜¯å› ä¸ºé»˜è®¤æƒ…å†µä¸‹ï¼Œå‡½æ•°ç»„ä»¶æ²¡æœ‰å®ä¾‹ï¼Œæ— æ³•ä½¿ç”¨ <code>ref</code> å±æ€§ã€‚æ‰€ä»¥å¦‚æœéœ€è¦åœ¨å‡½æ•°ç»„ä»¶ä¸­ä½¿ç”¨ <code>ref</code>ï¼Œå…¶æ˜¯æŒ‡å‘ <code>dom</code> å…ƒç´ ã€‚</p><p>å…¶å…·ä½“æµç¨‹æ˜¯ï¼šåœ¨çˆ¶ç»„ä»¶ä¸­åˆ›å»º <code>ref</code>ï¼Œå¹¶ä¸”é€šè¿‡å±æ€§çš„æ–¹å¼ä¼ é€’ç»™å­ç»„ä»¶ï¼Œå­ç»„ä»¶é€šè¿‡ <code>forwardRef</code> åŒ…è£¹å­ç»„ä»¶ï¼Œè¿™æ ·æ‰èƒ½åœ¨å­ç»„ä»¶ä¸­çš„ç¬¬äºŒä¸ªå‚æ•°ä¸­è·å–åˆ° <code>ref</code>ï¼Œæ­¤æ—¶è·å–åˆ° <code>ref</code> ä¹‹åï¼Œ<code>ref</code> å·²ç»è½¬å‘æˆåŠŸï¼Œå½“ <code>ref</code> æŒ‚è½½å®Œæˆä¹‹åï¼Œ<code>ref.curren</code>t å°†ä¼šæŒ‡å‘å­ç»„ä»¶ã€‚</p><p><code>parent.tsx</code><br><img src="../../../../images/parent.png" srcset="/img/loading.gif" alt="parentComponent"></p><h3 id="å­ç»„ä»¶å¼•å…¥forwardRefå’ŒuseImperativeHandle"><a href="#å­ç»„ä»¶å¼•å…¥forwardRefå’ŒuseImperativeHandle" class="headerlink" title="å­ç»„ä»¶å¼•å…¥forwardRefå’ŒuseImperativeHandle"></a>å­ç»„ä»¶å¼•å…¥<code>forwardRef</code>å’Œ<code>useImperativeHandle</code></h3><p><code>child.tsx</code><br><img src="../../../../images/children.jpg" srcset="/img/loading.gif" alt="childrenComponent"></p>]]></content>
    
    
    
    <tags>
      
      <tag>React</tag>
      
      <tag>umi</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è®°Macä¸‹Hexo+github.ioæ­å»ºä¸ªäººé™æ€åšå®¢</title>
    <link href="/2019/08/10/category/"/>
    <url>/2019/08/10/category/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰æ"><a href="#å‰æ" class="headerlink" title="å‰æ"></a>å‰æ</h3><p>  å·²ç»åœ¨ <code>GitHub</code> é…ç½®è¿‡ <code>ssh</code> å¹¶ä¸”å·²ç»ä½¿ç”¨ <code>ssh -T git@github.com</code> å¹¶ä¸”æµ‹è¯•æˆåŠŸ</p><h3 id="å®‰è£…-Hexo"><a href="#å®‰è£…-Hexo" class="headerlink" title="å®‰è£… Hexo"></a>å®‰è£… <code>Hexo</code></h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs undefined">$ sudo npm <span class="hljs-keyword">install</span> -g hexo<br></code></pre></td></tr></table></figure><h3 id="åˆå§‹åŒ–åšå®¢"><a href="#åˆå§‹åŒ–åšå®¢" class="headerlink" title="åˆå§‹åŒ–åšå®¢"></a>åˆå§‹åŒ–åšå®¢</h3><p>æ–°å»ºç›®å½•ä¸º<code>myBlog</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-meta">$</span><span class="bash"> <span class="hljs-built_in">cd</span> myBlog</span><br><span class="hljs-meta">$</span><span class="bash"> hexo init</span><br></code></pre></td></tr></table></figure><p>åˆå§‹åŒ–ï¼Œä¼šä¸‹è½½ä¸€åŸºç¡€æ–‡ä»¶ï¼Œåˆæ¬¡è¿è¡Œä¼šè‡ªåŠ¨ <code>npm install</code> ä¸‹è½½å…¶ä»–çš„åŒ…è¿›è¡Œå®‰è£…</p><h3 id="å¯åŠ¨æœåŠ¡"><a href="#å¯åŠ¨æœåŠ¡" class="headerlink" title="å¯åŠ¨æœåŠ¡"></a>å¯åŠ¨æœåŠ¡</h3><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-variable">$ </span>hexo s<br></code></pre></td></tr></table></figure><p>é»˜è®¤åœ°å€ä¸º <code>http://localhost:4000</code><br>æ­¤æ—¶å°±å¯ä»¥çœ‹åˆ°é»˜è®¤çš„ä¸»é¢˜åšå®¢</p><h3 id="åˆ›å»ºä¸€ç¯‡æ–°æ–‡ç« "><a href="#åˆ›å»ºä¸€ç¯‡æ–°æ–‡ç« " class="headerlink" title="åˆ›å»ºä¸€ç¯‡æ–°æ–‡ç« "></a>åˆ›å»ºä¸€ç¯‡æ–°æ–‡ç« </h3><p>åˆ›å»ºæˆåŠŸä¼šæç¤ºåœ¨<code>source</code>ç›®å½•ä¸‹</p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs undefined">$ hexo <span class="hljs-keyword">new</span> <span class="hljs-string">"My New Post"</span><br></code></pre></td></tr></table></figure><h3 id="ç”Ÿæˆé™æ€æ–‡ä»¶"><a href="#ç”Ÿæˆé™æ€æ–‡ä»¶" class="headerlink" title="ç”Ÿæˆé™æ€æ–‡ä»¶"></a>ç”Ÿæˆé™æ€æ–‡ä»¶</h3><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-variable">$ </span>hexo g<br></code></pre></td></tr></table></figure><h3 id="æ›´æ¢ä¸»é¢˜"><a href="#æ›´æ¢ä¸»é¢˜" class="headerlink" title="æ›´æ¢ä¸»é¢˜"></a>æ›´æ¢ä¸»é¢˜</h3><p>ä¸‹è½½è‡ªå·±å–œæ¬¢çš„ä¸»é¢˜æ”¾ç½®äºæ ¹ç›®å½• <code>themes</code> ä¸‹</p><h3 id="å…³è”-GitHub"><a href="#å…³è”-GitHub" class="headerlink" title="å…³è” GitHub"></a>å…³è” <code>GitHub</code></h3><p>æ–°å»ºä»“åº“ï¼Œä»“åº“åç§°å¿…é¡»ä¸º <code>user.github.io</code></p><h3 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><p>æ‰“å¼€æ ¹ç›®å½• <code>_config.yml</code>æ–‡ä»¶ï¼Œå¹¶ä¸”é’ˆå¯¹æ€§ä¿®æ”¹ï¼Œé…ç½® <code>deploy</code></p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-attribute">deploy</span>:<br>  <span class="hljs-attribute">type</span>: git<br>  <span class="hljs-attribute">repository</span>: git<span class="hljs-variable">@github</span>.<span class="hljs-attribute">com</span>:user/user.github.io.git<br>  <span class="hljs-attribute">branch</span>: master<br></code></pre></td></tr></table></figure><h3 id="å®‰è£…-hexo-deployer-git"><a href="#å®‰è£…-hexo-deployer-git" class="headerlink" title="å®‰è£… hexo-deployer-git"></a>å®‰è£… <code>hexo-deployer-git</code></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs undefined">$ npm <span class="hljs-keyword">install</span> hexo-deployer-git <span class="hljs-comment">--save</span><br></code></pre></td></tr></table></figure><h3 id="ç”Ÿæˆé™æ€æ–‡ä»¶å¹¶ä¸Šä¼ åˆ°-github-æœåŠ¡å™¨"><a href="#ç”Ÿæˆé™æ€æ–‡ä»¶å¹¶ä¸Šä¼ åˆ°-github-æœåŠ¡å™¨" class="headerlink" title="ç”Ÿæˆé™æ€æ–‡ä»¶å¹¶ä¸Šä¼ åˆ° github æœåŠ¡å™¨"></a>ç”Ÿæˆé™æ€æ–‡ä»¶å¹¶ä¸Šä¼ åˆ° <code>github</code> æœåŠ¡å™¨</h3><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs undefined"><span class="hljs-variable">$ </span>hexo g<br><span class="hljs-variable">$ </span>hexo d<br></code></pre></td></tr></table></figure><p>æ­¤åä¾¿å¯ä»¥é€šè¿‡ <code>https://user.github.io/</code> è®¿é—®åšå®¢ã€‚</p><br><br><br>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2019/08/08/hello-world/"/>
    <url>/2019/08/08/hello-world/</url>
    
    <content type="html"><![CDATA[<h2 id="å¿«é€Ÿå¼€å§‹"><a href="#å¿«é€Ÿå¼€å§‹" class="headerlink" title="å¿«é€Ÿå¼€å§‹"></a>å¿«é€Ÿå¼€å§‹</h2><h3 id="åˆ›å»ºä¸€ç¯‡æ–°æ–‡ç« "><a href="#åˆ›å»ºä¸€ç¯‡æ–°æ–‡ç« " class="headerlink" title="åˆ›å»ºä¸€ç¯‡æ–°æ–‡ç« "></a>åˆ›å»ºä¸€ç¯‡æ–°æ–‡ç« </h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">"My New Post"</span><br></code></pre></td></tr></table></figure><h3 id="å¯åŠ¨æœåŠ¡"><a href="#å¯åŠ¨æœåŠ¡" class="headerlink" title="å¯åŠ¨æœåŠ¡"></a>å¯åŠ¨æœåŠ¡</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">é»˜è®¤æƒ…å†µä¸‹ï¼Œè®¿é—®ç½‘å€ä¸ºï¼š http://localhost:4000/<br>$ hexo s<br></code></pre></td></tr></table></figure><h3 id="ç”Ÿæˆé™æ€æ–‡ä»¶"><a href="#ç”Ÿæˆé™æ€æ–‡ä»¶" class="headerlink" title="ç”Ÿæˆé™æ€æ–‡ä»¶"></a>ç”Ÿæˆé™æ€æ–‡ä»¶</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo g<br></code></pre></td></tr></table></figure><h3 id="éƒ¨ç½²ç½‘ç«™"><a href="#éƒ¨ç½²ç½‘ç«™" class="headerlink" title="éƒ¨ç½²ç½‘ç«™"></a>éƒ¨ç½²ç½‘ç«™</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo d<br></code></pre></td></tr></table></figure><br><br><br>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
